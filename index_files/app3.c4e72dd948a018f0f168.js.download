/*! Copyright (c) 2019 WhatsApp Inc. All Rights Reserved. */
webpackJsonp([127],{bbjjjbicfb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return"#"+(parseInt(e,10)>>>0).toString(16).slice(-6)}Object.defineProperty(t,"__esModule",{value:!0});var r=i("bachgbfdhf"),s=a(r),o=i("cjfdjhfbg"),d=a(o),u=i("dfedaiidge"),l=a(u),c=i("cdaghjbcia"),f=a(c),h=i("bcddciefhh"),p=a(h),g=i("ciaebjeace"),v=a(g),_=i("bghiedffgi"),m=a(_);t.intColorToHex=n;var y=i("dcaifjegcg"),b=a(y),E=i("bhggeigghg"),T=a(E),C=i("ddcfhecgai"),M=a(C),S=function(e){function t(){var e,i,a,n;(0,l.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,p.default)(this,(e=t.__proto__||(0,d.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,y.prop)(),a.name=(0,y.prop)(),a.color=(0,y.prop)(),a.count=(0,y.prop)(),a.stale=(0,y.session)(!0),a.hexColor=(0,y.derived)(a._hexColor,["color"]),n=i,(0,p.default)(a,n)}return(0,m.default)(t,e),(0,f.default)(t,[{key:"initialize",value:function(){(0,v.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"initialize",this).call(this),this.labeltemColleciton=new M.default,this.triggerLabelUpdate(),this.listenTo(this,"change:name",this.triggerLabelUpdate),this.listenTo(this,"change:color",this.triggerLabelUpdate),this.listenTo(this,"change:count",this.triggerLabelUpdate)}},{key:"_hexColor",value:function(){if(this.color)return n(this.color)}},{key:"_find",value:function(e){return s.default.resolve({id:e})}},{key:"triggerLabelUpdate",value:function(){this.name&&T.default.Label.trigger("label_updated_"+this.id)}}]),t}(b.default);S.Collection="Label",S.Proxy="label",t.default=(0,y.defineModel)(S)},bdfbccfifg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_POLICY_TYPE=void 0;var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("cccehdaiaf"),g=a(p),v=t.CACHE_POLICY_TYPE={LOAD:"LOAD",IMMEDIATE:"IMMEDIATE",NONE:"NONE"},_=function(e){function t(e,i){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return a._collection=e,a._id=i,a}return(0,h.default)(t,e),(0,u.default)(t,[{key:"enableCaching",value:function(){}},{key:"disableCaching",value:function(){}},{key:"collection",get:function(){return this._collection}},{key:"id",get:function(){return this._id}}]),t}(g.default);_.policy=v.NONE,t.default=_},bdhgicebce:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantCollection=t.MsgInfoParticipant=void 0;var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("cigehdgbah"),y=a(m),b=i("hidifcjaf"),E=i("fcedgihic"),T=a(E),C=i("ccgjijjbbj"),M=a(C),S=i("jccfhaecf"),k=a(S),j=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,v.prop)(),a.t=(0,v.prop)(),a.contact=(0,v.session)(),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"initialize",this).call(this),this.addChild("contact",y.default.gadd(this.id))}}]),t}(_.default);j.Collection="MsgInfoParticipant",j.Proxy="msgInfoParticipant",j.idClass=k.default;var P=t.MsgInfoParticipant=(0,v.defineModel)(j),A=t.ParticipantCollection=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),t}(T.default);A.model=P,A.comparator=function(e,t){return(0,b.ContactComparator)(e.contact,t.contact)};var I=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,v.prop)(),a.isPTT=(0,v.prop)(),a.playedRemaining=(0,v.prop)(0),a.readRemaining=(0,v.prop)(0),a.deliveryRemaining=(0,v.prop)(0),a.played=(0,v.collection)(A),a.read=(0,v.collection)(A),a.delivery=(0,v.collection)(A),a.settled=(0,v.derived)(a._settled,["isPTT","playedRemaining","readRemaining"]),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"_settled",value:function(){return this.isPTT?!this.playedRemaining:!this.readRemaining}}]),t}(_.default);I.Collection="MsgInfo",I.Proxy="msgInfo",I.idClass=M.default,t.default=(0,v.defineModel)(I)},bdiiibjcij:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("cajijabhgb"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(m),b=i("eadfaddcj"),E=a(b),T=i("cbcbdjdah"),C=a(T),M=i("biecbbiiee"),S=a(M),k=i("cgcgbfbffj"),j=a(k),P=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.hasDocBefore=!0,n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.stopListening(),this.reset()}},{key:"queryDocs",value:function(e,t){var i=this;if(t)return this.queryDocBefore?this.queryDocBefore:(this.queryDocBefore=S.default.queryMedia(t.id.remote,E.default.MEDIA_QUERY_LIMIT,"before",t.id,"document").then(function(e){return(!e||e.length<E.default.MEDIA_QUERY_LIMIT)&&(i.hasDocBefore=!1),i.add(e.filter(function(e){return e.isDoc}),{at:0}),{length:e.length}}).catch(y.WapDrop,y.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryDocBefore=null,i.trigger("query_doc_before")}),this.trigger("query_doc_before"),this.queryDocBefore);var a=e.msgs;if(0===this.length){if(!a||0===a.length)return this.hasDocBefore=!1,new r.default(function(e){e({eof:!0})});this.add(a.filter(function(e){return e.isDoc}),{at:0})}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasDocBefore=!1,new r.default(function(e){e({eof:!0})});if(this.length<=2*E.default.MEDIA_QUERY_LIMIT){var n=0===this.length?a.head():this.head();return this.queryDocs(e,n)}return new r.default(function(e){e({eof:!1})})}}]),t}(j.default);P.model=C.default,t.default=P},bdjdebcdd:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("hbhijdici"),_=a(v),m=i("cajijabhgb"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(m),b=i("eadfaddcj"),E=a(b),T=i("bdiiahhjbe"),C=a(T),M=i("cgcgbfbffj"),S=a(M),k=i("hjbbdjjdf"),j=100,P=function(e){function t(){(0,o.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.dirty=!1,e._throttledSync=_.default.throttle(function(e){e.sync()},E.default.RECENT_SYNC_DELAY,{leading:!1}),e.listenTo(e,"change:weight change:length",_.default.debounce(e._sortTrimScale,j)),e}return(0,g.default)(t,e),(0,u.default)(t,[{key:"_sortTrimScale",value:function(){var e=this.length;if(e){this.sort(),e>E.default.RECENT_LIMIT&&this.remove(this.models.slice(E.default.RECENT_LIMIT));var t=this.head(),i=this.last();t&&i&&t.weight<10&&i.weight>.01||this.forEach(function(t,i){t.weight=1+(e-i)/e*3})}}},{key:"delete",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"delete",this).call(this),this.dirty=!1,this._throttledSync.cancel()}},{key:"sync",value:function(){var e=this;return this.findQuery({},{set:!0}).finally(function(){e.dirty=!1}).catch(y.WapDrop,k.isString,function(){})}},{key:"throttledSync",value:function(){C.default.log("models:"+this.constructor.modelName+":throttledSync dirty: "+String(this.dirty))(),this._throttledSync(this)}},{key:"_updateWeights",value:function(e){this.forEach(function(t){t.id===e?t.weight+=1:t.weight*=.9,t.weight=Math.round(1e3*t.weight)/1e3}),this.dirty=!0,this.throttledSync()}}]),t}(S.default);P.modelName="NotSpecified",P.comparator=function(e,t){return e.weight>t.weight?-1:1},t.default=P},beahjdfigf:function(e,t,i){"use strict";function a(e,t){return(0,n.ContactComparator)(e.contact,t.contact)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var n=i("hidifcjaf")},bechdajic:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DAYS_OF_WEEK=["sun","mon","tue","wed","thu","fri","sat"],t.BUSINESS_HOUR_MODES={OPEN_24H:"open_24h",SPECIFIC_HOURS:"specific_hours",APPOINTMENT_ONLY:"appointment_only"}},bechejbabh:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("cajijabhgb"),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(v),m=i("ccaaiecfib"),y=a(m),b=i("ddeghajfaj"),E=a(b),T=i("ceddibdhdb"),C=a(T),M=i("cgcgbfbffj"),S=a(M),k=i("chajfbfiga"),j=a(k),P=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.checksum=void 0,a.flushCountsTimer=new C.default(function(){a.hasPendingCounts()&&a.flushCounts()}),a.sortQuickReply=function(e,t){return e.totalCount===t.totalCount?e.id<t.id?-1:1:e.totalCount>t.totalCount?-1:1},a.onCountsFlushed=function(e){var t=e.id,i=e.count,n=a.get(t);n&&(n.count=i,n.pendingCount=0)},n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"delete",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"delete",this).call(this),delete this.checksum}},{key:"filterShortcuts",value:function(e){return this.filter(function(t){return t.shortcut.toLowerCase().startsWith(e.toLowerCase())}).sort(this.sortQuickReply)}},{key:"sync",value:function(e){y.default.supportsFeature(y.default.F.QUICK_REPLIES_QUERY)&&(this.synced()&&this.checksum===e?this.hasPendingCounts()&&this.flushCounts():this.findQuery({}))}},{key:"periodicFlush",value:function(){y.default.supportsFeature(y.default.F.QUICK_REPLIES_QUERY)&&this.flushCountsTimer.debounceAndCap(2e3,5e3)}},{key:"updateChecksum",value:function(e){this.checksum=e}},{key:"synced",value:function(){return void 0!==this.checksum}},{key:"hasPendingCounts",value:function(){return this.some(function(e){return e.pendingCount>0})}},{key:"getAllPendingCounts",value:function(){var e={};return this.forEach(function(t){var i=t.id,a=t.pendingCount;a>0&&(e[i]=a)}),e}},{key:"flushCounts",value:function(){var e=this,t=this.getAllPendingCounts();j.default.flushQuickReplyCounts(t).then(function(i){i.checksum&&e.updateChecksum(i.checksum),i.data.filter(function(e){var i=e.id;return void 0!==t[i]}).forEach(e.onCountsFlushed)}).catch(_.WapDrop,function(){})}},{key:"_findQuery",value:function(){var e=this,t=this.getAllPendingCounts();return j.default.queryQuickReplies(t).then(function(i){return i.checksum&&e.updateChecksum(i.checksum),i.data.filter(function(e){var i=e.id;return void 0!==t[i]}).forEach(e.onCountsFlushed),i.data})}},{key:"handle",value:function(e){e.checksum&&this.updateChecksum(e.checksum);var t=[],i=[];e.quickReplies.forEach(function(e){"delete"===e.type?t.push(e):i.push(e)}),this.remove(t.map(function(e){return e.id})),this.add(i,{merge:!0})}}]),t}(S.default);P.model=E.default,t.default=new P},bfgbdiffgd:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){if("number"==typeof e&&e>0)return e-1}function r(e){if("number"==typeof e&&e>0)return 1024*e*1024}function s(e){if("number"==typeof e&&e>0)return 1024*e}function o(e){if("number"==typeof e&&e>0)return e}function d(e){if("number"==typeof e)return!!e}Object.defineProperty(t,"__esModule",{value:!0});var u=i("djchjahdbh"),l=a(u),c=i("chgbgjccfb"),f=a(c),h=i("cjfdjhfbg"),p=a(h),g=i("dfedaiidge"),v=a(g),_=i("cdaghjbcia"),m=a(_),y=i("bcddciefhh"),b=a(y),E=i("ciaebjeace"),T=a(E),C=i("bghiedffgi"),M=a(C),S=i("hbhijdici"),k=a(S),j=i("dcaifjegcg"),P=a(j),A=i("bjcgjfiffb"),I=i("ffgeceahe"),O=i("eadfaddcj"),L=a(O),w=i("bfbggcdbfb"),N=a(w),R=i("bebehddcbc"),D=a(R),G=i("chajfbfiga"),F=a(G),U=i("ccaaiecfib"),x=a(U),Y={imageMaxKBytes:s,maxParticipants:n,media:r,maxFileSize:r,groupDescLength:o,restrictGroups:d,announceGroups:d,groupsV3:d,suspiciousLinks:d,googleMapsDoNotAuth:d,googleMapsKeyless:d,finalLiveLocation:d,statusRanking:d,stickers:d,frequentlyForwardedMessages:d,frequentlyForwardedGroupSetting:d},B=function(e){function t(){var e,i,a,n;(0,v.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,b.default)(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(s))),a.gifSearch=(0,j.prop)(L.default.SHOW_GIF_SEARCH),a.imageMaxEdge=(0,j.prop)(L.default.IMG_MAX_EDGE),a.imageMaxKBytes=(0,j.prop)(L.default.IMG_MAX_BYTES),a.maxParticipants=(0,j.prop)(L.default.MAX_GROUP_SIZE),a.maxSubject=(0,j.prop)(L.default.MAX_SUBJECT_LENGTH),a.media=(0,j.prop)(L.default.MAX_MEDIA_UPLOAD_SIZE),a.maxFileSize=(0,j.prop)(L.default.MAX_FILE_SIZE),a.notificationQuery=(0,j.prop)(L.default.USE_NOTIFICATION_QUERY),a.groupDescLength=(0,j.prop)(L.default.GROUP_DESCRIPTION_LENGTH),a.restrictGroups=(0,j.prop)(L.default.GROUPS_V3_RESTRICT_GROUPS),a.announceGroups=(0,j.prop)(L.default.GROUPS_V3_ANNOUNCE_GROUPS),a.groupsV3=(0,j.prop)(L.default.GROUPS_V3),a.fwdUiStartTs=(0,j.prop)(L.default.FWD_UI_START_TS),a.googleMapsDoNotAuth=(0,j.prop)(L.default.GOOGLE_MAPS_DO_NOT_AUTH),a.googleMapsKeyless=(0,j.prop)(L.default.GOOGLE_MAPS_KEYLESS),a.suspiciousLinks=(0,j.prop)(L.default.SUSPICIOUS_LINKS),a.finalLiveLocation=(0,j.prop)(L.default.FINAL_LIVE_LOCATION),a.statusRanking=(0,j.prop)(L.default.STATUS_RANKING),a.stickers=(0,j.prop)(L.default.STICKERS),a.multicastLimitGlobal=(0,j.prop)(L.default.MAX_FORWARD_COUNT_GLOBAL),a.frequentlyForwardedMessages=(0,j.prop)(L.default.FREQUENTLY_FORWARDED_MESSAGES),a.frequentlyForwardedThreshold=(0,j.prop)(L.default.FREQUENTLY_FORWARDED_THRESHOLD),a.frequentlyForwardedMax=(0,j.prop)(L.default.FREQUENTLY_FORWARDED_MAX),a.frequentlyForwardedGroupSetting=(0,j.prop)(L.default.FREQUENTLY_FORWARDED_GROUP_SETTING),a.wsOverride=(0,j.prop)(void 0),a.wsOverrideAttempts=(0,j.prop)(0),a.wsOverrideTimeout=(0,j.prop)(void 0),a.webRestoreFromCache=(0,j.prop)(L.default.WEB_RESTORE_FROM_CACHE),n=i,(0,b.default)(a,n)}return(0,M.default)(t,e),(0,m.default)(t,[{key:"delete",value:function(){(0,T.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"delete",this).call(this),this.updateProps({})}},{key:"set",value:function(e,i,a){var n=this;if("string"==typeof e)"webRestoreFromCache"===e&&this.saveResumeProp(i),(0,I.setServerPropInElectron)(e,i);else{var r=e,s=i,o=s&&s.merge?k.default.omitBy(r,k.default.isUndefined):r;(0,f.default)(o).forEach(function(e){var t=(0,l.default)(e,2),i=t[0],a=t[1];return"webRestoreFromCache"===i&&n.saveResumeProp(a),(0,I.setServerPropInElectron)(i,a)})}return(0,T.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"set",this).call(this,e,i,a)}},{key:"updateProps",value:function(e){var t=this;N.default.Global.webcBucket=e.bucket||null,this.__props.forEach(function(i){var a=e[i];void 0===a?a=t.getDefault(i):Y[i]&&void 0===(a=Y[i](a))&&(a=t.getDefault(i)),t.set(i,a)});for(var i in x.default.F)void 0!==e[i]&&x.default.setFeature(i,e[i])}},{key:"handlePayload",value:function(e){"number"==typeof e.status&&e.status>=400||this.updateProps(e)}},{key:"handle",value:function(e){var t=e.shift();this.handlePayload(t)}},{key:"fetch",value:function(){return F.default.queryServerProps().then(this.handlePayload.bind(this))}},{key:"saveResumeProp",value:function(e){e!==A.INIT&&D.default.setWebRestoreFromCache(e)}},{key:"loadResumeProp",value:function(){var e=D.default.getWebRestoreFromCache();"boolean"==typeof e&&(this.webRestoreFromCache=e)}}]),t}(P.default);B.Proxy="serverProps";var V=(0,j.defineModel)(B);t.default=new V({id:"1"})},bgcdajbhif:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("hbhijdici"),y=a(m),b=i("cgcgbfbffj"),E=a(b),T=i("bjigbaghc"),C=a(T),M=i("eadfaddcj"),S=a(M),k=i("cajijabhgb"),j=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(k),P=i("bdiiahhjbe"),A=a(P),I=i("biecbbiiee"),O=a(I),L=i("jcfjeeiii"),w=a(L),N=i("chajfbfiga"),R=a(N),D=i("bjebjijbfc"),G=a(D),F=i("beeieigghj"),U=a(F),x=i("dcbdjheea"),Y=i("bfgbdiffgd"),B=a(Y),V=i("ccaaiecfib"),q=a(V),H=i("bfbggcdbfb"),W=a(H),K=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,c.default)(t,[{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),delete this.checksum}},{key:"_find",value:function(e){return r.default.resolve({id:e})}},{key:"findQuery",value:function(e,i){var a=this;return(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"findQuery",this).call(this,e,i).then(function(e){return r.default.all(e.map(function(e){if(e){var t=0;return e.msgs.forEach(function(i){t<e._msgs.length&&e._msgs[t].id.toString()===i.id.toString()?++t:i.delete()}),e._msgs.length>0?a.addStatusMessages(e.id,e._msgs):r.default.resolve()}})).then(function(){return e})})}},{key:"_findQuery",value:function(e){var t=this;return R.default.statusQuery().then(function(e){return t.checksum=e.checksum,r.default.map(e.statuses,function(e){e.totalCount!==e._msgs.length&&e.totalCount<=20&&A.default.warn("Received "+e._msgs.length+" status V3 messages when total count is "+e.totalCount+" for "+e.id)();var t=e.pic;return t?U.default.createFromData(t,"image/jpeg").then(function(t){return e.pic=t,e}):e})})}},{key:"loadMore",value:function(e,t,i){return R.default.statusQuery(e,t,i&&i.id,"after").then(function(e){return e.status>=400?(A.default.error("model:statusv3:findQuery error "+e.status)(),r.default.reject(e.status)):(e.forEach(function(e){e.invis=!0}),A.default.log("model:statusv3:loadMore:"+e.length)(),O.default.processMultipleMessages((0,x.createWid)(S.default.STATUS_WID),e,{add:"after",isHistory:!0}))})}},{key:"sync",value:function(e){var t=this,i=window.performance.now();return!e||this.checksum&&this.checksum!==e?this.findQuery({},{set:this.hasSynced()}).catch(j.WapDrop,function(){}).finally(function(){t.trigger("sync")}).tap(function(e){var a=window.performance.now(),n=Math.round(a-i);t.logMetrics({type:"sync",syncTime:n}),t.forEach(function(e){e.msgs.length>e.totalCount&&A.default.log("Total count: "+e.totalCount+", msgs length: "+e.msgs.length)()})}):r.default.resolve(void 0)}},{key:"logMetrics",value:function(e){var t=void 0;t="sync"===e.type?new W.default.WebcStatusSync({webcStatusSyncT:e.syncTime}):new W.default.WebcStatusSession({webcStatusSessionId:e.sessionId});var i=this.filter(function(e){return!e.contact.isMe}),a=i.filter(function(e){return!e.contact.statusMute}),n=a.filter(function(e){return e.hasUnread}),r=a.filter(function(e){return!e.hasUnread}),s=i.filter(function(e){return e.contact.statusMute}),o=y.default.sum(a.map(function(e){return e.unreadCount})),d=y.default.sum(a.map(function(e){return e.readCount})),u=y.default.sum(s.map(function(e){return e.totalCount}));t.webcStatusRecentItemCount=o,t.webcStatusRecentRowCount=n.length,t.webcStatusViewedItemCount=d,t.webcStatusViewedRowCount=r.length,t.webcStatusMutedItemCount=u,t.webcStatusMutedRowCount=s.length,t.commit()}},{key:"hasSynced",value:function(){return!!this.checksum}},{key:"handleUpdate",value:function(e,t,i){var a=e.id.fromMe?C.default.me:e.author;if(this.updateChecksum(t),this.hasSynced()){if(i)return!0;var n=this.get(a);if(n){var r=n.totalCount===n.msgs.length;if("revoke"===e.subtype){var s=y.default.take(n.msgs.toArray(),n.totalCount-n.unreadCount),o=y.default.map(s,function(e){return e.id.toString()}),d={totalCount:n.totalCount-1};y.default.find(o,function(t){return t===e.protocolMessageKey.toString()})||n.readKeys[e.protocolMessageKey.toString()]||(d.unreadCount=n.unreadCount-1),n.set(d)}else{var u={totalCount:n.totalCount+1};e.invis||(u.unreadCount=n.unreadCount+1),u.t=e.t,n.set(u)}return!r&&e.body&&U.default.createFromBase64Jpeg(e.body).then(function(e){n.pic=e}),r}return this.add({id:a,t:e.t,unreadCount:e.invis?0:1,totalCount:1}),!0}return!1}},{key:"handleScore",value:function(e,t){var i=this.get(e);i?i.score=t:A.default.log("models:statusV3:score:no_status:"+[e,t].join())()}},{key:"updateChecksum",value:function(e){e?this.hasSynced()&&(this.checksum=e):A.default.info("models:statusV3:no_checksum")()}},{key:"handle",value:function(e){var t=e.shift();if(Array.isArray(t))A.default.warn("models:statusV3:unexpected update")(t);else switch(t.type){case"read":this.updateChecksum(t.checksum);var i=this.get(t.chat);i?i.handleReadStatus(t.key):A.default.log("models:statusV3:read:no_status:"+[t.chat,t.key].join())(t);break;case"privacy":break;case"score":for(var a=0;a<t.scores.length;a++){var n=t.scores[a],r=n.jid,s=n.score;this.handleScore(r,s)}this.sort();break;default:A.default.warn("models:statusV3:unknown:"+t.type,t)()}}},{key:"addStatusMessages",value:function(e,t){return O.default.processMultipleMessages((0,x.createWid)(S.default.STATUS_WID),t,{add:"after",isHistory:!0})}},{key:"getUnexpired",value:function(e){var t=this.filter(function(e){return e.totalCount>0&&G.default.globalUnixTime()-e.t<=86400&&e.contact.isMyContact&&!e.contact.isMe});if(e){return y.default.filter(t,function(e){return e.unreadCount>0})}return y.default.filter(t,function(e){return 0===e.unreadCount})}},{key:"getMyStatus",value:function(){var e=this.filter(function(e){return e.contact.isMe});return y.default.isEmpty(e)?void 0:G.default.globalUnixTime()-e[0].t>86400?void 0:e[0]}}]),t}(E.default);K.model=w.default,K.comparator=function(e,t){return B.default.statusRanking&&q.default.supportsFeature(q.default.F.STATUS_RANKING)&&e.score!==t.score?t.score-e.score:t.t-e.t},t.default=new K},bgdcgdigif:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CALL_TYPES=t.CALL_UI_STATES=void 0;var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=t.CALL_UI_STATES={NONE:"NONE",OUTGOING_RING:"OUTGOING_RING",INCOMING_RING:"INCOMING_RING",OUTGOING_CALLING:"OUTGOING_CALLING",CONNECTING:"CONNECTING",RECONNECTING:"RECONNECTING",ACTIVE:"ACTIVE",ENDED:"ENDED",REJECTED:"REJECTED",REMOTE_CALL_IN_PROGRESS:"REMOTE_CALL_IN_PROGRESS",FAILED:"FAILED"},y=(t.CALL_TYPES={VOICE:"VOICE",VIDEO:"VIDEO"},function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.callId=(0,v.session)(),a.state=(0,v.session)(m.NONE),a.from=(0,v.session)(),a.to=(0,v.session)(),a.type=(0,v.session)(),a.muted=(0,v.session)(),a.peerMuted=(0,v.session)(),a.speaker=(0,v.session)(),a.outgoing=(0,v.session)(),a.startTime=(0,v.session)(),a.showFullscreenCallView=(0,v.session)(!1),a.showCallStatusBar=(0,v.session)(!1),a.externalInputAvailable=(0,v.session)(),a.interrupted=(0,v.session)(),a.peerBusy=(0,v.session)(),a.peerVideoState=(0,v.session)(),n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),(0,c.default)(t,[{key:"onStateChange",value:function(){}},{key:"onAudioOutputChange",value:function(){}},{key:"overrideOutputRoute",value:function(e){return r.default.resolve()}}]),t}(_.default));y.Proxy="callUi",t.default=y},bgfcjjddjf:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("chghgadcbg"),g=a(p),v=i("cgcgbfbffj"),_=a(v),m=function(e){function t(){(0,o.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.listenTo(e,"add",e.blockContact),e.listenTo(e,"remove",e.unblockContact),e}return(0,h.default)(t,e),(0,u.default)(t,[{key:"blockContact",value:function(e){e.contact().isContactBlocked=!0}},{key:"unblockContact",value:function(e){e.contact().isContactBlocked=!1}}]),t}(_.default);m.model=g.default,t.default=new m},bhggeigghg:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={};t.default=a},biaifggagf:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("cgejjichfa"),_=i("dbdaeccafe"),m=i("hbhijdici"),y=a(m),b=i("daejhdfjb"),E=a(b),T=i("hgeacfdgi"),C=a(T),M=i("bdiiahhjbe"),S=a(M),k=i("bfghgchdbh"),j=i("cgcgbfbffj"),P=a(j),A=i("bhgjacgcdd"),I=a(A),O=i("ddcbacabaj"),L=a(O),w=i("ccaaiecfib"),N=a(w),R=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.pendingOffers={},a.pendingVoipCapChecks={},n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),(0,c.default)(t,[{key:"handleQuery",value:function(e){return r.default.resolve()}},{key:"handle",value:function(e){var t=this,i=e.shift();if(i.data&&i.data[0]){var a=L.default.parseCallSignalingMsg(i);if(!a)return;var n={};N.default.supportsFeature(N.default.F.DESKTOP_VOIP_VOICE_CALL)&&(Array.isArray(i.data[0])&&(i.data=i.data[0]),(0,O.base64DecodeRecursively)(i.data),n={peer_jid:a.peer_jid,payload:i.data,peer_platform:a.peer_platform,peer_app_version:a.peer_version,epoch_msec:a.t?String(1e3*a.t):void 0,elapsed_msec:a.e?String(1e3*a.e):void 0,is_offline:i.data[1].offline});var s=a.call_id,o=void 0,d=null,u=null,l=null;switch(a.type){case _.TYPE.OFFER:if(o=v.CALL_STATES.INCOMING_RING,d=a.isVideoCall,u=a.isGroupCall,l=a.t,I.default.isInitialized()){this.pendingVoipCapChecks[s]=(0,A.checkVoipCapability)(y.default.assign({},a));var c=i.data[2].find(function(e){return"enc"===e[0]});this.pendingOffers[s]=r.default.sit("receivedKey",function(e){return L.default.receiveCallOfferKey(e,c),i}).endWithControls("receivedKey")}break;case _.TYPE.OFFER_RECEIPT:o=v.CALL_STATES.CONNECTING;break;case _.TYPE.PREACCEPT:o=v.CALL_STATES.OUTGOING_RING;break;case _.TYPE.ACCEPT_RECEIPT:case _.TYPE.ACCEPT:o=v.CALL_STATES.ACTIVE;break;case _.TYPE.REJECT:o=v.CALL_STATES.REJECTED,C.default.callId===s&&I.default.endCall(),this.cleanupPendingOffer(s);break;case _.TYPE.TERMINATE:o=v.CALL_STATES.ENDED,C.default.callId===s&&I.default.endCall(),this.cleanupPendingOffer(s)}this.pendingVoipCapChecks[s]?this.pendingVoipCapChecks[s].then(function(e){var r=void 0;r=!u&&(d?e&&(0,k.supportsVideoCalling)():e),t.processIncomingCall(s,i.from,o,{isVideo:d,isGroupCall:u,canHandleLocally:r,offerTime:l}),r&&t.pendingOffers[s]&&N.default.supportsFeature(N.default.F.DESKTOP_VOIP_VOICE_CALL)?t.pendingOffers[s].then(function(){I.default.handleIncomingSignalingMessage(a,n)}):t.cleanupPendingOffer(s)}).finally(function(){delete t.pendingVoipCapChecks[s]}):this.pendingOffers[s]?(this.processIncomingCall(s,i.from,o),N.default.supportsFeature(N.default.F.DESKTOP_VOIP_VOICE_CALL)&&this.pendingOffers[s].then(function(){I.default.handleIncomingSignalingMessage(a,n)})):(this.processIncomingCall(s,i.from,o,{isVideo:d,isGroupCall:u,canHandleLocally:!1,offerTime:l}),I.default.isInitialized()&&N.default.supportsFeature(N.default.F.DESKTOP_VOIP_VOICE_CALL)&&I.default.handleIncomingSignalingMessage(a,n))}else{var f=void 0;switch(i.type){case"offer_key":var h=this.pendingOffers[i.id];h?h.control.receivedKey(i.key):S.default.warn("received offer_key: no pending offer")();break;case"accept":f=v.CALL_STATES.ACTIVE,this.cleanupPendingOffer(i.id);break;case"reject":f=v.CALL_STATES.REJECTED,this.cleanupPendingOffer(i.id);break;case"terminate":f=v.CALL_STATES.ENDED,this.cleanupPendingOffer(i.id)}this.processIncomingCall(i.id,void 0,f)}}},{key:"processIncomingCall",value:function(e,t,i,a){if(i){var n={id:e};null!=t&&(n.peerJid=t),a&&(a=y.default.omitBy(a,function(e){return null==e}),y.default.merge(n,a)),this.add(n,{merge:!0});this.assertGet(e).setState(i)}}},{key:"cleanupPendingOffer",value:function(e){delete this.pendingOffers[e]}}]),t}(P.default);R.model=E.default,t.default=new R},biecbbiiee:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgCollection=void 0;var r=i("bgigfdhaij"),s=n(r),o=i("djchjahdbh"),d=n(o),u=i("bachgbfdhf"),l=n(u),c=i("cjfdjhfbg"),f=n(c),h=i("dfedaiidge"),p=n(h),g=i("cdaghjbcia"),v=n(g),_=i("bcddciefhh"),m=n(_),y=i("ciaebjeace"),b=n(y),E=i("bghiedffgi"),T=n(E),C=i("hbhijdici"),M=n(C),S=i("cajijabhgb"),k=a(S),j=i("ebggjhghhi"),P=a(j),A=i("cgcgbfbffj"),I=n(A),O=i("dbfjecijha"),L=n(O),w=i("bjigbaghc"),N=n(w),R=i("eadfaddcj"),D=n(R),G=i("bdiiahhjbe"),F=n(G),U=i("cbcbdjdah"),x=n(U),Y=i("ccgjijjbbj"),B=n(Y),V=i("cahfddcdga"),q=n(V),H=i("eaaehfdjdg"),W=n(H),K=i("bhggeigghg"),z=n(K),Q=i("chajfbfiga"),J=n(Q),X=i("jccfhaecf"),Z=n(X),$=i("hjbbdjjdf"),ee=i("bjigbaghc"),te=i("dcbdjheea"),ie=i("dfjijdgbhd"),ae=t.MsgCollection=function(e){function t(){(0,p.default)(this,t);var e=(0,m.default)(this,(t.__proto__||(0,f.default)(t)).call(this));return e.lastReceivedReceipt={},e.lastReceivedPaymentTransaction={},e.preAck={},e.pendingAdd={},e.ftsCache={},e.keysForResyncReceipts=void 0,e.listenTo(W.default,"change:stream",function(){W.default.stream===H.STREAM.DISCONNECTED&&(this.preAck={})}),e.listenTo(e,"remove",e.removeFromCollection),e}return(0,T.default)(t,e),(0,v.default)(t,[{key:"removeFromCollection",value:function(e){e.chat&&e.chat.removeFromCollection(e)}},{key:"_findQuery",value:function(e,t){var i=this,a=void 0;switch(e.direction){case"before":case"after":a=e.direction;break;default:a="before"}return J.default.msgFindQuery(a,e,t).then(function(t){if(t.status>=400)return F.default.error("model:Msg:findQuery error "+t.status)(),l.default.reject(t.status);var n=function(){var t=i.get(e),a=z.default.Chat.get(e.remote);return t?t.msgChunk:a?a.msgs:void 0};return t.forEach(function(e){e.invis=!0}),F.default.log("model:Msg:findQuery:got:"+t.length+":"+e.direction)(),i.processMultipleMessages(e.remote,t,{add:a,isHistory:!0},n)})}},{key:"getStarred",value:function(e,t,i,a){var n=this,r={count:"number"!=typeof t||isNaN(t)?D.default.PAGE_SIZE:t,chat:e||void 0,remote:i&&i.remote,id:i&&i.id,fromMe:i&&i.fromMe,participant:i&&i.participant,media:a?"gif":void 0};return J.default.msgFindQuery("star",r).then(function(e){var t=e.status;return e.status>=400?(499===t?F.default.log("model:Msg:getStarred error 499 (unimplemented)")():F.default.error("model:Msg:getStarred error "+t)(),l.default.reject(t)):n.processMultipleMessages(void 0,e,{add:"search"})})}},{key:"queryVCard",value:function(e){var t=this;return J.default.queryVCard(e).then(function(e){return 499===e.status?(F.default.log("model:Msg:queryVCard error 499 (unimplemented)")(),l.default.reject(new k.E499)):t.processMultipleMessages(void 0,e,{add:"search"})})}},{key:"incrementalStarredUpdate",value:function(e){return this.processMultipleMessages(void 0,e,{add:"search"})}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments[2],a=this,n=arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=e+"__"+(r.label||r.kind||"");if(1!==t||n)return this._search(e,t,i,n,r.label,r.kind);var o=this.ftsCache[s];if(o)return o;var d=this._search(e,t,i,n,r.label,r.kind);this.ftsCache[s]=d;var u=function(){a.ftsCache[s]=null};return M.default.delay(u,D.default.FTS_TTL),d.catch(u),d}},{key:"_search",value:function(e,t,i,a,n,r){var s=this,o={searchTerm:e,page:t&&(0,$.isNumber)(t)?t:1,count:i&&(0,$.isNumber)(i)?i:D.default.PAGE_SIZE,remote:a,label:n,kind:r};return J.default.msgFindQuery("search",o).then(function(e){if(404===e.status)return l.default.reject(new k.E404);if(e.status>=400)return F.default.error("model:Msg:search error "+e.status)(),l.default.reject(e.status);var t=Array.isArray(e)?e:e.messages,i=!!Array.isArray(e)||e.eof;return l.default.props({messages:s.processMultipleMessages(void 0,t,{add:"search"}),eof:i})})}},{key:"queryMedia",value:function(e,t,i,a,n){var r=this,s={remote:e,count:t&&(0,$.isNumber)(t)?t:D.default.PAGE_SIZE,id:a&&a.id,fromMe:a&&a.fromMe,participant:a&&a.participant,direction:i||"before",media:n};return J.default.msgFindQuery("media",s).then(function(e){return e.status>=400?(F.default.error("model:Msg:media error "+e.status)(),l.default.reject(e.status)):n?r.processMultipleMessages(void 0,e,{add:"search"}):l.default.props({docCount:e.docCount,linkCount:e.linkCount,mediaCount:e.mediaCount,messages:r.processMultipleMessages(void 0,e.messages,{add:"search"})})})}},{key:"getContext",value:function(e,t,i){var a=this,n=this.get(e);return n?l.default.all([J.default.msgFindQuery("before",e,i),J.default.msgFindQuery("after",e,i)]).spread(function(i,r){return Array.isArray(i)&&Array.isArray(r)?(n.search=!1,l.default.all([a.processMultipleMessages(e.remote,i,{add:"before",isHistory:!0},t),a.processMultipleMessages(e.remote,r,{add:"after",isHistory:!0},t)])):(F.default.error("model:msg:getContext fetch error",i,r)(),l.default.reject(i.status||r.status))}):J.default.msgFindQuery("after",e,i).then(function(i){return Array.isArray(i)?Z.default.isStatusV3(i[0].id.remote)?l.default.reject("statusV3, stop querying before the msg"):a.processMultipleMessages(e.remote,i,{add:"after",isHistory:!0},t):(F.default.error("model:msg:getContext:after fetch error",i)(),l.default.reject(i.status))}).then(function(t){var n=(0,q.default)(t[0]),r=n.id.clone();return r.count=e.count+1,l.default.all([J.default.msgFindQuery("before",r,i).then(function(t){if(!Array.isArray(t))return F.default.error("model:msg:getContext:before fetch error",t)(),l.default.reject(t.status);if(!t[t.length-1].id.equals(e))return F.default.error("model:msg:getContext:before ctx message mismatch",t)(),l.default.reject(405);var i=function(){return n.msgChunk};return a.processMultipleMessages(e.remote,t,{add:"before",isHistory:!0},i)}),l.default.resolve(t)])})}},{key:"handle",value:function(e){function t(e,t){var i=void 0;i=Z.default.isStatusV3(a.broadcast)?new B.default({from:a.from,to:a.broadcast,id:t,selfDir:a.self||"out"}):new B.default({from:a.from,to:e,id:t,participant:a.participant,selfDir:a.self||"out"});var n=u.get(i);if(n){n.updateAck(a.ack),u.updateLastReceipt(i.remote,a.t);var r=i.remote;Z.default.isUser(r)?(z.default.MsgInfo.updateInfo(t,a.from,e,a.ack,r,a.t),Z.default.isBroadcast(a.broadcast)&&z.default.MsgInfo.updateInfo(t,a.from,a.broadcast,a.ack,r,a.t)):Z.default.isStatusV3(r)&&z.default.MsgInfo.updateInfo(t,a.from,r,a.ack,e,a.t)}else F.default.log("Msg:out of order ack",a)(),u.preAck[i]=a}var i=(0,d.default)(e,1),a=i[0],n=void 0,r=void 0,s=void 0,o=void 0,u=this;if("ack"===a.cmd){var l=[a.to];if(Z.default.isBroadcast(a.to)&&1===a.ack){var c=z.default.GroupMetadata.get(a.to);c&&Array.prototype.push.apply(l,M.default.map(c.participants.toArray(),"id"))}l.forEach(function(e){t(e,a.id)})}else if("acks"===a.cmd)a.id.forEach(function(e){t(a.to,e)});else if(a.msg){if(!(a.chat instanceof Z.default))return;var f="update"===a.meta.add;Z.default.isStatusV3(a.chat)&&!z.default.StatusV3.handleUpdate(a.msg,a.meta.checksum,f)||(a.msg.recvFresh=!0,a.msg.isNewMsg=!0,this.processMultipleMessages(a.chat,[a.msg],{add:"after",update:f,isHistory:!1}).catch(k.LogoutDrop,function(){}))}else if(a.msgs){var h=a.msgs.length;if(!h)return;if(!(a.chat instanceof Z.default))return;r=a.meta,r.isHistory=!0,"unread"===r.add&&(r.firstUnreadKey=new B.default({fromMe:r.unreadFromMe,remote:a.chat,id:r.unreadId,participant:r.unreadParticipant}),s=new L.default);for(var p=0;p<h;p++)n=a.msgs[p],n.invis=!0;N.default.platform===ee.PLATFORMS.IPHONE&&this.trigger(D.default.COLLECTION_HAS_SYNCED),this.trigger("handle:msg_history",{count:a.msgs.length,binarySize:a.binarySize}),this.processMultipleMessages(a.chat,a.msgs,r,s).catch(k.LogoutDrop,function(){})}else if(a.recent){r=a.meta,o=a.binarySize,delete a.recent,delete a.meta,delete a.binarySize,this.trigger(D.default.COLLECTION_HAS_SYNCED,{count:M.default.keys(a).length,binarySize:o}),r.isHistory=!0;for(var g in a){var v=void 0;try{v=(0,te.createWid)(g)}catch(e){continue}"last"===r.add&&r.resume&&(s=new L.default),n=a[g],n.invis=!0,this.processMultipleMessages(v,[n],r,s).catch(k.LogoutDrop,function(){})}}else F.default.log("************** Msg else clause. something strange is going on")()}},{key:"_hasSynced",value:function(){return P.waitForBBEvent(this,D.default.COLLECTION_HAS_SYNCED)}},{key:"delete",value:function(){(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"delete",this).call(this),this.lastReceivedReceipt={},this.lastReceivedPaymentTransaction={},this.preAck={}}},{key:"getKeysForResyncReceipts",value:function(){var e=[],t=M.default.assign({},this.lastReceivedReceipt,this.lastReceivedPaymentTransaction);for(var i in t){var a=(0,te.createWid)(i),n=z.default.Chat.get(a),r=void 0;if(n&&(r=n.getFirstMsgWithStatus()),r){var s=r.id;s.t=this.lastReceivedReceipt[a]||r.t||0,s.payT=this.lastReceivedPaymentTransaction[a],e.push(s)}else F.default.error("Msg:resyncReceipts wid in lastReceivedReceipt, but no msg: "+a.toString())()}return e}},{key:"setKeysForResyncReceipts",value:function(e){this.keysForResyncReceipts=e}},{key:"resetKeysForResyncReceipts",value:function(){this.keysForResyncReceipts=void 0}},{key:"resyncReceipts",value:function(){var e=this;F.default.log("Msg:resyncReceipts")();var t=this.keysForResyncReceipts||this.getKeysForResyncReceipts();return 0===t.length?l.default.resolve():J.default.resyncReceipts(t).then(function(t){if(Array.isArray(t)){F.default.log("Msg:resyncReceipts success")();(z.default.Chat.promises.initializeRestFromTabletCache?z.default.Chat.promises.initializeRestFromTabletCache:l.default.resolve()).then(function(){t.forEach(function(t){e.updateLastReceipt(t.id,t.t),e.updateLastTransactionTime(t.id,t.payT),t.acks.forEach(function(i){if(4===i.length){var a=new B.default({fromMe:i[1],remote:t.id,id:i[0],participant:i[2]}),n=e.get(a);n&&n.updateAck(i[3])}else F.default.error("Msg:resyncReceipts invalid response: "+(0,s.default)(i))()}),t.msgs.length>0&&e.processMultipleMessages(t.id,t.msgs,{update:!0,isHistory:!1}).catch(k.LogoutDrop,function(){})})})}else F.default.error("Msg:resyncReceipts error",t)()}).catch(k.LogoutDrop,k.EphemeralDrop,k.BrowserReplacedDrop,function(){}).catch(function(e){throw F.default.error("Msg:resyncReceipts dropped "+String(e)+" "+(e?e.stack:"no stack"))(),new Error("Msg:resyncReceipts dropped")}).finally(function(){e.resetKeysForResyncReceipts()})}},{key:"updateLastReceipt",value:function(e,t){var i=this.lastReceivedReceipt[e];t&&(!i||t>i)&&(this.lastReceivedReceipt[e]=t)}},{key:"updateLastTransactionTime",value:function(e,t){var i=this.lastReceivedPaymentTransaction[e];t&&(!i||t>i)&&(this.lastReceivedPaymentTransaction[e]=t)}},{key:"processMultipleMessages",value:function(e,t,i,a){var n=this,r=function(){return(0,ie._processMultipleMessages)(e,t,i,a)};if(e){var s=void 0,o=this.pendingAdd[e];return s=o?o.then(r):r(),s.finally(function(){e&&n.pendingAdd[e]===s&&(n.pendingAdd[e]=null)}).catch(function(){}),this.pendingAdd[e]=s}return r()}}]),t}(I.default);ae.model=x.default,t.default=new ae},biedfadfag:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("diafggiefe"),_=a(v),m=i("cgcgbfbffj"),y=a(m),b=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,u.default)(t,[{key:"toArray",value:function(){var e=this;return(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"filter",this).call(this,function(t){return t.old&&e.remove(t),t})}}]),t}(y.default);b.model=_.default,t.default=b},bieicghjif:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("ddhijeejag"),y=a(m),b=i("dcaifjegcg"),E=a(b),T=i("dbdfbgehgj"),C=a(T),M=i("gbfffciea"),S=a(M),k=i("bjigbaghc"),j=a(k),P=i("cajijabhgb"),A=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(P),I=i("gabccaieg"),O=a(I),L=i("bdiiahhjbe"),w=a(L),N=i("chajfbfiga"),R=a(N),D=i("jccfhaecf"),G=a(D),F=i("ccihhdchab"),U=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,b.prop)(),a.duration=(0,b.prop)(),a.participants=(0,b.collection)(O.default),a.active=(0,b.session)(!1),a.keepAliveTimer=(0,b.session)(),a.stopPromise=(0,b.session)(),n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"initialize",value:function(){var e=this;(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"initialize",this).call(this),this.listenTo(this.participants,"remove reset",function(){e.hasParticipants()||e.delete()});var i=C.default.get(this.id);i&&!i.liveLocation&&(i.liveLocation=this)}},{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.stopViewingMap(),this.participants.delete(),this.getCollection().remove(this.id);var e=C.default.get(this.id);e&&(e.liveLocation=void 0)}},{key:"hasParticipants",value:function(){return this.participants.length>0}},{key:"startViewingMap",value:function(){this.active||(this.active=!0,this._updateLiveLocations(),this._startKeepAlive())}},{key:"stopViewingMap",value:function(){this.active&&(this.active=!1,this._pauseLiveLocations(),this._stopKeepAlive())}},{key:"userHasLiveLocation",value:function(e){return!!this.participants.get(e)}},{key:"iHaveLiveLocation",value:function(){return this.userHasLiveLocation(j.default.me)}},{key:"stopMyLiveLocation",value:function(e){var t=this;if(!this.iHaveLiveLocation())return r.default.reject(new A.ActionError);if(this.stopPromise)return this.stopPromise;var i=this.stopPromise=R.default.disableLiveLocation(this.id),a=new F.ActionType(l10n.t("action_live_location_stopping"));e=e||(0,F.genId)();var n=i.then(function(e){return 200===e.status?new F.ActionType(l10n.t("action_live_location_stopped")):e.status>=400?new F.ActionType(l10n.t("action_live_location_stop_failed")):void 0}).catch(function(i){return w.default.error("models:liveLocation:disableLiveLocation dropped")(i),new F.ActionType(l10n.t("action_live_location_stop_failed"),l10n.t("action_try_again"),t.stopMyLiveLocation.bind(t,e))});return S.default.openToast(y.default.createElement(F.ActionToast,{id:e,initialAction:a,pendingAction:n})),i.then(function(e){if(200===e.status&&!e._duplicate){var i=t.participants.get(j.default.me);i&&i.disable()}}).finally(function(){t.stopPromise=null})}},{key:"_updateLiveLocations",value:function(){this.update().catch(function(){})}},{key:"_pauseLiveLocations",value:function(){R.default.unsubscribeLiveLocation(this.id).catch(A.WapDrop,function(){})}},{key:"_sendKeepAlive",value:function(){R.default.subscribeLiveLocation(this.id,!1).catch(A.WapDrop,function(){})}},{key:"_startKeepAlive",value:function(){if(!this.keepAliveTimer){var e=this.duration;e&&(this.keepAliveTimer=window.setInterval(this._sendKeepAlive.bind(this),1e3*e))}}},{key:"_stopKeepAlive",value:function(){this.keepAliveTimer&&(window.clearInterval(this.keepAliveTimer),this.keepAliveTimer=null)}}]),t}(E.default);U.Collection="LiveLocation",U.Proxy="liveLocation",U.idClass=G.default,t.default=(0,b.defineModel)(U)},biheibdage:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ATTACH_MEDIA_STATE=void 0;var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("dcaifjegcg"),y=a(m),b=i("cajijabhgb"),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(b),T=i("cieaaiahhf"),C=a(T),M=i("cgffhfegce"),S=i("bdiiahhjbe"),k=a(S),j=i("beeieigghj"),P=a(j),A=i("ddgbhifaji"),I=i("cbcbdjdah"),O={READY:"ready",PROCESSING:"processing",ERROR:"error"};t.ATTACH_MEDIA_STATE=O;var L=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,m.prop)(),a.file=(0,m.prop)(),a.uiProcessed=(0,m.prop)(),a.fileOrigin=(0,m.prop)(),a.state=(0,m.session)(),a.mediaPrep=(0,m.session)(),a.mimetype=(0,m.session)(),a.processPromise=(0,m.session)(),a.exception=(0,m.session)(),a.chat=(0,m.session)(),a.caption=(0,m.session)(),a.type=(0,m.session)(I.TYPE.UNKNOWN),a.preview=(0,m.session)(),a.fullPreview=(0,m.session)(),a.fullPreviewSize=(0,m.session)(),a.filename=(0,m.session)(),a.pdfPages=(0,m.session)(),a.isGif=(0,m.session)(),a.gifAttribution=(0,m.session)(),a.previewable=(0,m.derived)(a._previewable,["preview","fullPreview","type","filename","fullPreviewSize","mimetype"]),n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_previewable",value:function(){if(!this.type||!this.mimetype||!this.fullPreview)return!1;switch(this.type){case I.TYPE.DOCUMENT:return!!this.filename;case I.TYPE.IMAGE:case I.TYPE.VIDEO:return!(!this.fullPreviewSize||!this.preview);case I.TYPE.AUDIO:case I.TYPE.PTT:case I.TYPE.UNKNOWN:return!0;default:throw new Error("Unsupported attach media type "+this.type)}}},{key:"initialize",value:function(){if((0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"initialize",this).call(this),!(this.file instanceof r.default))throw new Error("cannot process non-promise file");this.processFile(this.file)}},{key:"processFile",value:function(e){this.state=O.PROCESSING,this.processPromise=this._processFilePromiseHelper(e)}},{key:"_processFilePromiseHelper",value:function(e){var t=this;return e.then(function(e){t.set(e);var i={},a=e.file,n=e.isGif,r=e.gifAttribution;n?(i.asGif=n,i.gifAttribution=r):e.type===M.FILETYPE.DOCUMENT&&(i.asDocument=!0);var s=P.default.createFromData(a,a.type),o=(0,A.prepRawMedia)(s,i);return t.set({mediaPrep:o}),o.waitForPrep().then(function(e){var i=e.documentPreview,a=window.URL.createObjectURL(e.mediaBlob),n={file:e.mediaBlob,fullPreview:a,type:e.type,filename:e.filename,mimetype:e.mimetype,preview:e.preview,state:O.READY,isGif:e.isGif,fullPreviewSize:void 0,pdfPages:void 0};e.fullWidth&&e.fullHeight&&(n.fullPreviewSize={height:e.fullHeight,width:e.fullWidth}),e.type===I.TYPE.IMAGE&&(n.preview=a),e.type===I.TYPE.DOCUMENT&&i&&(n.fullPreview=i.url,n.preview=i.thumbUrl,n.fullPreviewSize={height:i.height,width:i.width},n.pdfPages=i.pdfPages),t.set(n),k.default.assert(t.previewable,"AttachMedia processFile","Invariant violated, processed file is not previewable")()})}).catch(E.InvalidMediaFileType,E.InvalidImageFileType,function(i){return t._processFilePromiseHelper(e.then(function(e){return e.type=M.FILETYPE.DOCUMENT,e}))}).catch(C.default,E.MediaFileFailedLoad,E.MediaFileEmpty,function(e){return t.set({exception:e,state:O.ERROR}),t}).catch(function(e){return t.set({exception:new E.InvalidMediaFileType,state:O.ERROR}),t})}},{key:"sendToChat",value:function(e,t){if(!this.mediaPrep)throw new Error("MediaPrep not available");if(this.state===O.ERROR)throw new Error(this.exception);if(!(this.state!==O.PROCESSING||this.previewable&&t.addEvenWhilePreparing))throw new Error("Media still processing");if(this.state===O.READY)return void this.mediaPrep.sendToChat(e,t);var i={mimetype:this.mimetype};switch(this.type){case I.TYPE.VIDEO:i.isGif=this.isGif,i.gifAttribution=this.gifAttribution;case I.TYPE.IMAGE:i.width=this.fullPreviewSize.width,i.height=this.fullPreviewSize.height,i.body=this.preview,t.placeholderProps=i;break;case I.TYPE.DOCUMENT:i.pageCount=this.pdfPages,i.filename=this.filename,i.body=this.preview,t.placeholderProps=i;break;case I.TYPE.AUDIO:case I.TYPE.PTT:}this.mediaPrep.sendToChat(e,t)}},{key:"getFileType",value:function(){if(!(this.file instanceof Blob||this.file instanceof File))throw new Error("expected file to be a Blob or File");return(0,M.typeFromMimetype)(this.file.type)}},{key:"delete",value:function(){this.fullPreview&&window.URL.revokeObjectURL(this.fullPreview),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this)}}]),t}(y.default);L.Proxy="attachMedia",t.default=(0,m.defineModel)(L)},bijffg:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i("bachgbfdhf"),s=n(r),o=i("cjfdjhfbg"),d=n(o),u=i("dfedaiidge"),l=n(u),c=i("cdaghjbcia"),f=n(c),h=i("bcddciefhh"),p=n(h),g=i("ciaebjeace"),v=n(g),_=i("bghiedffgi"),m=n(_),y=i("hbhijdici"),b=n(y),E=i("ddhijeejag"),T=a(E),C=i("cajijabhgb"),M=a(C),S=i("bbjjjbicfb"),k=n(S),j=i("cgcgbfbffj"),P=n(j),A=i("chajfbfiga"),I=n(A),O=i("bhggeigghg"),L=n(O),w=i("bdiiahhjbe"),N=n(w),R=i("bebehddcbc"),D=n(R),G=i("bjigbaghc"),F=n(G),U=i("bgabgddgch"),x=n(U),Y=i("ebggjhghhi"),B=a(Y),V=i("eaaehfdjdg"),q=n(V),H=i("gbfffciea"),W=n(H),K=i("ccihhdchab"),z=i("hciaejfjd"),Q=i("bddhdheedf"),J=i("bfbggcdbfb"),X=n(J),Z=function(e){function t(){(0,l.default)(this,t);var e=(0,p.default)(this,(t.__proto__||(0,d.default)(t)).call(this));return e.checksum=void 0,e.listenTo(e,"remove",e.handleRemove),e}return(0,m.default)(t,e),(0,f.default)(t,[{key:"addNewLabel",value:function(e,t){(0,Q.logLabelOperationEvent)(X.default.LABEL_OPERATIONS.ADD,1,X.default.LABEL_TARGETS.LABEL);var i=I.default.createLabel(e,t),a=new K.ActionType(l10n.t("action_adding_new_label",{labelName:e})),n=(0,K.genId)(),r=i.then(function(t){return 200===t.status?new K.ActionType(l10n.t("action_new_label_added",{labelName:e})):new K.ActionType(l10n.t("action_new_label_add_failed",{labelName:e}))}).catch(function(t){return N.default.error("addingNewLabel dropped")(t),new K.ActionType(l10n.t("action_new_label_add_failed",{labelName:e}))});return W.default.openToast(T.createElement(K.ActionToast,{id:n,initialAction:a,pendingAction:r})),i}},{key:"addOrRemoveLabels",value:function(e,t){var i=I.default.addOrRemoveLabels(e,t),a=new K.ActionType(l10n.t("action_add_remove_labels",{count:e.length,_plural:e.length})),n=(0,K.genId)(),r=i.then(function(t){return 200===t.status?new K.ActionType(l10n.t("action_add_remove_labels_sucess",{count:e.length,_plural:e.length})):new K.ActionType(l10n.t("action_add_remove_labels_failed"))}).catch(function(e){return N.default.error("addingNewLabel dropped")(e),new K.ActionType(l10n.t("action_add_remove_labels_failed"))});return W.default.openToast(T.createElement(K.ActionToast,{id:n,initialAction:a,pendingAction:r})),i}},{key:"deleteLabel",value:function(e){(0,Q.logLabelOperationEvent)(X.default.LABEL_OPERATIONS.DELETE,1,X.default.LABEL_TARGETS.LABEL);var t=I.default.deleteLabel(e),i=this.assertGet(e),a=i.name,n=new K.ActionType(l10n.t("action_deleting_label",{labelName:a})),r=(0,K.genId)(),s=t.then(function(e){return 200===e.status?new K.ActionType(l10n.t("action_delete_label_sucess",{labelName:a})):new K.ActionType(l10n.t("action_delete_label_failed",{labelName:a}))}).catch(function(e){return N.default.error("addingNewLabel dropped")(e),new K.ActionType(l10n.t("action_delete_label_failed",{labelName:a}))});return W.default.openToast(T.createElement(K.ActionToast,{id:r,initialAction:n,pendingAction:s})),t}},{key:"updateLabel",value:function(e,t,i){(0,Q.logLabelOperationEvent)(X.default.LABEL_OPERATIONS.EDIT,1,X.default.LABEL_TARGETS.LABEL);var a=I.default.editLabel(e,i,t),n=new K.ActionType(l10n.t("action_label_update_color")),r=(0,K.genId)(),s=a.then(function(e){return 200===e.status?new K.ActionType(l10n.t("action_label_update_color_succeeded")):new K.ActionType(l10n.t("action_label_update_color_failed"))}).catch(function(e){return N.default.error("addingNewLabel dropped")(e),new K.ActionType(l10n.t("action_label_update_color_failed"))});return W.default.openToast(T.createElement(K.ActionToast,{id:r,initialAction:n,pendingAction:s})),a}},{key:"getNewLabelColor",value:function(){return I.default.queryNextLabelColor().then(function(e){return e.labelColors[0].color}).catch(function(e){})}},{key:"getLabelColorPalette",value:function(){return this.labelColorPalette=this.labelColorPalette||D.default.getSmbLabelPalette(),this.labelColorPalette&&this.labelColorPalette.waVersion===F.default.phone.wa_version?s.default.resolve(this.labelColorPalette.colors):this._getColorPaletteLoop().then(function(e){var t=e.labelColors.map(function(e){return e.color});return D.default.setSmbLabelPalette({colors:t,waVersion:F.default.phone.wa_version}),t}).catch(function(){})}},{key:"_getColorPaletteLoop",value:function(){return s.default.loop(function(e,t,i){var a=s.default.delay(x.default.expBackoff(i,12e4,1e3,.1));return("CONNECTED"===q.default.stream?s.default.resolve():B.waitForBBEvent(q.default,"change:stream",function(){return"CONNECTED"===q.default.stream})).then(function(){return I.default.queryLabelPalette().then(function(t){e(t)})}).catch(function(e){return!(e instanceof s.default.CancellationError)},function(e){return i>3||404===e?(N.default.error("labels:loadLabelPalette:error "+String(e))(),404===e?s.default.reject(new M.E404):s.default.reject(new M.GaveUpRetry("Gave up loading label palette "+i+" tries"))):a})},0)}},{key:"handleRemove",value:function(e){e.labeltemColleciton.toArray().forEach(function(e){var t=e.parentId,i=e.parentType,a=e.labelId,n=L.default[i].get(t);n&&(n.labels=b.default.remove(n.labels,function(e){return e!==a}))})}},{key:"onResume",value:function(){var e=this;this.filter(function(e){return e.hasObservers()}).forEach(function(t){e.find(t.id).catch(M.WapDrop,function(){})})}},{key:"delete",value:function(){(0,v.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"delete",this).call(this),delete this.checksum}},{key:"sync",value:function(e){if(!e||this.checksum!==e)return this.findQuery({})}},{key:"handle",value:function(e){if(e.checksum&&this.updateChecksum(e.checksum),e.labels&&e.labels[0]&&e.labels[0].labelUpdates){var t=void 0;return e.labels[0].labelUpdates.forEach(function(e){e.collection.forEach(function(i){"Msg"!==i&&"Chat"!==i||(t=!0);var a=e.id,n=L.default[i].get(e.id);n&&(n.labels&&n.labels.forEach(function(t){b.default.includes(e.labels,t)||(0,z.removeLabelFromCollection)(a,t,i)}),n.labels=e.labels)})}),void(t&&this.trigger("bulk_msg_chat_label_change"))}var i=[],a=[];e.labels.forEach(function(e){"delete"===e.type?i.push(e.label):a.push(e.label)}),this.remove(i.map(function(e){return e.id})),this.add(a,{merge:!0})}},{key:"_findQuery",value:function(){var e=this;return I.default.queryLabels().then(function(t){return t.checksum&&e.updateChecksum(t.checksum),t.labels})}},{key:"_find",value:function(e){return this._findQuery()}},{key:"updateChecksum",value:function(e){this.checksum=e}}]),t}(P.default);Z.model=k.default,Z.staleCollection=!0,Z.resumeOnAvailable=!0,t.default=new Z},bjcgjfiffb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(){return{default:arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,type:z.PROPS}}function r(){return{default:arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,type:z.SESSION}}function s(e,t){return{fn:e,deps:t,type:z.DERIVED}}function o(e){return{val:e,type:z.COLLECTION}}function d(e){var t=e.default;return t===K?{}:{default:t}}function u(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"__x_")+e}function l(e,t,i,a){if(!B.default.isObject(i))throw new Error("Invalid Prop/Session definition.");var n={sk:u(t),evt:"change:"+t,attr:a};void 0!==i.default&&(n.default=i.default),e._definition[t]=n;var r=B.default.isFunction(n.default);if(n.default&&!r){if(Array.isArray(n.default))throw new Error("Do not return mutable types as default values as they are shared. Type: Array provided.");if(B.default.isObject(n.default))throw new Error("Do not return mutable types as default values as they are shared. Type: Object provided.")}var s=n.sk;(0,F.default)(e,t,{set:function(e){this.set(t,e)},get:function(){var e=this[s];return e!==H?e:r?this[s]=n.default():n.default}})}function c(e,t,i){var a=u(t),n=i.fn;e._definition[t]=e._derived[t]={sk:a,evt:"change:"+t,attr:W.DERIVED,fn:n,deps:i.deps},(0,F.default)(e,t,{get:function(){var e=this[a];if(e!==H)return e;var t=n.call(this);return e!==t&&(this[a]=t),t},set:function(){throw new TypeError("'"+t+"' is a derived property, it can't be set directly.")}})}function f(e){var t=[];for(var i in e)t.push([i,e[i]]);return t}function h(e){for(var t={},i=(0,D.default)({}),a=e;(a=(0,D.default)(a))&&a!==i;)(0,N.default)(a).forEach(function(e){e in t||(t[e]=a[e])});return t}function p(e){var t=new e({},{_internalInitializationDoNotUse:!0}),i={name:e.name||"Unknown",props:{},session:{},derived:{},collections:{},isIdType:e.isIdType};e.Collection&&(i.Collection=e.Collection),e.idClass&&(i.idClass=e.idClass),e.idWhitelist&&(i.idWhitelist=e.idWhitelist);var a=new L.default(["constructor"]),n=new L.default(["collection","parent","__changes","__fired"]);f(t).forEach(function(t){var r=(0,I.default)(t,2),s=r[0],o=r[1];if(!n.has(s))switch(o.type){case z.PROPS:i.props[s]=d(o);break;case z.SESSION:i.session[s]=d(o);break;case z.DERIVED:i.derived[s]=B.default.omit(o,"type"),a.add(o.fn.name);break;case z.COLLECTION:i.collections[s]=o.val;break;default:throw new Error("Invalid defineModel Class type for "+e.name+":"+s+".")}});var r=h(t);return a.forEach(function(e){delete r[e]}),(0,P.default)(i,r),i}function g(e,t){return(0,b.default)({},t,function(e){function t(){return(0,T.default)(this,t),(0,M.default)(this,(t.__proto__||(0,D.default)(t)).apply(this,arguments))}return(0,k.default)(t,e),t}(e))[t]}function v(e,t){var i=t.name;delete t.name;var a=g(e,i),n=a.prototype,r=n.__props=[],s=n.__session=[],o=n.__derived=[],d=n._collections={},u=n._definition={},f=n._derived={},h=["props","session","derived","collections"];B.default.forOwn(t.props,function(e,t){r.push(t),l(n,t,e,W.PROP)}),B.default.forOwn(t.session,function(e,t){s.push(t),l(n,t,e,W.SESSION)}),B.default.forOwn(t.derived,function(e,t){o.push(t),c(n,t,e)}),B.default.forOwn(t.collections,function(e,t){d[t]=e}),B.default.assign(n,B.default.omit(t,h));var p=r.concat(s),v=p.length;(0,m.default)(n,{attributes:{get:function(){for(var e={},t=0;t<v;++t)e[p[t]]=this[p[t]];return e}},isState:{get:function(){return!0},set:function(){throw new Error("attempt to set isState")}}});for(var _={},y=0;y<v;y++){var b=p[y];"default"in u[b]&&(_[b]=H)}if(B.default.isEmpty(_)||(n.__defaults=_),o.length){var E=[],T={},C={};B.default.forEach(f,function(e,t){C[t]=!0,B.default.forEach(e.deps,function(e){C[e]=!0,(T[e]||(T[e]=[])).push(t),E.push([t,e])})}),E.length&&(n._deps=T,n._topo=q.default.array(B.default.keys(C),E).reverse())}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.NO_DEFAULT_VALUE=t.Attr=t.INIT=void 0;var _=i("deiecighjh"),m=a(_),y=i("cdhiacfjbg"),b=a(y),E=i("dfedaiidge"),T=a(E),C=i("bcddciefhh"),M=a(C),S=i("bghiedffgi"),k=a(S),j=i("ddhdfjihbb"),P=a(j),A=i("djchjahdbh"),I=a(A),O=i("beahfdeihb"),L=a(O),w=i("febejadah"),N=a(w),R=i("cjfdjhfbg"),D=a(R),G=i("iejfcagbc"),F=a(G),U=i("dcfadhibji"),x=a(U);t.prop=n,t.session=r,t.derived=s,t.collection=o,t.convert=p,t.stateExtend=v;var Y=i("hbhijdici"),B=a(Y),V=i("baejaciba"),q=a(V),H=t.INIT={sentinel:"INIT DERIVED PROP"},W=t.Attr={PROP:"PROP",SESSION:"SESSION",DERIVED:"DERIVED"},K=t.NO_DEFAULT_VALUE=(0,x.default)("NO_DEFAULT_VALUE"),z={PROPS:"Props",SESSION:"Session",DERIVED:"Derived",COLLECTION:"Collection"}},bjfecgfdgj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("djegeegcbf"),y=a(m),b=i("ccaaiecfib"),E=a(b),T=i("bdiiahhjbe"),C=a(T),M=i("dghggcieid"),S=a(M),k=i("cgcgbfbffj"),j=i("bdjdebcdd"),P=a(j),A=i("chajfbfiga"),I=a(A),O=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_findQuery",value:function(){return E.default.supportsFeature(E.default.F.RECENT_EMOJI_SYNC)?I.default.recentEmojiQuery(this.dirty?this.toArray():void 0).then(function(e){return Array.isArray(e)?(e.forEach(function(e){e.id=y.default.normalizeEmoji(e.id)}),r.default.resolve(e)):(C.default.error("models:recentEmoji:findQuery error",e)(),r.default.reject("recent emoji fetch error"))}):r.default.reject("gk recent emoji sync unsupported")}},{key:"throttledSync",value:function(){E.default.supportsFeature(E.default.F.RECENT_EMOJI_SYNC)&&(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"throttledSync",this).call(this)}},{key:"increment",value:function(e){var i=y.default.skinToneEmojis[e]||e;this.get(i)||this.add({id:i,weight:0}),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"_updateWeights",this).call(this,i)}}]),t}(P.default);O.model=S.default,O.cachePolicy={id:"recent_emoji_collection",policy:k.CACHE_POLICY.LOAD,delay:2e3},O.modelName="RecentEmoji",t.default=new O},bjgdagjjci:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return(0,O.isNumber)(e)&&e>=-90&&e<=90}function r(e){return(0,O.isNumber)(e)&&e>=-180&&e<=180}Object.defineProperty(t,"__esModule",{value:!0});var s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("dcaifjegcg"),y=a(m),b=i("djheacfeif"),E=a(b),T=i("bjebjijbfc"),C=a(T),M=i("bjigbaghc"),S=a(M),k=i("cigehdgbah"),j=a(k),P=i("jccfhaecf"),A=a(P),I=i("dfdhiegfdi"),O=i("hjbbdjjdf"),L=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,m.prop)(),a.msg=(0,m.prop)(),a.lat=(0,m.prop)(),a.lng=(0,m.prop)(),a.accuracy=(0,m.prop)(),a.speed=(0,m.prop)(),a.degrees=(0,m.prop)(),a.sequence=(0,m.prop)(),a.comment=(0,m.prop)(),a.expiration=(0,m.prop)(),a.lastUpdated=(0,m.prop)(),a.contact=(0,m.session)(),a.expireTimerId=(0,m.session)(),a.disabled=(0,m.session)(!1),a.isMe=(0,m.derived)(a._isMe,["id"]),a.valid=(0,m.derived)(a._valid,["lat","lng"]),n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_isMe",value:function(){return this.id.equals(S.default.me)}},{key:"_valid",value:function(){return n(this.lat)&&r(this.lng)}},{key:"initialize",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"initialize",this).call(this),this.addChild("contact",j.default.gadd(this.id)),(0,I.addLiveLocation)(this.contact,this),this.listenTo(this,"change:expiration",this._setExpireTimer),this._setExpireTimer()}},{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this._disableMsg(),(0,I.removeLiveLocation)(this.contact,this),this._clearExpireTimer()}},{key:"remainingTime",value:function(){return this.expiration-C.default.globalUnixTime()}},{key:"elapsedTime",value:function(){return C.default.globalUnixTime()-this.lastUpdated}},{key:"disable",value:function(){this.disabled=!0}},{key:"_disableMsg",value:function(){var e=this.msg;e&&(e.shareDuration=C.default.globalUnixTime()-e.t-1)}},{key:"_setExpireTimer",value:function(){if(this.expiration)return this.remainingTime()<=0?void this._expire():void(this.expireTimerId=E.default.setGlobalTimeout(this._expire.bind(this),1e3*this.expiration,this.expireTimerId))}},{key:"_clearExpireTimer",value:function(){E.default.clearTimeout(this.expireTimerId),this.expireTimerId=null}},{key:"_expire",value:function(){this.disable()}}]),t}(y.default);L.Proxy="liveLocationParticipant",L.idClass=A.default,t.default=(0,m.defineModel)(L)},bjigbaghc:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mcc,i=e.mnc;t&&"string"==typeof t&&(t=parseInt(t,10)),i&&"string"==typeof i&&(i=parseInt(i,10)),F.default.Global.set({mcc:t||null,mnc:i||null,webcPhoneDeviceManufacturer:e.device_manufacturer||null,webcPhoneDeviceModel:e.device_model||null,webcPhoneOsBuildNumber:e.os_build_number||null,webcPhoneOsVersion:e.os_version||null,webcPhoneAppVersion:e.wa_version||null})}Object.defineProperty(t,"__esModule",{value:!0}),t.PLATFORMS=void 0;var r=i("bachgbfdhf"),s=a(r),o=i("djchjahdbh"),d=a(o),u=i("cjfdjhfbg"),l=a(u),c=i("dfedaiidge"),f=a(c),h=i("cdaghjbcia"),p=a(h),g=i("bcddciefhh"),v=a(g),_=i("bghiedffgi"),m=a(_),y=i("hbhijdici"),b=a(y),E=i("dcaifjegcg"),T=a(E),C=i("dcbbccfgab"),M=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(C),S=i("bfigfgcaaj"),k=a(S),j=i("bjebjijbfc"),P=a(j),A=i("eadfaddcj"),I=a(A),O=i("ccaaiecfib"),L=a(O),w=i("fffdgbfji"),N=a(w),R=i("bdiiahhjbe"),D=a(R),G=i("bfbggcdbfb"),F=a(G),U=i("bhggeigghg"),x=a(U),Y=i("bebehddcbc"),B=a(Y),V=t.PLATFORMS={ANDROID:"android",BB:"bb",BBX:"bbx",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",S40:"s40",SMBA:"smba",SMBI:"smbi",SYMBIAN:"symbian",WP7:"wp7"},q=function(e){function t(){var e,i,a,n;(0,f.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,v.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,E.prop)(),a.ref=(0,E.prop)(),a.refTTL=(0,E.prop)(),a.refId=(0,E.prop)(),a.wid=(0,E.prop)(),a.connected=(0,E.prop)(),a.me=(0,E.prop)(),a.protoVersion=(0,E.prop)(),a.clientToken=(0,E.prop)(),a.serverToken=(0,E.prop)(),a.secret=(0,E.prop)(),a.isResponse=(0,E.prop)(),a.battery=(0,E.prop)(),a.plugged=(0,E.prop)(),a.lc=(0,E.prop)(),a.lg=(0,E.prop)(),a.locales=(0,E.prop)(),a.is24h=(0,E.prop)(),a.platform=(0,E.prop)(),a.phone=(0,E.prop)(),a.tos=(0,E.prop)(),a.smbTos=(0,E.prop)(0),a.pushname=(0,E.prop)(),a.blockStoreAdds=(0,E.session)(!1),a.refExpiry=(0,E.derived)(a._refExpiry,["ref","refTTL"]),a.locale=(0,E.derived)(a._locale,["lg","lc"]),a.localesList=(0,E.derived)(a._localesList,["locales","lg","lc"]),a.allLocales=(0,E.derived)(a._allLocales,["localesList"]),a.allLanguages=(0,E.derived)(a._allLanguages,["localesList"]),a.platformField=(0,E.derived)(a._platformField,["platform"]),a.tosShowCallNotification=(0,E.derived)(a._tosShowCallNotification,["tos"]),a.isSMB=(0,E.derived)(a._isSMB,["platform"]),n=i,(0,v.default)(a,n)}return(0,m.default)(t,e),(0,p.default)(t,[{key:"_refExpiry",value:function(){return Date.now()+this.refTTL}},{key:"_locale",value:function(){return this.formatLocale(this.lg,this.lc)}},{key:"_localesList",value:function(){return this.locales&&this.locales.length?this.locales.split(",").map(function(e){var t=e.split("-"),i=(0,d.default)(t,2),a=i[0],n=i[1];return a?[a,n]:null}).filter(function(e){return!!e}):this.lg?[[this.lg,this.lc]]:[]}},{key:"_allLocales",value:function(){var e=this;return b.default.uniq(this.localesList.map(function(t){var i=(0,d.default)(t,2),a=i[0],n=i[1];return e.formatLocale(a,n)}))}},{key:"_allLanguages",value:function(){return b.default.uniq(this.localesList.map(function(e){var t=(0,d.default)(e,2),i=t[0];t[1];return i}))}},{key:"_platformField",value:function(){return"wp7"===this.platform?F.default.PLATFORM_TYPE.WP:this.platform?F.default.PLATFORM_TYPE[this.platform.toUpperCase()]||F.default.PLATFORM_TYPE.UNKNOWN:F.default.PLATFORM_TYPE.UNKNOWN}},{key:"_tosShowCallNotification",value:function(){return this.tos<2}},{key:"_isSMB",value:function(){return this.platform===V.SMBA||this.platform===V.SMBI}},{key:"initialize",value:function(){var e=this;T.default.prototype.initialize.call(this),this.listenTo(this,"change:locale",function(e,t){N.default.setLocale(t,I.default.L10N_PRIORITY.PHONE)}),this.listenTo(this,"change:plugged",b.default.debounce(function(){F.default.Global.webcPhoneCharging=e.plugged},5e3,{leading:!0})),this.listenTo(this,"change:phone",function(){n(e.phone)}),this.listenTo(this,"change:me",this.updateVoipAvailability),this.listenTo(L.default,L.default.FEATURE_CHANGE_EVENT,this.updateVoipAvailability),this.listenTo(this,"change:platform",this.handlePlatformChange)}},{key:"delete",value:function(){B.default.setPushname(),B.default.setLastMobilePlatform(),B.default.setVersion(),this.clear()}},{key:"handle",value:function(e){var t=this,a=void 0,n=e.shift();n.id="1";var r=i("chajfbfiga").default,o=n.protoVersion,d=n.binVersion,u=n.features;if(o){L.default.setVersion(o),u=u||{};a=!!L.default.setFeatures(u).KEY_PARTICIPANT,r.setVersion(o,d,u.FLAGS),x.default.ServerProps.webRestoreFromCache&&B.default.setVersion({protoVersion:o,features:u.FLAGS})}if(n.initial){L.default.setPlatform(n.platform,n.phone),B.default.setLogoutToken(n.browserToken),n.hasOwnProperty("is24h")&&P.default.setIs24Hour(n.is24h);var l=n.ref,c=n.serverToken,f=n.clientToken,h=n.connected;l&&h&&c&&B.default.setRefTok(l,c),B.default.setLoginTokens({client:f,server:c});return(n.secret?r.setSharedSecret(n.secret):s.default.resolve()).then(function(){if("true"!==n.isResponse&&M.save(),"iw"===n.lg&&(n.lg="he"),n.wid){var e=n.wid;t.me=e,n.pushname&&(t.pushname=n.pushname,B.default.setPushname(n.pushname)),B.default.setMe(e),x.default.Contact.gadd(e)}t.set(n)})}return this.connected&&a&&(D.default.log("models:Conn:participantChange:to:"+String(L.default.supportsFeature(L.default.F.KEY_PARTICIPANT)))(),k.default.hardRefresh()),this.set(n),s.default.resolve()}},{key:"canSetMyPushname",value:function(){return!this.isSMB}},{key:"updateVoipAvailability",value:function(){var e=i("bhgjacgcdd").default;(L.default.supportsFeature(L.default.F.VOIP_INDIVIDUAL_OUTGOING)||L.default.supportsFeature(L.default.F.VOIP_INDIVIDUAL_INCOMING))&&(this.me?e.init():e.cleanup())}},{key:"handlePlatformChange",value:function(){B.default.setLastMobilePlatform(this.platform)}},{key:"formatLocale",value:function(e,t){return e?t?e.toLowerCase()+"-"+t.toUpperCase():e.toLowerCase():null}}]),t}(T.default);q.Proxy="conn";var H=(0,E.defineModel)(q);t.default=new H({id:"1"})},caedaejadb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("cajijabhgb"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(m),b=i("eadfaddcj"),E=a(b),T=i("cbcbdjdah"),C=a(T),M=i("biecbbiiee"),S=a(M),k=i("cgcgbfbffj"),j=a(k),P=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.hasLinkBefore=!0,n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.stopListening(),this.reset()}},{key:"queryLinks",value:function(e,t){var i=this;if(t)return this.queryLinkBefore?this.queryLinkBefore:(this.queryLinkBefore=S.default.queryMedia(t.id.remote,E.default.MEDIA_QUERY_LIMIT,"before",t.id,"url").then(function(e){return(!e||e.length<E.default.MEDIA_QUERY_LIMIT)&&(i.hasLinkBefore=!1),i.add(e,{at:0}),i.createLinksAndAddMsgs(e),{length:e.length}}).catch(y.WapDrop,y.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryLinkBefore=null,i.trigger("query_link_before")}),this.trigger("query_link_before"),this.queryLinkBefore);var a=e.msgs.getModelsArray();if(0===this.length){if(!a||0===a.length)return this.hasLinkBefore=!1,new r.default(function(e){e({eof:!0})});this.add(a.filter(function(e){return e.getLinks().length>0}),{at:0}),this.createLinksAndAddMsgs(a)}if(e.msgs.msgLoadState.noEarlierMsgs)return this.hasLinkBefore=!1,new r.default(function(e){e({eof:!0})});if(this.length<=2*E.default.MEDIA_QUERY_LIMIT){var n=0===this.length?e.msgs.head():this.head();return this.queryLinks(e,n)}return new r.default(function(e){e({eof:!1})})}},{key:"createLinksAndAddMsgs",value:function(e){var t=this,i=[];r.default.loop(function(t,a,n){e.length===n&&t();var r=e[n];r.getLinks().length&&i.push(r)}).then(function(){t.add(i),t.trigger("query_link_before")})}}]),t}(j.default);P.model=C.default,P.comparator=function(e,t){return e.t-t.t},t.default=P},cbcbdjdah:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e){return new Pe(e)}function s(e,t,i){var a={ack:0,id:new se.default({id:"product_inquiry",remote:t,fromMe:!0}),from:t,t:D.default.globalUnixTime(),type:S.MSG_TYPE.PRODUCT,title:e.name,description:e.description,businessOwnerJid:t.toString({legacy:!0}),productId:e.id.toString(),url:e.url,productImageCount:e.productImageCollection.length,body:i.preview._b64,currencyCode:e.currency,priceAmount1000:e.priceAmount1000},n=r(a);return n.mediaData.set(i),n}Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE=void 0;var o=i("chdihcfabe"),d=n(o),u=i("djchjahdbh"),l=n(u),c=i("bachgbfdhf"),f=n(c),h=i("cjfdjhfbg"),p=n(h),g=i("dfedaiidge"),v=n(g),_=i("cdaghjbcia"),m=n(_),y=i("bcddciefhh"),b=n(y),E=i("ciaebjeace"),T=n(E),C=i("bghiedffgi"),M=n(C),S=i("eadfaddcj");Object.defineProperty(t,"TYPE",{enumerable:!0,get:function(){return S.MSG_TYPE}}),t.createProductInquiry=s;var k=i("hbhijdici"),j=n(k),P=i("ddgbhifaji"),A=a(P),I=i("dcaifjegcg"),O=n(I),L=i("daffbcegjj"),w=n(L),N=n(S),R=i("bjebjijbfc"),D=n(R),G=i("gbfffciea"),F=n(G),U=i("bjigbaghc"),x=n(U),Y=i("bjgiedaj"),B=n(Y),V=i("djegeegcbf"),q=n(V),H=i("ccaaiecfib"),W=n(H),K=i("dbcedfihd"),z=a(K),Q=i("bdiiahhjbe"),J=n(Q),X=i("bffjfbgbg"),Z=n(X),$=i("bfbggcdbfb"),ee=n($),te=i("bfgbdiffgd"),ie=n(te),ae=i("bhggeigghg"),ne=n(ae),re=i("ccgjijjbbj"),se=n(re),oe=i("ccbagdhfbb"),de=a(oe),ue=i("ebggjhghhi"),le=a(ue),ce=i("jccfhaecf"),fe=n(ce),he=i("cfejjfjhca"),pe=n(he),ge=i("cgfjebhhej"),ve=n(ge),_e=i("djbfhebjhe"),me=n(_e),ye=i("hciaejfjd"),be=n(ye),Ee=i("cijheiibhg"),Te=n(Ee),Ce=i("chhhffajfi"),Me=i("bcjidabgad"),Se=i("hjbbdjjdf"),ke=i("bdgehigfig"),je=function(e){function t(){var e,i,a,n;(0,v.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,b.default)(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,I.prop)(),a.body=(0,I.prop)(),a.type=(0,I.prop)(),a.subtype=(0,I.prop)(),a.t=(0,I.prop)(),a.notifyName=(0,I.prop)(),a.from=(0,I.prop)(),a.to=(0,I.prop)(),a.author=(0,I.prop)(),a.self=(0,I.prop)("in"),a.ack=(0,I.prop)(),a.invis=(0,I.prop)(),a.isNewMsg=(0,I.prop)(),a.star=(0,I.prop)(!1),a.recvFresh=(0,I.prop)(),a.caption=(0,I.prop)(),a.clientUrl=(0,I.prop)(),a.loc=(0,I.prop)(),a.lat=(0,I.prop)(),a.lng=(0,I.prop)(),a.isLive=(0,I.prop)(),a.accuracy=(0,I.prop)(),a.speed=(0,I.prop)(),a.degrees=(0,I.prop)(),a.comment=(0,I.prop)(),a.sequence=(0,I.prop)(),a.shareDuration=(0,I.prop)(),a.finalLat=(0,I.prop)(),a.finalLng=(0,I.prop)(),a.finalAccuracy=(0,I.prop)(),a.finalThumbnail=(0,I.prop)(),a.finalSpeed=(0,I.prop)(),a.finalDegrees=(0,I.prop)(),a.finalTimeOffset=(0,I.prop)(),a.directPath=(0,I.prop)(),a.mimetype=(0,I.prop)(),a.duration=(0,I.prop)(),a.filehash=(0,I.prop)(),a.uploadhash=(0,I.prop)(),a.size=(0,I.prop)(),a.filename=(0,I.prop)(),a.streamingSidecar=(0,I.prop)(),a.mediaKey=(0,I.prop)(),a.pageCount=(0,I.prop)(),a.isGif=(0,I.prop)(),a.gifAttribution=(0,I.prop)(),a.streamable=(0,I.prop)(),a.width=(0,I.prop)(),a.height=(0,I.prop)(),a.canonicalUrl=(0,I.prop)(),a.matchedText=(0,I.prop)(),a.thumbnail=(0,I.prop)(),a.richPreviewType=(0,I.prop)(),a.title=(0,I.prop)(),a.description=(0,I.prop)(),a.businessOwnerJid=(0,I.prop)(),a.productId=(0,I.prop)(),a.currencyCode=(0,I.prop)(),a.priceAmount1000=(0,I.prop)(),a.retailerId=(0,I.prop)(),a.url=(0,I.prop)(),a.productImageCount=(0,I.prop)(),a.pseudoReply=(0,I.prop)(),a.recipients=(0,I.prop)(),a.broadcast=(0,I.prop)(),a.quotedMsg=(0,I.prop)(),a.quotedStanzaID=(0,I.prop)(),a.quotedRemoteJid=(0,I.prop)(),a.quotedParticipant=(0,I.prop)(),a.mentionedJidList=(0,I.prop)(),a.multicast=(0,I.prop)(),a.urlText=(0,I.prop)(),a.urlNumber=(0,I.prop)(),a.clearMedia=(0,I.prop)(),a.vcardList=(0,I.prop)(),a.protocolMessageKey=(0,I.prop)(),a.templateParams=(0,I.prop)(),a.textColor=(0,I.prop)(),a.backgroundColor=(0,I.prop)(),a.font=(0,I.prop)(),a.isForwarded=(0,I.prop)(!1),a.forwardingScore=(0,I.prop)(),a.labels=(0,I.prop)(),a.currency=(0,I.prop)(),a.amount1000=(0,I.prop)(),a.receiverJid=(0,I.prop)(),a.paymentStatus=(0,I.prop)(),a.paymentNoteMsg=(0,I.prop)(),a.paymentTransactionTimestamp=(0,I.prop)(),a.paymentRequestMessageKey=(0,I.prop)(),a._currencyCodeIso4217=(0,I.prop)(),a._paymentRequestFrom=(0,I.prop)(),a._paymentExpiryTimestamp=(0,I.prop)(),a.promises=(0,I.session)(function(){return{}}),a.local=(0,I.session)(),a.search=(0,I.session)(),a.msgChunk=(0,I.session)(),a.phoneUploading=(0,I.session)(),a.startOfDay=(0,I.session)(),a.startOfDaySkew=(0,I.session)(),a._quotedMsgObj=(0,I.session)(),a.isQuotedMsgAvailable=(0,I.session)(!0),a.senderObj=(0,I.session)(),a.mediaData=(0,I.session)(),a.inviteCode=(0,I.prop)(),a.inviteCodeExp=(0,I.prop)(),a.inviteGrp=(0,I.prop)(),a.inviteGrpName=(0,I.prop)(),a.inviteGrpJpegThum=(0,I.prop)(),a._links=(0,I.session)(function(){return[]}),a.linksIndexParsed=(0,I.session)(0),a.chat=(0,I.derived)(a._chat),a.isFutureproof=(0,I.derived)(a._isFutureproof,["type","subtype"]),a.isGroupMsg=(0,I.derived)(a._isGroupMsg),a.isStatusV3=(0,I.derived)(a._isStatusV3),a.isPSA=(0,I.derived)(a._isPSA),a.isProductInquiry=(0,I.derived)(a._isProductInquiry),a.statusV3TextBg=(0,I.derived)(a._statusV3TextBg),a.isSentByMe=(0,I.derived)(a._isSentByMe),a.isSentByMeFromWeb=(0,I.derived)(a._isSentByMeFromWeb,["isUserCreatedType"]),a.isNotification=(0,I.derived)(a._isNotification,["type"]),a.isGroupNotification=(0,I.derived)(a._isGroupNotification,["type"]),a.isBroadcastNotification=(0,I.derived)(a._isBroadcastNotification,["type"]),a.isBizNotification=(0,I.derived)(a._isBizNotification,["type","subtype"]),a.isProduct=(0,I.derived)(a._isProduct,["type"]),a.isMedia=(0,I.derived)(a._isMedia,["type"]),a.isDoc=(0,I.derived)(a._isDoc,["type"]),a.isMMS=(0,I.derived)(a._isMMS,["type"]),a.isRevoked=(0,I.derived)(a._isRevoked,["type"]),a.numTimesForwarded=(0,I.derived)(a._numTimesForwarded,["isForwarded","forwardingScore"]),a.isFrequentlyForwarded=(0,I.derived)(a._isFrequentlyForwarded,["numTimesForwarded"]),a.eventType=(0,I.derived)(a._eventType,["type","invis","isNewMsg"]),a.sender=(0,I.derived)(a._sender),a.text=(0,I.derived)(a._text,["type","body","caption","comment","isLive","paymentNoteMsg"]),a.containsEmoji=(0,I.derived)(a._containsEmoji,["text"]),a.isFailed=(0,I.derived)(a._isFailed,["isSentByMe","ack"]),a.vcard=(0,I.derived)(a._vcard,["type","body"]),a.isUnsentMedia=(0,I.derived)(a._isUnsentMedia,["ack","isMMS","isSentByMe"]),a.dir=(0,I.derived)(a._dir,["type","text","subtype"]),a.rtl=(0,I.derived)(a._rtl,["type","text","subtype"]),a.linkPreview=(0,I.derived)(a._linkPreview,["matchedText","body","title","description"]),a.isGroupsV4InviteExpired=(0,I.derived)(a._isGroupsV4InviteExpired,["type","inviteCode","inviteCodeExp"]),a.isPersistent=(0,I.derived)(a._isPersistent),a.isUnreadType=(0,I.derived)(a._isUnreadType,["type"]),a.isUserCreatedType=(0,I.derived)(a._isUserCreatedType,["type"]),a.initialPageSize=(0,I.derived)(a._initialPageSize,["isFrequentlyForwarded"]),n=i,(0,b.default)(a,n)}return(0,M.default)(t,e),(0,m.default)(t,[{key:"_chat",value:function(){return ne.default.Chat.get(this.id.remote)}},{key:"_isFutureproof",value:function(){return this.type===S.MSG_TYPE.UNKNOWN||this.type===S.MSG_TYPE.PAYMENT&&"futureproof"===this.subtype}},{key:"_isGroupMsg",value:function(){return fe.default.isGroup(this.from)||fe.default.isGroup(this.to)}},{key:"_isStatusV3",value:function(){return fe.default.isStatusV3(this.id.remote)}},{key:"_isPSA",value:function(){return fe.default.isPSA(this.id.remote)}},{key:"_isProductInquiry",value:function(){return this.pseudoReply||this.id&&this.id.id===N.default.PRODUCT_INQUIRY_TYPE}},{key:"_statusV3TextBg",value:function(){if(!this.isStatusV3)return null;var e=this.backgroundColor;return e?"rgba("+(e>>16&255)+", "+(e>>8&255)+", "+(255&e)+", "+(e>>24&255)+")":null}},{key:"_isSentByMe",value:function(){return"in"!==this.id.self&&!this.isNotification&&fe.default.equals(this.from,x.default.me)}},{key:"_isSentByMeFromWeb",value:function(){return this.id.fromMe&&this.local&&this.isUserCreatedType}},{key:"_isNotification",value:function(){switch(this.type){case S.MSG_TYPE.GROUP_NOTIFICATION:case S.MSG_TYPE.GP2:case S.MSG_TYPE.BROADCAST_NOTIFICATION:case S.MSG_TYPE.NOTIFICATION:case S.MSG_TYPE.NOTIFICATION_TEMPLATE:case S.MSG_TYPE.E2E_NOTIFICATION:case S.MSG_TYPE.CALL_LOG:return!0;default:return!1}}},{key:"_isGroupNotification",value:function(){switch(this.type){case S.MSG_TYPE.GROUP_NOTIFICATION:case S.MSG_TYPE.GP2:return!0;default:return!1}}},{key:"_isBroadcastNotification",value:function(){return this.type===S.MSG_TYPE.BROADCAST_NOTIFICATION}},{key:"_isBizNotification",value:function(){if(this.type===S.MSG_TYPE.NOTIFICATION_TEMPLATE)switch(this.subtype){case"verified_initial_unknown":case"verified_initial_low":case"verified_initial_high":case"verified_transition_any_to_none":case"verified_transition_any_to_high":case"verified_transition_high_to_low":case"verified_transition_high_to_unknown":case"verified_transition_unknown_to_low":case"verified_transition_low_to_unknown":case"verified_transition_none_to_low":case"verified_transition_none_to_unknown":case"biz_verified_transition_top_to_bottom":case"biz_verified_transition_bottom_to_top":case"biz_intro_top":case"biz_intro_bottom":case"biz_name_change":case"biz_move_to_consumer_app":case"biz_two_tier_migration_top":case"biz_two_tier_migration_bottom":return!0;default:return!1}return!1}},{key:"_isProduct",value:function(){return"product"===this.type}},{key:"_isMedia",value:function(){return["image","video","audio","product"].indexOf(this.type)>-1}},{key:"_isDoc",value:function(){return"document"===this.type}},{key:"_isMMS",value:function(){return de.typeIsMMS(this.type)}},{key:"_isRevoked",value:function(){return this.type===S.MSG_TYPE.REVOKED}},{key:"_numTimesForwarded",value:function(){return this.forwardingScore?this.forwardingScore||0:this.isForwarded?1:0}},{key:"_isFrequentlyForwarded",value:function(){return this.numTimesForwarded>=N.default.FREQUENTLY_FORWARDED_SENTINEL}},{key:"_eventType",value:function(){if(!this.isNewMsg)return"i";var e=this.eventTypeFromMsgType();return this.invis?"i"===e?"i":"n":e}},{key:"_sender",value:function(){return this.isSentByMe?this.from:this.isGroupMsg||this.isStatusV3?this.author:this.from}},{key:"_text",value:function(){switch(this.type){case S.MSG_TYPE.CHAT:return this.body;case S.MSG_TYPE.IMAGE:case S.MSG_TYPE.VIDEO:return this.caption;case S.MSG_TYPE.LOCATION:return this.isLive?this.comment:void 0;case S.MSG_TYPE.PAYMENT:var e=this.paymentNoteMsg;return e?e.body:void 0;case S.MSG_TYPE.GROUPS_V4_INVITE:return this.comment;case S.MSG_TYPE.PRODUCT:return this.getProductInfoText();default:return}}},{key:"_containsEmoji",value:function(){var e=this.text;return!!e&&q.default.containsEmoji(e)}},{key:"_isFailed",value:function(){return this.isSentByMe&&this.ack<0}},{key:"_vcard",value:function(){if(this.type===S.MSG_TYPE.VCARD)try{return ve.default.parse(this.body)}catch(e){return}}},{key:"_isUnsentMedia",value:function(){return this.ack<1&&this.isMMS&&this.isSentByMe}},{key:"_dir",value:function(){return this.type===S.MSG_TYPE.VCARD?this.subtype?w.default.dir(this.subtype):void 0:this.text?w.default.dir(this.text):void 0}},{key:"_rtl",value:function(){return this.type===S.MSG_TYPE.VCARD?!!this.subtype&&"rtl"===w.default.dir(this.subtype):!!this.text&&"rtl"===w.default.dir(this.text)}},{key:"_linkPreview",value:function(){return(0,Se.isString)(this.matchedText)&&(!j.default.isEmpty(this.title)||!j.default.isEmpty(this.description))&&this.body.indexOf(this.matchedText)>-1}},{key:"_isGroupsV4InviteExpired",value:function(){if(this.type!==N.default.MSG_TYPE.GROUPS_V4_INVITE)return!1;if(!this.inviteCode)return!0;var e=(new Date).getTime()/1e3;return parseInt(e,10)>=parseInt(this.inviteCodeExp,10)}},{key:"_isPersistent",value:function(){return this.type===S.MSG_TYPE.E2E_NOTIFICATION&&"encrypt"===this.subtype}},{key:"_isUnreadType",value:function(){return[S.MSG_TYPE.CHAT,S.MSG_TYPE.IMAGE,S.MSG_TYPE.VIDEO,S.MSG_TYPE.AUDIO,S.MSG_TYPE.PTT,S.MSG_TYPE.DOCUMENT,S.MSG_TYPE.VCARD,S.MSG_TYPE.LOCATION,S.MSG_TYPE.CIPHERTEXT,S.MSG_TYPE.OVERSIZED,S.MSG_TYPE.MULTI_VCARD,S.MSG_TYPE.REVOKED,S.MSG_TYPE.UNKNOWN,S.MSG_TYPE.STICKER,S.MSG_TYPE.PRODUCT,S.MSG_TYPE.GROUPS_V4_INVITE].indexOf(this.type)>=0}},{key:"_isUserCreatedType",value:function(){return[S.MSG_TYPE.PROTOCOL,S.MSG_TYPE.CHAT,S.MSG_TYPE.LOCATION,S.MSG_TYPE.VCARD,S.MSG_TYPE.MULTI_VCARD,S.MSG_TYPE.IMAGE,S.MSG_TYPE.VIDEO,S.MSG_TYPE.AUDIO,S.MSG_TYPE.PTT,S.MSG_TYPE.DOCUMENT,S.MSG_TYPE.STICKER,S.MSG_TYPE.PRODUCT,S.MSG_TYPE.GROUPS_V4_INVITE].indexOf(this.type)>=0}},{key:"_initialPageSize",value:function(){return this.isFrequentlyForwarded?N.default.FREQUENTLY_FORWARDED_INITIAL_PAGE_SIZE:N.default.INITIAL_PAGE_SIZE}},{key:"initialize",value:function(){var e=this;if((0,T.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"initialize",this).call(this),this.sender)this.addChild("senderObj",ne.default.Contact.gadd(this.sender));else switch(this.type){case S.MSG_TYPE.NOTIFICATION:case S.MSG_TYPE.NOTIFICATION_TEMPLATE:case S.MSG_TYPE.GROUP_NOTIFICATION:case S.MSG_TYPE.GP2:case S.MSG_TYPE.BROADCAST_NOTIFICATION:case S.MSG_TYPE.E2E_NOTIFICATION:case S.MSG_TYPE.CALL_LOG:case S.MSG_TYPE.PROTOCOL:break;default:J.default.log("msg:msg with no sender id:"+this.id.toString()+", from:"+this.from.toString()+", author:"+(this.author&&this.author.toString())+", type:"+this.type)()}j.default.forEach(this.mentionedJidList,function(e){return ne.default.Contact.gadd(e)});var i=void 0,a=this.getCollection();(i=a.preAck[this.id])&&(J.default.log("Msg:initialize updating msg with out of order ack",i)(),this.updateAck(i.ack),delete a.preAck[this.id]),this.type===S.MSG_TYPE.CIPHERTEXT&&this.listenToOnce(this,"change:type",this.onCiphertextDecrypted),this._mediaObject=void 0,de.typeIsMMS(this.type)&&(this._createMediaDataChild(),A.registerMsg(this)),this.isSentByMeFromWeb&&(this.promises.sendPromise=f.default.sit("settled").finally(function(){e.promises.sendPromise=null}).endWithControls("settled")),this.isLive&&ne.default.LiveLocation.processMsg(this,!1),x.default.isSMB&&(this.addLabelsToCollection(),this.listenTo(this,"change:labels",this.addLabelsToCollection)),ie.default.webRestoreFromCache&&this.listenTo(this,"change:ack",this.onAckChange)}},{key:"getLinks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.initialPageSize+1,t=this.text;if(!t)return this._links;if(this.linksIndexParsed>=e)return this._links;var i=(0,Ce.firstNCodepoints)(t,e),a=z.findLinks(i,!1,this.sender);if(t.length>e&&a.length>0){var n=a[a.length-1];n.index+(0,Ce.numCodepoints)(n.url)===e&&(a=z.findLinks(t,!1,this.sender))}return this.linksIndexParsed=e,this._links=a}},{key:"getGalleryLinks",value:function(){return j.default.uniqBy(this.getLinks(),"href").filter(function(e){return e.isHttp})}},{key:"getSuspiciousLinks",value:function(){return this.getLinks().filter(function(e){return e.suspiciousCharacters&&e.suspiciousCharacters.size})}},{key:"addLabelsToCollection",value:function(){(0,be.default)(this.id.toString(),this.labels,"Msg")}},{key:"_createMediaDataChild",value:function(){this.addChild("mediaData",new Z.default)}},{key:"hasSymbol",value:function(){return["image","video","audio","ptt","location","vcard","multi_vcard","document","ciphertext","oversized","unknown","call_log","revoked","sticker","payment","groups_v4_invite","product"].indexOf(this.type)>-1}},{key:"mayFail",value:function(){return this.isSentByMe&&this.ack<1}},{key:"isUnsentPhoneMsg",value:function(){return!this.local&&this.isSentByMe&&this.ack<1}},{key:"canReply",value:function(){return this.chat.canSend&&!this.mayFail()&&!this.isNotification&&this.type!==S.MSG_TYPE.UNKNOWN&&this.type!==S.MSG_TYPE.CIPHERTEXT&&this.type!==S.MSG_TYPE.OVERSIZED&&this.type!==S.MSG_TYPE.REVOKED&&W.default.supportsFeature(W.default.F.REPLIES_OUT)}},{key:"canPrivateReply",value:function(){return!this.mayFail()&&!this.isNotification&&this.type!==S.MSG_TYPE.UNKNOWN&&this.type!==S.MSG_TYPE.CIPHERTEXT&&this.type!==S.MSG_TYPE.OVERSIZED&&this.type!==S.MSG_TYPE.REVOKED&&W.default.supportsFeature(W.default.F.REPLIES_OUT)&&!this.isSentByMe&&this.isGroupMsg&&W.default.supportsFeature(W.default.F.PRIVATE_REPLY)}},{key:"canPrivateReplyInRestrictedGrp",value:function(){return!!this.chat.isAnnounceGrpRestrict&&!this.chat.isReadOnly&&W.default.supportsFeature(W.default.F.PRIVATE_REPLY)&&W.default.supportsFeature(W.default.F.REPLIES_OUT)&&!this.mayFail()&&!this.isSentByMe&&!this.isNotification&&this.type!==S.MSG_TYPE.UNKNOWN&&this.type!==S.MSG_TYPE.CIPHERTEXT&&this.type!==S.MSG_TYPE.OVERSIZED&&this.type!==S.MSG_TYPE.REVOKED}},{key:"canForward",value:function(){if(this.type===S.MSG_TYPE.CIPHERTEXT)return!1;if(this.type===S.MSG_TYPE.OVERSIZED)return!1;if(this.type===S.MSG_TYPE.REVOKED)return!1;if(this.type===S.MSG_TYPE.UNKNOWN)return!1;if(this.type===S.MSG_TYPE.PAYMENT)return!1;if(this.type===S.MSG_TYPE.GROUPS_V4_INVITE)return!1;if(this.type===S.MSG_TYPE.LOCATION&&this.isLive)return!1;if(this.ack<1&&this.isSentByMe)return!1;if(this.isMMS){var e=this.mediaData;if(!A.canSendType(e.type))return!1;if(e.mediaStage===Z.default.STAGE.ERROR_MISSING)return!1;if(e.mediaStage===Z.default.STAGE.ERROR_UNSUPPORTED)return!1;if(this.isUnsentMedia)return!1}return!0}},{key:"canQuickForward",value:function(){return this.canForward()&&!this.isFrequentlyForwarded&&0===this.getSuspiciousLinks().length&&this.type!==N.default.MSG_TYPE.PTT&&this.type!==N.default.MSG_TYPE.STICKER&&(this.isMMS||this.linkPreview||this.type===N.default.MSG_TYPE.LOCATION)}},{key:"canStar",value:function(){return!(this.isNotification||this.isFutureproof||this.type===S.MSG_TYPE.REVOKED||this.ack<1&&this.isSentByMe)}},{key:"isGroupLeave",value:function(){return"gp2"===this.type&&("leave"===this.subtype||"remove"===this.subtype)&&fe.default.equals(j.default.head(this.recipients),x.default.me)}},{key:"isTrusted",value:function(){return!!fe.default.equals(this.sender,x.default.me)||(!(!this.senderObj||!this.senderObj.isMyContact)||(this.isGroupMsg?this.chat.isTrusted():this.chat.notSpam))}},{key:"getWAids",value:function(){return this.type!==S.MSG_TYPE.VCARD?null:ve.default.vcardWAids(this.vcard)}},{key:"getVCardThumbnailWAid",value:function(){return this.type!==S.MSG_TYPE.VCARD?null:ve.default.thumbnailWAid(this.getWAids())}},{key:"getLocObject",value:function(){var e=this.loc;if(e){var t=e.split("\n"),i=(0,l.default)(t,2),a=i[0],n=i[1];return{name:a,addr:void 0===n?null:n}}return null}},{key:"resumeRemoteUpload",value:function(){var e=this;return this.isUnsentPhoneMsg()&&!this.phoneUploading&&((0,ke.sendMsgRecord)(this).then(function(t){"success"!==t&&(e.phoneUploading=!1)}),this.phoneUploading=!0),this.downloadMedia(!0)}},{key:"forceDownloadMedia",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.downloadMedia(!0,e)}},{key:"forceRMR",value:function(){return f.default.reject(new Error("unimplemented forceRMR"))}},{key:"isForcingRMR",value:function(){return!1}},{key:"cancelDownload",value:function(){A.cancelDownloadMsg(this)}},{key:"resumeUpload",value:function(){J.default.assert(this.mediaData.mediaStage===Z.default.STAGE.NEED_UPLOAD,"resume-non-need-upload","resumeUpload called while state was "+this.mediaData.mediaStage)(),A.resumeUploadMsg(this)}},{key:"cancelUpload",value:function(){A.cancelUploadMsg(this)}},{key:"logInitialRender",value:function(){var e=this;if(this.isMMS&&this.mediaData&&!this.isStatusV3&&!this._renderEvent){var t=this._renderEvent=new ee.default.WebcMediaRender({messageMediaType:this.getWamMediaType(),webcChatType:this.chat.getWebcChatType(),webcChatPosition:this.chat.initialIndex,webcBrowserNetworkType:(0,Me.getEffectiveNetworkType)(),webcMessageT:this.t});this.msgChunk===this.chat.msgs&&(t.webcMessageIndex=this.msgChunk.length-this.msgChunk.indexOf(this)-1);var i=function i(){switch(e.mediaData.mediaStage){case Z.default.STAGE.INIT:case Z.default.STAGE.PREPARING:case Z.default.STAGE.FETCHING:case Z.default.STAGE.DECRYPTING:case Z.default.STAGE.REMOTE_UPLOADING:case Z.default.STAGE.REUPLOADING:case Z.default.STAGE.UPLOADING:case Z.default.STAGE.SENDING:return;case Z.default.STAGE.RESOLVED:t.webcMediaStage=ee.default.WEBC_MEDIA_STAGE_TYPE.RESOLVED;break;case Z.default.STAGE.NEED_POKE:t.webcMediaStage=ee.default.WEBC_MEDIA_STAGE_TYPE.NEEDS_RMR;break;default:t.webcMediaStage=ee.default.WEBC_MEDIA_STAGE_TYPE.OTHER}e._logStorageEstimate(t).finally(function(){t.commit(),e.stopListening(e.mediaData,"change:mediaStage",i)})};this.listenToAndRun(this.mediaData,"change:mediaStage",i)}}},{key:"downloadMedia",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isRevoked)return f.default.resolve();if(J.default.assert(this.isMMS,"media-fault","downloadMedia called on non-mms msg")(),this.isUnsentPhoneMsg()){var a=this.promises.waitForPhoneUpload;return a||(a=this.promises.waitForPhoneUpload=le.waitForBBEvent(this.mediaData,"change:mediaStage change:filehash",function(){return!!e.mediaData.filehash&&!e.isUnsentPhoneMsg()}).then(function(){e.promises.waitForPhoneUpload=null})),a.then(function(){return e.downloadMedia(t,i)})}var n=A.downloadMsg(this,t);if(i){var r=performance.now(),s=new ee.default.WebcMediaRmr({messageMediaType:this.getWamMediaType(),webcChatType:this.chat.getWebcChatType(),webcChatPosition:this.chat.initialIndex,webcBrowserNetworkType:(0,Me.getEffectiveNetworkType)(),webcMessageT:this.t,webcMediaSize:this.size});this.msgChunk===this.chat.msgs&&(s.webcMessageIndex=this.msgChunk.length-this.msgChunk.indexOf(this)-1),n.then(function(){return s.webcMediaRmrT=Math.ceil(performance.now()-r),e._logStorageEstimate(s)}).catch(function(){s.webcMediaRmrT=Math.ceil(performance.now()-r),s.webcMediaRmrError=!0}).finally(function(){return s.commit()})}return n}},{key:"applyUpdate",value:function(e){var t=this;if(e.type&&this.type!==e.type&&de.typeIsMMS(e.type))return this.type!==S.MSG_TYPE.CIPHERTEXT&&J.default.assert(!1,"invalid-type-update","updated "+this.id.toString()+" from "+this.type+" to "+e.type)(),this._createMediaDataChild(),A.registerMsgEarly(this,e),A.prepareMsg(this).then(function(){t.set(e)}).catch(function(e){J.default.assert(!1,"preregister-error","error = "+String(e))(e)});if(this.set(e),this.isLive&&ne.default.LiveLocation.processMsg(this,!0),this.paymentTransactionTimestamp){this.getCollection().updateLastTransactionTime(this.id.remote,this.paymentTransactionTimestamp)}return f.default.resolve()}},{key:"waitForPrep",value:function(){return de.typeIsMMS(this.type)?A.prepareMsg(this):f.default.resolve()}},{key:"delete",value:function(){(0,T.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"delete",this).call(this),ne.default.AllStarredMsgs.remove(this),this.isLive&&ne.default.LiveLocation.removeMsg(this),this.getCollection().remove(this.id),this.msgChunk&&this.msgChunk.remove(this.id),de.typeIsMMS(this.type)&&A.deregisterMsg(this);var e=ne.default.Chat.get(this.id.remote);if(e&&(e.unreadMsgAnchor===this&&(e.unreadMsgAnchor=void 0),e.lastReceivedKey===this.id)){e.lastReceivedKey=void 0;var i=e.getLastReceivedMsg();i&&(e.lastReceivedKey=i.id)}}},{key:"quotedMsgObj",value:function(){if(!this.quotedMsg)return null;if(this._quotedMsgObj){var e=this.getCollection();return de.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,e)}var t=!this.quotedParticipant||fe.default.equals(this.quotedParticipant,x.default.me),i=t?"out":"in",a=this.quotedRemoteJid?this.quotedRemoteJid:this.id.remote,n={id:this.quotedStanzaID,from:t?x.default.me:a,to:t?a:x.default.me,self:i,author:this.quotedParticipant,remote:a};if(!(fe.default.isGroup(n.from)||fe.default.isGroup(n.to))&&!fe.default.isStatusV3(a)||fe.default.equals(x.default.me,this.quotedParticipant)||(n.participant=this.quotedParticipant),j.default.assign(n,this.quotedMsg),!n)return n;this._quotedMsgObj=de.createQuotedMsg(n);var r=this.getCollection();return de.getOriginalQuotedMsgIfPossible(this._quotedMsgObj,r)}},{key:"getQuotedMsgAdminGroupJid",value:function(){return!this.quotedMsg&&this.quotedRemoteJid}},{key:"msgContextInfo",value:function(e){var t=j.default.omit(this.toJSON(),["id","t","notifyName","from","to","author","self","ack","invis","isNewMsg","star","recvFresh","recipients","broadcast","quotedMsg","quotedStanzaID","quotedRemoteJid","quotedParticipant","senderObj","multicast"]),i=void 0;return e&&!this.id.remote.equals(e)&&(i=this.id.remote),{quotedMsg:t,quotedParticipant:this.sender,quotedStanzaID:this.id.id,quotedRemoteJid:i}}},{key:"displayName",value:function(e,t){if(!this.sender)return"";if(this.sender.equals(x.default.me))return l10n.t("web_you");var i=this.senderObj,a=e?i.shortName:void 0;if(a)return a;if(i.name)return i.name;var n=t&&this.notifyName?" ~"+this.notifyName:"";return l10n.isRTL()?l10n.embedLTR((0,me.default)(this.sender))+n:(0,me.default)(this.sender)+n}},{key:"isQuoted",value:function(e){var t=this.quotedMsgObj();return!!t&&t.sender.equals(e)}},{key:"isMentioned",value:function(e){return j.default.findIndex(this.mentionedJidList,function(t){return t.equals(e)})>-1}},{key:"mentionMap",value:function(){if(!W.default.supportsFeature(W.default.F.MENTIONS_IN))return null;if(!j.default.size(this.mentionedJidList))return null;var e={};return j.default.forEach(this.mentionedJidList,function(t){e["@"+(fe.default.user(t)||"")]=ne.default.Contact.gadd(t)}),e}},{key:"updateAck",value:function(e){var t=this.ack;(0,Se.isNumber)(e)&&(void 0===t||e>t)?this.ack=e:-1===e&&0===this.ack&&(this.ack=-1,this.phoneUploading=!1)}},{key:"avParams",value:function(){return A.mediaMetadata(this)}},{key:"resend",value:function(){return this.isFailed?(this.ack=0,this.isMMS?this.resumeRemoteUpload():(0,ke.sendMsgRecord)(this)):f.default.resolve()}},{key:"onCiphertextDecrypted",value:function(){if(!this.isStatusV3){var e=this.chat,t=e.msgs.length,i=e.msgs.indexOf(this);-1!==i&&t-i<=10&&F.default.alertNewMsg(this)}}},{key:"onAckChange",value:function(){this.chat&&ie.default.webRestoreFromCache&&this.chat.trigger("change:msg:ack")}},{key:"eventTypeFromMsgType",value:function(){var e=this.type,t=this.subtype,i=void 0,a=void 0;return e===S.MSG_TYPE.GP2||e===S.MSG_TYPE.GROUP_NOTIFICATION?"subject"===t?i="n":"add"===t||"invite"===t?(a=j.default.head(this.recipients),i=fe.default.equals(a,x.default.me)?"s":"i"):"remove"===t?(a=j.default.head(this.recipients),i=fe.default.equals(a,x.default.me)?"n":"i"):i="create"===t?"n":"i":i=e===S.MSG_TYPE.BROADCAST_NOTIFICATION||e===S.MSG_TYPE.NOTIFICATION||e===S.MSG_TYPE.E2E_NOTIFICATION?"create"===t?"n":"i":e===S.MSG_TYPE.GROUPS_V4_INVITE&&this.from===x.default.me?"i":e===S.MSG_TYPE.CALL_LOG?"n":this.broadcast||e===S.MSG_TYPE.REVOKED?"i":this.isPSA?2===this.ack?"d":"a":e===S.MSG_TYPE.CIPHERTEXT||e===S.MSG_TYPE.OVERSIZED?"a":e===S.MSG_TYPE.NOTIFICATION_TEMPLATE?"i":"d",i}},{key:"canRevoke",value:function(){return W.default.supportsFeature(W.default.F.REVOKE)&&this.id.fromMe&&this.isUserCreatedType&&(!fe.default.isBroadcast(this.id.remote)||"iphone"===x.default.platform)&&!this.broadcast&&(0,d.default)(+new Date/1e3)-this.t<=N.default.REVOKE_WINDOW&&!this.isUnsentPhoneMsg()&&!this.isUnsentMedia}},{key:"revoke",value:function(e){de.typeIsMMS(this.type)&&A.deregisterMsg(this),this.chat&&this.chat.removeFromCollection(this);var t=this.getCollection(),i=this.id;if(this.msgChunk.replaceId(i,e),t.replaceId(i,e),this.set({id:e,type:S.MSG_TYPE.REVOKED,body:void 0,caption:void 0,clientUrl:void 0,loc:void 0,lat:void 0,lng:void 0,isLive:void 0,accuracy:void 0,speed:void 0,degrees:void 0,comment:void 0,sequence:void 0,shareDuration:void 0,finalLat:void 0,finalLng:void 0,finalAccuracy:void 0,finalThumbnail:void 0,finalSpeed:void 0,finalDegrees:void 0,finalTimeOffset:void 0,title:void 0,description:void 0,canonicalUrl:void 0,matchedText:void 0,thumbnail:void 0,richPreviewType:void 0,quotedMsg:void 0,quotedStanzaID:void 0,quotedRemoteJid:void 0,quotedParticipant:void 0,mediaData:void 0,mentionedJidList:void 0,vcardList:void 0,star:!1}),this.trigger("change:msgKey",{newKey:e,oldKey:i}),this.chat&&this.chat.updateMediasCountOnMsg(this,!0),this.chat&&i.equals(this.chat.lastReceivedKey)&&(this.chat.lastReceivedKey=e),this.isLive&&ne.default.LiveLocation.removeMsg(this),fe.default.isBroadcast(i.remote)){var a=de.getBroadcastFanoutKeys(i),n=de.getBroadcastFanoutKeys(e);if(!a||!n||a.length!==n.length)return void J.default.log("cannot fanout revoke: "+String(a)+" "+String(n))(a,n);j.default.zip(a,n).forEach(function(e){var i=t.get(e[0]);i&&i.revoke(e[1])})}}},{key:"getWamMessageType",value:function(){return this.isStatusV3?ee.default.MESSAGE_TYPE.STATUS:this.isGroupMsg?ee.default.MESSAGE_TYPE.GROUP:fe.default.isBroadcast(this.id.remote)?ee.default.MESSAGE_TYPE.BROADCAST:ee.default.MESSAGE_TYPE.INDIVIDUAL}},{key:"getWamMediaType",value:function(){switch(this.type){case S.MSG_TYPE.IMAGE:return ee.default.MEDIA_TYPE.PHOTO;case S.MSG_TYPE.VIDEO:return this.mediaData.isGif?ee.default.MEDIA_TYPE.GIF:ee.default.MEDIA_TYPE.VIDEO;case S.MSG_TYPE.AUDIO:return ee.default.MEDIA_TYPE.AUDIO;case S.MSG_TYPE.PTT:return ee.default.MEDIA_TYPE.PTT;case S.MSG_TYPE.DOCUMENT:return ee.default.MEDIA_TYPE.DOCUMENT;case S.MSG_TYPE.UNKNOWN:return ee.default.MEDIA_TYPE.FUTURE;case S.MSG_TYPE.LOCATION:return this.isLive?ee.default.MEDIA_TYPE.LIVE_LOCATION:ee.default.MEDIA_TYPE.LOCATION;case S.MSG_TYPE.VCARD:return ee.default.MEDIA_TYPE.CONTACT;case S.MSG_TYPE.MULTI_VCARD:return ee.default.MEDIA_TYPE.CONTACT_ARRAY;case S.MSG_TYPE.CHAT:return this.linkPreview?ee.default.MEDIA_TYPE.URL:ee.default.MEDIA_TYPE.NONE;case S.MSG_TYPE.STICKER:return ee.default.MEDIA_TYPE.STICKER;case S.MSG_TYPE.PRODUCT:return ee.default.MEDIA_TYPE.PRODUCT_IMAGE;default:return ee.default.MEDIA_TYPE.NONE}}},{key:"sendRevoke",value:function(e){var t=this;if(!W.default.supportsFeature(W.default.F.REVOKE))return f.default.reject("revoke feature unsupported");if(!this.id.fromMe)return f.default.reject("revoking received message");var i=new se.default({id:(0,pe.default)(),remote:this.id.remote,fromMe:!0}),a={id:i,to:this.id.remote,t:this.t,type:S.MSG_TYPE.PROTOCOL,subtype:"revoke",protocolMessageKey:this.id,clearMedia:!!e,local:!0};return(0,ke.sendMsgRecord)(r(a)).then(function(e){if("success"===e){var a=(0,d.default)(Date.now()/1e3-t.t);return new ee.default.SendRevokeMessage({messageType:t.getWamMessageType(),messageMediaType:t.getWamMediaType(),revokeSendDelay:a}).commit(),t.revoke(i),f.default.resolve("success")}return f.default.reject("dropped")})}},{key:"showForwarded",value:function(){var e=ie.default.fwdUiStartTs;return this.numTimesForwarded>0&&e>0&&e<this.t&&!this.isRevoked}},{key:"getForwardingScoreWhenForwarded",value:function(){if(!ie.default.frequentlyForwardedMessages)return this.numTimesForwarded;var e=this.numTimesForwarded+(this.id.fromMe?0:1);return e>=ie.default.frequentlyForwardedThreshold?N.default.FREQUENTLY_FORWARDED_SENTINEL:e}},{key:"getProductInfoText",value:function(){var e=this.title,t=this.description,i=this.currencyCode,a=this.priceAmount1000;e="*"+e+"*";var n=i&&a?B.default.format(i,a):null;return e=e.length>N.default.MAX_REPLY_PRODUCT_TITLE_LENGTH?(0,Ce.firstNCodepoints)(e,N.default.MAX_REPLY_PRODUCT_TITLE_LENGTH)+"...":e,t=t.length>N.default.MAX_REPLY_PRODUCT_DESC_LENGTH?(0,Ce.firstNCodepoints)(t,N.default.MAX_REPLY_PRODUCT_DESC_LENGTH)+"...":t,e+"\n"+(n||t)}},{key:"_logStorageEstimate",value:function(e){return(0,Te.default)().then(function(t){t&&(e.webcBrowserStorageQuotaBytes=t.quota,e.webcBrowserStorageQuotaUsedBytes=t.usage)})}}]),t}(O.default);je.Collection="Msg",je.Proxy="msg",je.idClass=se.default;var Pe=(0,I.defineModel)(je);t.default=Pe},ccbagdhfbb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return D[e]||!1}function r(e,t){switch(t){case"text":return e.type===y.default.MSG_TYPE.CHAT&&"url"!==e.subtype;case"image":return e.type===y.default.MSG_TYPE.IMAGE;case"video":return e.type===y.default.MSG_TYPE.VIDEO&&!e.isGif;case"gif":return e.type===y.default.MSG_TYPE.VIDEO&&e.isGif;case"audio":return e.type===y.default.MSG_TYPE.AUDIO;case"ptt":return e.type===y.default.MSG_TYPE.PTT;case"document":return e.type===y.default.MSG_TYPE.DOCUMENT;case"location":return e.type===y.default.MSG_TYPE.LOCATION;case"vcard":return e.type===y.default.MSG_TYPE.VCARD||e.type===y.default.MSG_TYPE.MULTI_VCARD;case"url":return e.type===y.default.MSG_TYPE.CHAT&&"url"===e.subtype;case"sticker":return e.type===y.default.MSG_TYPE.STICKER;case void 0:default:return!1}}function s(e){if(!e)return null;var t=new A.default({from:e.from,to:e.to,id:e.id,participant:e.participant,selfDir:e.self});return e.id=t,new O.default.Msg.constructor.model(e)}function o(e,t){if(!e)return e;var i=t.get(e.id);return i&&!i.isRevoked?i:e}function d(e){var t=void 0,i=void 0,a=void 0;if(e instanceof O.default.Msg.constructor.model)i=e,a=e.id;else{if(!(e instanceof A.default))return void j.default.error("model:msgs:broadcastFanout: unknown msgOrKey: "+String(e))(e);a=e}if(!R.default.isStatusV3(a.remote)){if(i&&i.recipients&&0!==i.recipients.length)t=i.recipients;else{var n=O.default.GroupMetadata.get(a.remote);n?t=_.default.map(f(n.participants),"id"):j.default.log("model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: "+a.remote.toString())()}return t?t.map(function(e){return new A.default({fromMe:a.fromMe,remote:e,id:a.id})}):void 0}}function u(e){var t=void 0;if(!e.invis){var i=d(e);i&&(t=i.map(function(e){return e.remote}),i.forEach(function(t){if(!O.default.Msg.some(_.default.matches({id:t}))){var i=f(e);i.to=t.remote,i.id=t,i.broadcast=!0;var a=O.default.Msg.add(i,{merge:!0});O.default.Chat.find(t.remote).then(function(e){l(a,e,!0)})}}))}return t}function l(e,t,a,n,r,s){var o=n||t.msgs;if(0!==e.length){var d=o===t.msgs;if(s)if(d){j.default.info("models:msg:store:resetMostRecentMsgs .msgs === cmc !")();var u=_.default.findLast(e,function(e){return!!e});u&&(t.lastReceivedKey=u.id,o.add(e))}else{d=!0;var l=_.default.findLast(e,function(e){return!!e});l&&(t.lastReceivedKey=l.id,o.add(e));var c=i("dbfjecijha").default,f=new c;f.replace(t.msgs),t.msgChunks.push(f),t.replaceMsgsCollection(o),t.msgs.trigger("change:last",t.msgs.last())}else if(a){if(d){var p=_.default.findLast(e,function(e){return!!e});p&&(t.lastReceivedKey=p.id)}o.add(e)}else o.add(e,{at:0,silent:_.default.every(e,h)});if(a&&d||!O.default.Msg.lastReceivedReceipt[t.id])for(var g=e.length,v=g-1;v>=0;v--){var m=e[v],y=m.id;if(y.fromMe&&!m.isNotification){O.default.Msg.updateLastReceipt(y.remote,m.t);break}}if(a&&d||!O.default.Msg.lastReceivedPaymentTransaction[t.id])for(var b=e.length,E=b-1;E>=0;E--){var T=e[E],C=T.id;T.paymentTransactionTimestamp&&O.default.Msg.updateLastTransactionTime(C.remote,T.paymentTransactionTimestamp)}var M=r;M&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=_.default.find(e,function(e){return e.id.toString()===M.toString()}))}}function c(e){var t=e.id,i=e.toJSON();delete i.status,delete i.mimetype,delete i.height,delete i.width,delete i.recipients,delete i.chat,delete i.broadcast,delete i.ack,delete i.invis,delete i.filehash,delete i.recvFresh,delete i.mediaData,w.default.isHttp(e.clientUrl)||delete i.clientUrl;for(var a in i)null==i[a]&&delete i[a];e.isMMS&&(i.avparams=e.isUnsentPhoneMsg()?{type:e.type}:e.avParams()),"chat"!==i.type||"url"!==i.subtype||C.default.supportsFeature(C.default.F.URL)||delete i.subtype,i.quotedMsg&&!C.default.supportsFeature(C.default.F.REPLIES_OUT)&&(delete i.quotedMsg,delete i.quotedStanzaID,delete i.quotedRemoteJid,delete i.quotedParticipant),i.mentionedJidList&&!C.default.supportsFeature(C.default.F.MENTIONS_OUT)&&delete i.mentionedJidList;var n=E.default.get(t.remote);return n&&(i.conversionTuple=n.toJSON()),i}function f(e){return null!=e&&"object"==typeof e?JSON.parse((0,g.default)(e),S.default):e}function h(e){return"i"===e.eventType}Object.defineProperty(t,"__esModule",{value:!0});var p=i("bgigfdhaij"),g=a(p);t.typeIsMMS=n,t.msgMatchesType=r,t.createQuotedMsg=s,t.getOriginalQuotedMsgIfPossible=o,t.getBroadcastFanoutKeys=d,t.broadcastFanout=u,t.addRecordsToChat=l,t.createMsgSendJson=c;var v=i("hbhijdici"),_=a(v),m=i("eadfaddcj"),y=a(m),b=i("ccbihadedf"),E=a(b),T=i("ccaaiecfib"),C=a(T),M=i("eecdaegci"),S=a(M),k=i("bdiiahhjbe"),j=a(k),P=i("ccgjijjbbj"),A=a(P),I=i("bhggeigghg"),O=a(I),L=i("edbaidcaf"),w=a(L),N=i("jccfhaecf"),R=a(N),D={image:!0,video:!0,audio:!0,ptt:!0,sticker:!0,document:!0,product:!0}},ccbihadedf:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("dbbaabdabi"),g=a(p),v=i("bjebjijbfc"),_=a(v),m=i("cgcgbfbffj"),y=a(m),b=i("cjbafegbjg"),E=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"initializeFromCache",value:function(e){if(e){var t=_.default.globalUnixTime()-p.ConversionTupleExpiry,i=e.filter(function(e){return e.timestamp-t>0}).map(function(e){var t=(0,b.parseConversionData)(e.conversionData);return t?e.conversionData=t:delete e.conversionData,e});this.add(i),this.saveToCache()}}}]),t}(y.default);E.model=g.default,E.cachePolicy={id:"conversion_tuple",policy:m.CACHE_POLICY.LOAD,delay:1e3},e.exports=new E},ccdbdjihjh:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=a(f),p=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,f.prop)(),a.callId=(0,f.prop)(),a.isIncoming=(0,f.prop)(!1),a.isRinging=(0,f.prop)(!1),a.isInterrupted=(0,f.prop)(!1),a.isMuted=(0,f.prop)(!1),a.isTrafficStopped=(0,f.prop)(!1),a.isInvitingToGroupCall=(0,f.prop)(!1),a.isVideoStopped=(0,f.prop)(!1),a.isVideoPaused=(0,f.prop)(!1),a.isVideoDecodePaused=(0,f.prop)(!1),a.isVideoDecodeStarted=(0,f.prop)(!1),a.isOfferingVideoUpgrade=(0,f.prop)(!1),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.default);p.Proxy="callParticipant",t.default=(0,f.defineModel)(p)},ccehadbeci:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("hbhijdici"),_=a(v),m=i("dcaifjegcg"),y=a(m),b=i("dbfjecijha"),E=a(b),T=i("bdiiahhjbe"),C=a(T),M=i("hciaejfjd"),S=a(M),k=i("bjigbaghc"),j=a(k),P=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,m.prop)(),a.pendingMsgs=(0,m.prop)(),a.labels=(0,m.prop)(),a.msgChunks=(0,m.session)(function(){return[]}),a.lastReceivedKey=(0,m.session)(),a.unreadMsgAnchor=(0,m.session)(),a.disableUnreadAnchor=(0,m.session)(),a.msgsLength=(0,m.session)(),a.msgsChanged=(0,m.session)(0),a.msgs=(0,m.collection)(E.default),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){var e=this;(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"initialize",this).call(this),this.listenTo(this.msgs,"change:last",function(){e.msgsChanged++}),this.listenTo(this.msgs,"add remove bulk_add",function(){e.msgsChanged++,e.msgsLength=e.msgs.length}),j.default.isSMB&&(this.addLabelsToCollection(),this.listenTo(this,"change:labels",this.addLabelsToCollection))}},{key:"addLabelsToCollection",value:function(){(0,S.default)(this.id.toString(),this.labels,"Chat")}},{key:"onEmptyMRM",value:function(){throw new Error("onEmptyMRM not implemented")}},{key:"delete",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"delete",this).call(this),this.getAllCMCs().forEach(function(e){e.forEach(function(e){e.delete()}),e.delete()})}},{key:"removeMsg",value:function(e){var t=e.msgChunk;if(t){t.indexOf(e)<0||(C.default.log("models:Chat:removeMsg "+e.get("id"))(),t.remove(e),0===t.length&&(t===this.msgs?this.onEmptyMRM():this.removeMsgsCollection(t)))}}},{key:"getAllCMCs",value:function(){return this.msgChunks.concat([this.msgs])}},{key:"getAllMsgs",value:function(){return _.default.flatten(this.getAllCMCs().map(function(e){return e.getModelsArray()}))}},{key:"replaceMsgsCollection",value:function(e){C.default.info("model:Chat:replaceMsgsCollection:"+this.id.toString())();var t={msg:e.last()};this.msgs.replace(e),this.notifyMsgCollectionMerge(e,this.msgs,this.msgs,t),this.msgChunks=_.default.without(this.msgChunks,e),e.delete()}},{key:"removeMsgsCollection",value:function(e){this.msgChunks=_.default.without(this.msgChunks,e),e.delete()}},{key:"notifyMsgCollectionMerge",value:function(e,t,i,a){this.trigger("change:cmc:merge",e,t,i,a)}}]),t}(y.default);t.default=P},ccijeahddj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(){(0,s.default)(d.default,l.default)}Object.defineProperty(t,"__esModule",{value:!0});var r=i("ddhdfjihbb"),s=a(r);t.loadCollections=n;var o=i("bhggeigghg"),d=a(o),u=i("cjedbbhjhh"),l=a(u)},cdaedfafjc:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.index,i=e.page;return new j({id:""+M+t,index:t,page:i})}Object.defineProperty(t,"__esModule",{value:!0}),t.StickerPack=void 0;var r=i("cjfdjhfbg"),s=a(r),o=i("dfedaiidge"),d=a(o),u=i("cdaghjbcia"),l=a(u),c=i("bcddciefhh"),f=a(c),h=i("ciaebjeace"),p=a(h),g=i("bghiedffgi"),v=a(g),_=i("dcaifjegcg"),m=a(_),y=i("cgejbjhjej"),b=a(y),E=i("daichdjff"),T=i("bffjfbgbg"),C=a(T),M="placeholder:",S="image/png",k=t.StickerPack=function(e){function t(){var e,i,a,n;(0,d.default)(this,t);for(var r=arguments.length,o=Array(r),u=0;u<r;u++)o[u]=arguments[u];return i=a=(0,f.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(o))),a.id=(0,_.prop)(),a.index=(0,_.prop)(),a.name=(0,_.prop)(),a.page=(0,_.prop)(),a.url=(0,_.prop)(),a.mimetype=(0,_.prop)(S),a.mediaData=(0,_.session)(),a._mediaObject=(0,_.prop)(),a.directPath=(0,_.prop)(),a.filehash=(0,_.prop)(),a.mediaKey=(0,_.prop)(),a.size=(0,_.prop)(),a.type=(0,_.prop)(E.OUTWARD_TYPES.STICKER_PACK),a.uploadhash=(0,_.prop)(),a.clientUrl=(0,_.derived)(a._clientUrl,["url","isFirstParty"]),a.stickers=(0,_.derived)(a._getStickersCollection,["id"]),a.isPlaceholder=(0,_.derived)(a._isPlaceholder,["id"]),a.isFirstParty=(0,_.derived)(a._isFirstParty,["url","mediaKey"]),n=i,(0,f.default)(a,n)}return(0,v.default)(t,e),(0,l.default)(t,[{key:"_clientUrl",value:function(){return this.isFirstParty?"":this.url}},{key:"_isPlaceholder",value:function(){return t.isPlaceholderId(this.id)}},{key:"_isFirstParty",value:function(){return Boolean(this.url)&&!this.mediaKey}},{key:"_getStickersCollection",value:function(){return this._stickers=this._stickers||new b.default(this.id.split("#")[0]),this._stickers}},{key:"initialize",value:function(){(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"initialize",this).call(this),this.isPlaceholder||this.isFirstParty||(this.addChild("mediaData",new C.default({renderableUrl:""})),i("ddgbhifaji").registerStickerPackIcon(this))}},{key:"downloadMedia",value:function(){this.isPlaceholder||this.isFirstParty||i("ddgbhifaji").downloadStickerOrStickerPackIcon(this)}}]),t}(m.default);k.Proxy="stickerPack",k.createPlaceholder=n,k.isPlaceholderId=function(e){return new RegExp("^"+M).test(e)};var j=(0,_.defineModel)(k);t.default=j,j.createPlaceholder=n,j.isPlaceholderId=k.isPlaceholderId},cdbfiiicdg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("bdfbccfifg"),h=a(f),p=function(e){function t(e,i){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,i.id))}return(0,c.default)(t,e),t}(h.default);p.policy=f.CACHE_POLICY_TYPE.NONE,t.default=p},cdcijfdgje:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("chcaiehhgc"),r=a(n),s=i("bachgbfdhf"),o=a(s),d=i("cjfdjhfbg"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("cdaghjbcia"),h=a(f),p=i("bcddciefhh"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("eadfaddcj"),y=a(m),b=i("bjebjijbfc"),E=a(b),T=i("cigehdgbah"),C=a(T),M=i("cajijabhgb"),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(M),k=i("bieicghjif"),j=a(k),P=i("bdiiahhjbe"),A=a(P),I=i("cgcgbfbffj"),O=a(I),L=i("jccfhaecf"),w=a(L),N=i("chajfbfiga"),R=a(N),D=i("hjbbdjjdf"),G=function(e){function t(){return(0,c.default)(this,t),(0,g.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,h.default)(t,[{key:"_find",value:function(e){var t=this;return w.default.isUser(e)||w.default.isGroup(e)?R.default.subscribeLiveLocation(e,!0).then(function(i){if(i.status&&i.status>=400)return 499===i.status?A.default.log("liveLocation:subscribe query not implemented on the phone")():A.default.error("model:LiveLocation:_find error "+i.status)(),o.default.reject(i.status);var a=(0,D.isNumber)(i.duration)?i.duration:void 0,n=i.participants?i.participants.map(function(e){return(0,r.default)({},t._extractLocationFields(e),{id:e.id,expiration:0===e.expiration?1/0:e.expiration})}):[];return{id:e,duration:a,participants:n}}):o.default.reject(new Error("invalid wid for live location: "+e))}},{key:"getActive",value:function(e){var t=this;return w.default.isUser(e)||w.default.isGroup(e)?R.default.queryActiveLiveLocation(e).then(function(i){if(i.status&&i.status>=400)return 499===i.status?A.default.log("liveLocation:participant query not implemented on the phone")():A.default.error("model:LiveLocation:getActive error "+i.status)(),o.default.reject(i.status);if(i.participants&&i.participants.length){var a=i.participants.map(function(e){return{id:e.id,expiration:0===e.expiration?1/0:e.expiration}});t.add({id:e,participants:a},{merge:!0})}}).catch(S.WapDrop,function(){}):o.default.reject(new Error("invalid wid for live location: "+e))}},{key:"onResume",value:function(){this.filter(function(e){return e.active&&e.hasParticipants()}).forEach(function(e){e.update()})}},{key:"handle",value:function(e){var t=this;Array.isArray(e)?e.forEach(function(e){switch(e.type){case"update":var i=t._extractLocationFields(e),a=C.default.get(e.jid);a&&a.liveLocations&&a.liveLocations.forEach(function(e){return e.set(i)});break;case"disable":var n=t.get(e.chat);if(n){var r=n.participants,s=r.get(e.jid);s&&(e.seq>s.sequence||-1===e.seq)&&s.disable()}break;default:A.default.error("models:liveLocation:handle unknown type: "+e.type)(e)}}):A.default.error("models:liveLocation:handle unrecognized payload")(e)}},{key:"processMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];A.default.assert(e.type===y.default.MSG_TYPE.LOCATION&&e.isLive,"collection:liveLocation trying to process non live-location msg")();var i=e.id.remote,a=e.lat,n=e.lng,r=e.accuracy,s=e.speed,o=e.degrees,d=e.sequence,u=e.comment,l=e.shareDuration,c=e.t;if(c&&l){var f=c+l;if(!(f<=E.default.globalUnixTime())){var h={id:e.sender,lat:a,lng:n,accuracy:r,speed:s,degrees:o,sequence:d,comment:u,expiration:f,lastUpdated:c,msg:e};-1===d&&delete h.sequence;var p=this.get(i);if(p){var g=p.participants.get(h.id);if(t)return void(g&&g.lastUpdated<=h.lastUpdated&&g.set(h));if(g&&p.participants.removeParticipant(g),p.hasParticipants())return void p.participants.add(h)}this.add({id:i,participants:[h]})}}}},{key:"removeMsg",value:function(e){A.default.assert(e.type===y.default.MSG_TYPE.LOCATION&&e.isLive,"collection:liveLocation trying to remove non live-location msg")();var t=e.id.remote,i=e.sender,a=this.get(t);a&&a.participants.remove(i)}},{key:"_extractLocationFields",value:function(e){return void 0===e.lat||void 0===e.lng?{}:{lastUpdated:E.default.globalUnixTime()-e.elapsed,lat:e.lat,lng:e.lng,accuracy:e.accuracy,speed:e.speed,degrees:e.degrees,comment:e.comment}}}]),t}(O.default);G.model=j.default,G.staleCollection=!0,G.resumeOnAvailable=!0,t.default=new G},ceidcegjgi:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyStates=void 0;var n=i("dbdijcacab"),r=a(n),s=i("diebfbcjgd"),o=a(s),d=i("bidijafjid"),u=a(d),l=i("babhdfhdah"),c=a(l),f=i("bdiiahhjbe"),h=a(f),p=t.ProxyStates={};t.default=function(e,t,i){function a(e){this._ProxyState$state=e}var n=t.props,s=t.session,d=t.collections,l=t.derived,f=(0,c.default)(t,["props","session","collections","derived"]),g={};[n,s,d,l].forEach(function(e){e&&(0,u.default)(e).forEach(function(e){g[e]={get:function(){return h.default.assert(!1,"Invalid ProxyState Access",'Cannot read proxy property "'+e+'" created in <'+this._ProxyState$ComponentName+"/>. Make sure it is whitelisted in your list of concerns.")(),this._ProxyState$state[e]},set:function(t){h.default.assert(!1,"Invalid ProxyState Write",'Cannot write proxy property "'+e+'" created in <'+this._ProxyState$ComponentName+"/>. Make sure it is whitelisted in your list of concerns.")(),this._ProxyState$state[e]=t}}})}),g.mirrorMask={value:i},g.isProxyOf={value:function(e){return this._ProxyState$state===e}},["set","get"].concat((0,o.default)((0,u.default)(f))).forEach(function(e){g[e]={value:function(){var t=this._ProxyState$state;return t[e].apply(t,arguments)}}}),a.prototype=(0,r.default)(null,g),a.prototype.constructor=a,p[e]=a}},cgcgbfbffj:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_POLICY=void 0;var r=i("chcaiehhgc"),s=n(r),o=i("bachgbfdhf"),d=n(o),u=i("cjfdjhfbg"),l=n(u),c=i("dfedaiidge"),f=n(c),h=i("cdaghjbcia"),p=n(h),g=i("bcddciefhh"),v=n(g),_=i("ciaebjeace"),m=n(_),y=i("bghiedffgi"),b=n(y),E=i("hbhijdici"),T=n(E),C=i("dfhjacfbjg"),M=a(C),S=i("bjigbaghc"),k=n(S),j=i("cajijabhgb"),P=a(j),A=i("bdiiahhjbe"),I=n(A),O=i("eaaehfdjdg"),L=n(O),w=i("dcdiaahjj"),N=n(w),R=i("fcedgihic"),D=n(R),G=i("bebehddcbc"),F=n(G),U=i("hjbbdjjdf"),x=i("bhggeigghg"),Y=n(x),B=i("dbjfahieed"),V={QUERY:"QUERY",FIND:"FIND",UPDATE:"UPDATE"};t.CACHE_POLICY=B.CACHE_POLICY_TYPE;var q=(new Object).toString(),H={id:"none",policy:B.CACHE_POLICY_TYPE.NONE},W=function(e){function t(){(0,f.default)(this,t);var e=(0,v.default)(this,(t.__proto__||(0,l.default)(t)).call(this));return e._inflight={},e._cachePolicy=(0,B.createCachePolicy)(e,e.constructor.cachePolicy||H),e._staleCollection=e.constructor.staleCollection||!1,e._resumeOnAvailable=e.constructor.resumeOnAvailable||!1,(!0===e._staleCollection||T.default.isFunction(e.onResume))&&(e.listenTo(L.default,"change:stream",e._handleStreamChange),e.listenTo(L.default,"didResume",e._onResume),e._resumeOnAvailable&&e.listenTo(N.default,"change:available",function(){N.default.available&&e._needsUpdate&&e._onResume()})),e._cachePolicy.enableCaching(),e._cachePolicy.constructor.policy===B.CACHE_POLICY_TYPE.LOAD&&e.listenTo(k.default,"change:me",e._updateFromCache),e}return(0,b.default)(t,e),(0,p.default)(t,[{key:"initializeFromCache",value:function(e){this.add(e)}},{key:"saveToCache",value:function(){if(k.default.me){var e=this._cachePolicy.id;I.default.log("baseCollection:saveToCache save: "+String(e))(),F.default.setCollection(e,this.toJSON(),this._cachePolicy.constructor.policy===B.CACHE_POLICY_TYPE.IMMEDIATE)}}},{key:"add",value:function(e,i){var a=this;if(e){if(k.default.blockStoreAdds)throw new P.LogoutDrop("adding to store when blocking store adds");var n=Array.isArray(e)?e:[e];if(T.default.every(n,function(e){return e&&e.isState})){var r=T.default.reject(n,function(e){return a.get(e.id)});return r.length&&(0,m.default)(t.prototype.__proto__||(0,l.default)(t.prototype),"add",this).call(this,r,i),n}}return(0,m.default)(t.prototype.__proto__||(0,l.default)(t.prototype),"add",this).call(this,e,i)}},{key:"findQuery",value:function(e,t){return this._query(V.QUERY,e,t)}},{key:"find",value:function(e,t){return e?this._query(V.FIND,e,t):(M.upload(I.default.trace("Called find without an id")),d.default.reject("called find without an id"))}},{key:"update",value:function(e,t){return e?this._query(V.UPDATE,e,t):(M.upload(I.default.trace("Called update without an id")),d.default.reject("called update without an id"))}},{key:"handle",value:function(e){var t=this._handle(e.shift());if(this._staleCollection){var i=Array.isArray(t)?t:[t];T.default.each(T.default.compact(i),function(e){e.stale=!1})}this.add(t,{merge:!0})}},{key:"gadd",value:function(e,t){if(this._model.prototype.isIdType(e)){var i=this.get(e);if(i)return i;var a={id:e};return this.add(a,t)[0]}if(e&&e.id){var n=t||{};return n.merge=!0,this.add(e,n)[0]}var r=T.default.findKey(Y.default,this)||"unknown";throw new Error(r+".gadd called without an id attr (id)")}},{key:"gaddUp",value:function(e){var t=void 0,i=this._staleCollection;if(this._model.prototype.isIdType(e)){var a={stale:i,id:e};t=this.get(e)||this.add(a,{merge:!0})[0]}else e&&e.id&&(this.get(e.id)&&(i=!1),e=(0,s.default)({stale:i},e),t=this.add(e,{merge:!0})[0]);if(t)return t.stale&&this.find(t.id).catch(P.WapDrop,function(){}),t;var n=T.default.findKey(Y.default,this)||"unknown";throw new Error(n+".gadd called without an id attr (id)")}},{key:"delete",value:function(){this._inflight={},this.reset()}},{key:"isStateStale",value:function(e){var t=this.get(e);return!!t&&t.stale}},{key:"_handleResume",value:function(){switch(L.default.stream){case O.STREAM.DISCONNECTED:if(!this._staleCollection)return;this.forEach(function(e){e&&(e.stale=!0)});break;case O.STREAM.RESUMING:case O.STREAM.SYNCING:case O.STREAM.CONNECTED:}}},{key:"_onResume",value:function(){T.default.isFunction(this.onResume)&&(this._resumeOnAvailable&&!N.default.available?this._needsUpdate=!0:(this.onResume(),this._needsUpdate=!1))}},{key:"_query",value:function(e,t,i){var a=this,n=(0,U.isString)(t)?t:t.toString();n===q&&(n=T.default.uniqueId("collection_query_"));var r=e===V.QUERY?void 0:this.get(t),s="force-"+n;if((this._inflight[s]&&e===V.FIND||e===V.UPDATE)&&(n=s),this._inflight[n])return e===V.FIND&&r&&!r.stale?d.default.resolve(r):this._inflight[n];if(!r||r&&r.stale||e===V.UPDATE){var o=this._inflight[n]=this._serverQuery(e,t,i).finally(function(){delete a._inflight[n]});return o.catch(P.WapDrop,function(e){I.default.warn(e.toString())()}).catch(function(){}),o.catch(U.isString,function(e){I.default.log("baseCollection:query query promise rejected: "+String(e))()})}return d.default.resolve(r)}},{key:"_serverQuery",value:function(e,t,i){var a=this,n=void 0;if(e===V.UPDATE)n=this._update(t);else if(e===V.FIND)n=this._find(t);else{var r=i&&i.logOnSend;n=this._findQuery(t,r)}return n.then(function(e){if(a._staleCollection){var t=Array.isArray(e)?e:[e];T.default.each(T.default.compact(t),function(e){void 0===e.stale&&(e.stale=!1)})}var n=void 0;if(n=i&&i.set?a.set(e):a.add(e,{merge:!0}),Array.isArray(e))return n;if(n[0])return n[0];throw new P.ModelCreateError(a._model.prototype.Collection,e)})}},{key:"_update",value:function(e){return this._find(e)}},{key:"_handleStreamChange",value:function(){this._handleResume(),this._cachePolicy.constructor.policy===B.CACHE_POLICY_TYPE.LOAD&&this._updateFromCache()}},{key:"_updateFromCache",value:function(){var e=this._cachePolicy.id;this._cachePolicy.disableCaching(),k.default.me&&(I.default.log("baseCollection:initFromCache load: "+String(e))(),this.initializeFromCache(F.default.getCollection(e)),this._cachePolicy.enableCaching())}}]),t}(D.default);t.default=W},cgejbjhjej:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.FETCH_STATE=void 0;var n=i("bachgbfdhf"),r=a(n),s=i("chcaiehhgc"),o=a(s),d=i("cjfdjhfbg"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("cdaghjbcia"),h=a(f),p=i("bcddciefhh"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("dhjffabgfb");Object.defineProperty(t,"FETCH_STATE",{enumerable:!0,get:function(){return m.FETCH_STATE}});var y=i("chajfbfiga"),b=a(y),E=i("hbhijdici"),T=function(e){function t(e){var i;(0,c.default)(this,t);var a=(0,g.default)(this,(t.__proto__||(0,u.default)(t)).call(this));a._parseStickersRes=function(e){if(200!==e.status||!e.data)throw new Error("sticker pack stickers query error");return e.data.map(function(e,t){return(0,o.default)({},(0,E.pick)(e,["directPath","mimetype","mediaKey","filehash","width","height"]),{index:t,id:e.filehash,clientUrl:e.url,uploadhash:e.encFilehash})})},a.stickerPackId=e;var n=t._cache[a.stickerPackId];if(n)return i=n,(0,g.default)(a,i);var r=void 0,s=a;return Object.defineProperty(a,"fetchState",{get:function(){return r},set:function(e){r!==e&&(r=e,s.trigger("change:fetchState",e))}}),a}return(0,_.default)(t,e),(0,h.default)(t,[{key:"fetch",value:function(e){var t=this;return e&&this.fetchState!==m.FETCH_STATE.PENDING&&delete this._fetchPromise,this._fetchPromise?this._fetchPromise:(this.fetchState=m.FETCH_STATE.PENDING,i("cdaedfafjc").default.isPlaceholderId(this.stickerPackId)?(this._fetchPromise=new r.default(function(){}),this._fetchPromise):(this._fetchPromise=b.default.queryStickersInStickerPack(this.stickerPackId).then(this._parseStickersRes).then(function(e){var i=Math.max(t.length||e.length);t._resetRange(0,i,e),t.fetchState=m.FETCH_STATE.SUCCESS}).catch(function(e){t.fetchState=m.FETCH_STATE.ERROR}),this._fetchPromise))}},{key:"_resetRange",value:function(e,t,i){var a=this;this._forEachInRange(e,t,function(t,n){var r=i[n-e];t?r?t.id===r.id?t.set(r):(a.remove(t),a.add(r)):a.remove(t):r&&a.add(r)})}},{key:"_forEachInRange",value:function(e,t,i){for(var a=e;a<t;a++){i(this.at(a),a)}}}]),t}(m.StickerCollection);T._cache={},T.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},t.default=T},cgfdiahhcd:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("bdfbccfifg"),g=a(p),v=i("hbhijdici"),_=function(e){function t(e,i){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,i.id));return a._trigger=i.trigger||"all",a._delay=i.delay,a._saveToCache=(0,v.debounce)(a.saveToCache,a._delay),a}return(0,h.default)(t,e),(0,u.default)(t,[{key:"saveToCache",value:function(){this.collection.saveToCache()}},{key:"enableCaching",value:function(){this.listenTo(this.collection,this._trigger,this._saveToCache)}},{key:"disableCaching",value:function(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}]),t}(g.default);_.policy=p.CACHE_POLICY_TYPE.LOAD,t.default=_},cgfidiajgj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){return new S({id:"placeholder-"+e,isPlaceholder:!0})}Object.defineProperty(t,"__esModule",{value:!0}),t.Sticker=void 0;var r=i("cjfdjhfbg"),s=a(r),o=i("dfedaiidge"),d=a(o),u=i("cdaghjbcia"),l=a(u),c=i("bcddciefhh"),f=a(c),h=i("ciaebjeace"),p=a(h),g=i("bghiedffgi"),v=a(g),_=i("dcaifjegcg"),m=a(_),y=i("ddgbhifaji"),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(y),E=i("bffjfbgbg"),T=a(E),C=i("daichdjff"),M=t.Sticker=function(e){function t(){var e,i,a,n;(0,d.default)(this,t);for(var r=arguments.length,o=Array(r),u=0;u<r;u++)o[u]=arguments[u];return i=a=(0,f.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(o))),a.id=(0,_.prop)(),a.mediaData=(0,_.session)(),a._mediaObject=(0,_.prop)(),a.clientUrl=(0,_.prop)(),a.directPath=(0,_.prop)(),a.filehash=(0,_.prop)(),a.height=(0,_.prop)(),a.index=(0,_.prop)(),a.mediaKey=(0,_.prop)(),a.mimetype=(0,_.prop)(),a.size=(0,_.prop)(),a.type=(0,_.prop)(C.OUTWARD_TYPES.STICKER),a.uploadhash=(0,_.prop)(),a.width=(0,_.prop)(),a.isPlaceholder=(0,_.prop)(),n=i,(0,f.default)(a,n)}return(0,v.default)(t,e),(0,l.default)(t,[{key:"initialize",value:function(){(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"initialize",this).call(this),this.addChild("mediaData",new T.default),this.isPlaceholder||b.registerSticker(this)}},{key:"downloadMedia",value:function(){return b.downloadStickerOrStickerPackIcon(this)}},{key:"sendToChat",value:function(e){i("jdigiabic").default.increment(this),this.mediaData.mediaBlob.retain();var t={quotedMsg:e.composeQuotedMsg};return e.composeQuotedMsg=null,(0,y.prepSticker)(this).sendToChat(e,t)}}]),t}(m.default);M.Proxy="sticker",M.createPlaceholder=n;var S=(0,_.defineModel)(M);t.default=S,S.createPlaceholder=n},chbjajaddg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("cgcgbfbffj"),_=a(v),m=i("cbcbdjdah"),y=a(m),b=i("ccaaiecfib"),E=a(b),T=i("cajijabhgb"),C=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(T),M=i("biecbbiiee"),S=a(M),k=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.syncPromise=null,a.isSynced=!1,n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),(0,c.default)(t,[{key:"onResume",value:function(){this.isSynced=!1,this.sync(this.parent)}},{key:"sync",value:function(e){var t=this;return E.default.supportsFeature(E.default.F.INDEX_RECEIVED_VCARD)?this.isSynced?r.default.resolve():this.syncPromise?this.syncPromise:(this.syncPromise=S.default.queryVCard(e.id).then(function(e){return t.add(e)}).catch(C.E499,function(){}).catch(function(){}).finally(function(){t.isSynced=!0,t.syncPromise=null}),this.syncPromise):(this.isSynced=!0,r.default.resolve())}}]),t}(_.default);k.model=y.default,k.resumeOnAvailable=!0,t.default=k},chghgadcbg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("dcaifjegcg"),g=a(p),v=i("bhggeigghg"),_=a(v),m=i("jccfhaecf"),y=a(m),b=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,p.prop)(),n=i,(0,c.default)(a,n)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"contact",value:function(){return _.default.Contact.gadd(this.id)}}]),t}(g.default);b.Collection="Blocklist",b.Proxy="blocklist",b.idClass=y.default,t.default=(0,p.defineModel)(b)},cigehdgbah:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i("bgigfdhaij"),s=n(r),o=i("bachgbfdhf"),d=n(o),u=i("cjfdjhfbg"),l=n(u),c=i("bcddciefhh"),f=n(c),h=i("bghiedffgi"),p=n(h),g=i("ciaebjeace"),v=n(g),_=i("dfedaiidge"),m=n(_),y=i("cdaghjbcia"),b=n(y),E=i("hbhijdici"),T=n(E),C=i("cajijabhgb"),M=a(C),S=i("gbfffciea"),k=n(S),j=i("bjigbaghc"),P=n(j),A=i("eadfaddcj"),I=n(A),O=i("hidifcjaf"),L=n(O),w=i("bdiiahhjbe"),N=n(w),R=i("cahfddcdga"),D=n(R),G=i("ebggjhghhi"),F=a(G),U=i("eaaehfdjdg"),x=n(U),Y=i("bhggeigghg"),B=n(Y),V=i("cgcgbfbffj"),q=n(V),H=i("chajfbfiga"),W=n(H),K=i("jccfhaecf"),z=n(K),Q=i("bebehddcbc"),J=n(Q),X=function(){function e(){(0,m.default)(this,e),this._map={},this.length=0}return(0,b.default)(e,[{key:"put",value:function(t){var i=e.getSidelistHash(t);if(i&&!this._map[i]){if(this._map[i]){var a=this._map[i];a instanceof z.default?this._map[i]=[a,t.id]:a instanceof Array&&a.push(t.id)}else this._map[i]=t.id;this.length++}}},{key:"remove",value:function(t){var i=e.getSidelistHash(t);if(i&&this._map[i]){var a=(0,D.default)(this._map[i]);a instanceof z.default?delete this._map[i]:a instanceof Array&&T.default.remove(a,function(e){return e.equals(t.id)}),this.length++}}},{key:"get",value:function(e){var t=this._map[e];return t instanceof z.default?[t]:t}},{key:"clear",value:function(){this._map={},this.length=0}}],[{key:"getSidelistHash",value:function(e){return e.isUser?"string"==typeof e.userhash&&e.userhash.slice?e.userhash.slice(0,4):(N.default.error("Store:Contact can't call slice on contact.userhash")(e.userhash),null):null}}]),e}(),Z=function(e){function t(){(0,m.default)(this,t);var e=(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this));return e._contactHashes=new X,e.checksum=void 0,e._frequentContacts={},e._sort=T.default.debounce(function(){return(0,v.default)(t.prototype.__proto__||(0,l.default)(t.prototype),"sort",e).call(e)},1e3),e._silentSort=T.default.debounce(function(){return(0,v.default)(t.prototype.__proto__||(0,l.default)(t.prototype),"sort",e).call(e,{silent:!0})},1e3),e.listenTo(k.default,"locale_change",e.sort),e.listenTo(e,"change:name",e.sort),e.listenTo(x.default,"change:stream",function(){x.default.stream===U.STREAM.RESUMING&&e.forEach(function(e){e.unset("verificationString"),e.unset("verificationBinary")})}),e.listenTo(e,"add",e.contactAdded),e.listenTo(e,"remove",e.contactRemoved),e}return(0,p.default)(t,e),(0,b.default)(t,[{key:"sort",value:function(e){return e&&e.silent?this._silentSort():this._sort()}},{key:"initializeFromCache",value:function(e){var t=this;e&&(e.forEach(function(e){var i=t.get(e.id);i&&e.isMe&&i.set("plaintextDisabled",!0)}),N.default.log("Store:Contact init from cache")(),this.add(e,{silent:!0,merge:!0}))}},{key:"contactAdded",value:function(e){this._contactHashes.put(e)}},{key:"contactRemoved",value:function(e){this._contactHashes.remove(e)}},{key:"delete",value:function(){(0,v.default)(t.prototype.__proto__||(0,l.default)(t.prototype),"delete",this).call(this),delete this.checksum,J.default.setContactChecksum(),this._frequentContacts={},this._contactHashes.clear()}},{key:"isFilteredContact",value:function(e){return!!e.name&&!e.isMe&&!e.isPSA&&e.isWAContact}},{key:"getFilteredContacts",value:function(){return this.filter(function(e){return e.name&&!e.isMe&&!e.isPSA&&e.isWAContact})}},{key:"mungePSAContact",value:function(e){if(Array.isArray(e)){var t=T.default.findIndex(e,function(e){return e&&z.default.isPSA(e.id)}),i=e[t];t>-1&&i&&(i.name=l10n.t("whatsapp_psa_contact_name"),i.shortName=l10n.t("whatsapp_psa_contact_name"))}}},{key:"_find",value:function(e){var t=this.get(e);return t?d.default.resolve(t):d.default.resolve({id:e})}},{key:"_findQuery",value:function(e){var t=this,i=performance.now(),a={},n=function(e){a.binarySize=e.binarySize};return W.default.contactFindQuery(e.retry,n).then(function(e){return"preempted"===e.data?d.default.reject("contacts preempted"):(a.count=e.data.length,a.timing=Math.ceil(performance.now()-i),t.trigger(I.default.COLLECTION_HAS_SYNCED,a),t.mungePSAContact(e.data),e.checksum&&(t.checksum=e.checksum,N.default.log("Store:Contact:query update checksum "+e.checksum)()),d.default.resolve(e.data))})}},{key:"handle",value:function(e){var t=this,i=function(e){t.add(e,{merge:!0});var i=t.get(e.id);i&&i.isMe&&i.set("plaintextDisabled",!0)},a=e.shift();if(Array.isArray(a)){var n=e.shift();if(n&&"remove"===n.missing){var r={};a.forEach(function(e){r[e.id]=!0}),this.forEach(function(e){var t=e.get("id");!z.default.isUser(t)||r[t]||e.isPSA||(e.unset("name"),e.unset("shortName"))})}n&&n.checksum&&(this.checksum=n.checksum,N.default.log("Store:Contact:handle update checksum "+n.checksum)()),this.mungePSAContact(a),a.forEach(i),N.default.log("Store:Contact:handle updated "+a.map(function(e){return e.id}).join())()}else if("preempt"===a.cmd){if(this.mungePSAContact(a.response),this.add(a.response,{merge:!0}),a.checksum&&(this.checksum=a.checksum,N.default.log("Store:Contact:handle update checksum "+a.checksum)()),P.default.me){var o=this.get(P.default.me);o&&o.set("plaintextDisabled",!0)}this.trigger(I.default.COLLECTION_HAS_SYNCED,{count:a.response.length,binarySize:a.binarySize})}else if("frequent"===a.type)delete a.type,this._frequentContacts=a;else if("sidelist"===a.type){var d=a.notification,u=a.action,l=a.hash,c=this._contactHashes.get(l);if(!c)return;"business"===d&&"profile"===u&&c.forEach(function(e){var i=t.get(e);i?i.businessProfile&&i.businessProfile.markStale():N.default.assert(!1,l,"Stale wid in contact hash index. Users: "+t._getUserCount()+", Hashes: "+t._contactHashes.length)()})}else N.default.error("Store:Contact:handle unknown: "+(0,s.default)(a))()}},{key:"sync",value:function(){return this.findQuery({}).catch(M.WapDrop,function(){}),F.waitForBBEvent(this,I.default.COLLECTION_HAS_SYNCED)}},{key:"resyncContacts",value:function(e){var t=this;void 0!==this.checksum&&void 0!==e&&(this.checksum!==e?this.findQuery({retry:!0}).then(function(e){if(Array.isArray(e)){t.mungePSAContact(e),N.default.log("Store:Contact:resync success")();var i=void 0,a=void 0,n={};for(a=0;a<e.length;a++)(i=e[a])&&(n[i.id]=i);for(a=0;a<t.length;a++)!(i=t.at(a))||n[i.id]||i.isPSA||(i.isGroup?B.default.Chat.get(i.id)||(i.unset("name"),i.unset("shortName")):(i.unset("name"),i.unset("shortName")))}else N.default.error("Store:Contact.resync error "+(0,s.default)(e),e)()}).catch(M.WapDrop,function(){}):N.default.log("Store:Contact:resync checksum match")())}},{key:"frequentContacts",value:function(e,t){var i=this,a=e&&this._frequentContacts[e];if(a||(a=this._frequentContacts.message),!a)return[];var n=t&&t.id;return a.map(function(e){return i.get(e)}).filter(function(e){return!!e&&!e.id.equals(n)})}},{key:"_getUserCount",value:function(){return this.map(function(e){return e.isUser?1:0}).reduce(function(e,t){return e+t},0)}},{key:"saveToCache",value:function(){(0,v.default)(t.prototype.__proto__||(0,l.default)(t.prototype),"saveToCache",this).call(this),J.default.setContactChecksum(this.checksum)}}]),t}(q.default);Z.model=L.default,Z.comparator=O.ContactComparator,Z.cachePolicy={id:"contact",policy:V.CACHE_POLICY.IMMEDIATE,trigger:"add\n        sort\n        remove\n        reset\n        change:id\n        change:name\n        change:shortName\n        change:pushname\n        change:type\n        change:plaintextDisabled\n        change:verifiedName\n        change:isBusiness\n        change:isEnterprise\n        change:verifiedLevel\n        change:statusMute\n        change:sectionHeader\n        change:isContactBlocked\n        change:labels"},t.default=new Z},cjabddhidj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("ebjaejiaba"),g=a(p),v=i("dfjfgdhbjj"),_=a(v),m=i("dbdfbgehgj"),y=a(m),b=i("bjigbaghc"),E=a(b),T=i("eaaehfdjdg"),C=a(T),M=i("bhggeigghg"),S=a(M),k=i("cgcgbfbffj"),j=a(k),P=function(e){function t(e,i){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return a.stale=!1,a.add(e,{silent:!0}),a.contact=i,a.listenTo(S.default.GroupMetadata,"group_participant_change_"+E.default.me.toString(),a.updateCommonGroups),a.listenTo(S.default.GroupMetadata,"group_participant_change_"+a.contact.toString(),a.updateCommonGroups),a.listenTo(C.default,"change:stream",function(){C.default.stream===T.STREAM.DISCONNECTED&&(a.stale=!0)}),a}return(0,h.default)(t,e),(0,u.default)(t,[{key:"updateCommonGroups",value:function(e){var t=S.default.GroupMetadata.assertGet(e),i=t.participants,a=E.default.me;this.get(e)?i.get(this.contact)&&i.get(a)||this.remove(e):i.get(this.contact)&&i.get(a)&&this.add(y.default.assertGet(e))}}]),t}(j.default);P.model=g.default,P.comparator=_.default,t.default=P},cjcghajbag:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){return e.index-t.index}Object.defineProperty(t,"__esModule",{value:!0}),t.PRODUCT_REVIEW_STATUS=void 0;var r=i("cjfdjhfbg"),s=a(r),o=i("dfedaiidge"),d=a(o),u=i("cdaghjbcia"),l=a(u),c=i("bcddciefhh"),f=a(c),h=i("ciaebjeace"),p=a(h),g=i("bghiedffgi"),v=a(g),_=i("idbcfjbae"),m=a(_),y=i("cgcgbfbffj"),b=a(y),E=t.PRODUCT_REVIEW_STATUS={NO_REVIEW:"",PENDING:"PENDING",REJECTED:"REJECTED",APPROVED:"APPROVED",OUTDATED:"OUTDATED"},T=function(e){function t(){return(0,d.default)(this,t),(0,f.default)(this,(t.__proto__||(0,s.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,l.default)(t,[{key:"getProductModels",value:function(){var e=(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"toArray",this).call(this);if((0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"length",this)<1)return e;var i=(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"head",this).call(this);return i&&i.catalogWid?(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"filter",this).call(this,function(e){return e.reviewStatus===E.APPROVED&&!e.old}):e}},{key:"add",value:function(e,i){var a=i?(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"add",this).call(this,e,i):(0,p.default)(t.prototype.__proto__||(0,s.default)(t.prototype),"add",this).call(this,e);return this.sort(),a}}]),t}(b.default);T.model=m.default,T.comparator=n,t.default=T},cjedbbhjhh:function(e,t,i){"use strict";e.exports={AllStarredMsgs:i("djfhiceeje").default,Blocklist:i("bgfcjjddjf").default,BusinessProfile:i("ejiicdbii").default,Call:i("biaifggagf").default,Chat:i("dbdfbgehgj").default,ChatPreference:i("ebcagbhefg"),Cmd:i("dhggbbghfb"),Conn:i("bjigbaghc").default,Contact:i("cigehdgbah").default,ConversionTuple:i("ccbihadedf"),EmojiVariant:i("dfbhcehadj").default,GroupMetadata:i("djaadchjch"),Label:i("bijffg").default,LiveLocation:i("cdcijfdgje").default,Msg:i("biecbbiiee").default,MsgInfo:i("eigdejjai").default,Mute:i("dagdiahdfi").default,Presence:i("ebbjbbjjg").default,ProfilePicThumb:i("dhefcajhhb").default,QuickReply:i("bechejbabh").default,RecentEmoji:i("bjfecgfdgj").default,RecentSticker:i("jdigiabic").default,ServerProps:i("bfgbdiffgd").default,StarredGifMsgs:i("dfgeejdaib"),Status:i("gbbacfeci").default,StatusV3:i("bgcdajbhif").default,Sticker:i("dhjffabgfb").default,StickerPack:i("fagbfehid").default,Stream:i("dcdiaahjj").default,Wap:i("chajfbfiga").default,Wid:i("ecadbdfdef")}},dacfecidja:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("cgcgbfbffj"),y=a(m),b=i("dbdfbgehgj"),E=a(b),T=i("cbcbdjdah"),C=a(T),M=i("cajijabhgb"),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(M),k=i("bfbggcdbfb"),j=a(k),P=i("biecbbiiee"),A=a(P),I=function(e){function t(){(0,u.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return e.hasMoreMsgs=!0,e.resultPage=0,e.searchPromise=null,e.searchTerm=null,e.searchLabel=null,e.updateFtsAfterMsgLabelUpdate=function(){if(e.currentLabelSearch){var t=e.filter(function(t){return!t.labels||!t.labels.includes(e.currentLabelSearch)});e.remove(t,{silent:!0})}},e.listenTo(A.default,"remove_msgs",function(t){e.remove(t,{silent:!0}).filter(function(e){return!!e}).length&&e.trigger("bulk_remove")}),e.listenTo(E.default,"remove",function(t){var i=[];e.forEach(function(e){e.chat===t&&i.push(e)}),e.remove(i,{silent:!0}).filter(function(e){return!!e}).length&&e.trigger("bulk_remove")}),e}return(0,_.default)(t,e),(0,c.default)(t,[{key:"delete",value:function(e){e&&this.stopListening(),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this)}},{key:"resetSearch",value:function(){this.hasMoreMsgs=!0,this.resultPage=0,this.searchTerm=null,this.searchPromise&&this.searchPromise.cancel()}},{key:"search",value:function(e,t){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e+"__"+(a.label||a.kind||"");this.currentLabelSearch=a.label;var s=!1;this.searchTerm!==n?(this.searchTerm&&0===e.indexOf(this.searchTerm)?s=!0:(this.searchTerm=n,this.delete()),this.resultPage=0,this.hasMoreMsgs=!0):s=!0;var o=new j.default.UiAction({uiActionType:j.default.UI_ACTION_TYPE.IMAGE_OPEN,uiActionPreloaded:s});if(this.searchPromise){if(this.searchTerm===n)return this.searchPromise;this.searchPromise.cancel()}var d=void 0;return d=t?t.fts(e,++this.resultPage,100):A.default.search(e,++this.resultPage,100,void 0,a),this.searchPromise=d.cancellable().then(function(e){e.eof&&(i.hasMoreMsgs=!1),i.searchTerm!==n&&i.delete(),i.searchTerm=n,e.messages&&i.add(e.messages.filter(function(e){return!e.isRevoked})),o.markUiActionT(),o.commit()}).catch(S.WapDrop,r.default.CancellationError,function(){}).finally(function(){i.searchPromise=null,i.trigger("searchPromise_update")}),this.trigger("searchPromise_update"),this.searchPromise}}]),t}(y.default);I.model=C.default,t.default=I},daejhdfjb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){return t in x[e||"EMPTY"]}Object.defineProperty(t,"__esModule",{value:!0});var r,s,o,d,u,l,c,f=i("cdhiacfjbg"),h=a(f),p=i("cjfdjhfbg"),g=a(p),v=i("dfedaiidge"),_=a(v),m=i("cdaghjbcia"),y=a(m),b=i("bcddciefhh"),E=a(b),T=i("bghiedffgi"),C=a(T),M=i("dcaifjegcg"),S=a(M),k=i("dghjhchjic"),j=a(k),P=i("gbfffciea"),A=a(P),I=i("bjigbaghc"),O=a(I),L=i("cgejjichfa"),w=i("hgeacfdgi"),N=a(w),R=i("ccaaiecfib"),D=a(R),G=i("bhgjacgcdd"),F=a(G),U=function(e){function t(){var e,i,a,n;(0,_.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,E.default)(this,(e=t.__proto__||(0,g.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,M.prop)(),a.peerJid=(0,M.prop)(),a.offerTime=(0,M.prop)(),a.startTime=(0,M.prop)(),a.isVideo=(0,M.prop)(!1),a.isGroupCall=(0,M.prop)(!1),a.canHandleLocally=(0,M.prop)(!1),a.outgoing=(0,M.prop)(!1),a.webClientShouldHandle=(0,M.prop)(!1),a.participants=(0,M.collection)(j.default),a._state=(0,M.prop)(),n=i,(0,E.default)(a,n)}return(0,C.default)(t,e),(0,y.default)(t,[{key:"getState",value:function(){return this._state}},{key:"setState",value:function(e){n(this._state,e)&&(this.webClientShouldHandle||e===L.CALL_STATES.INCOMING_RING||(e=L.CALL_STATES.HANDLED_REMOTELY,N.default.callId===this.id&&F.default.callEndByHandledRemotely()),this._state!==L.CALL_STATES.CONNECTION_LOST&&e===L.CALL_STATES.ACTIVE&&(this.startTime=Date.now()),this._state=e,this.handleNotification(),this.potentiallyUpdateCallUi())}},{key:"handleNotification",value:function(){var e=this.getState();O.default.tosShowCallNotification&&this.peerJid&&(e===L.CALL_STATES.INCOMING_RING?A.default.alertCall(this.peerJid,this.id,this.isVideo,this.canHandleLocally):A.default.cancelCall(this.peerJid))}},{key:"potentiallyUpdateCallUi",value:function(){N.default.callId===this.id?this.setCallUiProps():!N.default.callId&&this.getState()===L.CALL_STATES.INCOMING_RING&&D.default.supportsFeature(D.default.F.VOIP_INDIVIDUAL_INCOMING)&&this.canHandleLocally&&(N.default.callId=this.id,this.setCallUiProps())}},{key:"setCallUiProps",value:function(){N.default.type=this.isVideo?w.CALL_TYPES.VIDEO:w.CALL_TYPES.VOICE,N.default.state=this.getUiState(),N.default.to=this.outgoing?this.peerJid:O.default.me,N.default.from=this.outgoing?O.default.me:this.peerJid,N.default.startTime=this.startTime,N.default.outgoing=this.outgoing,N.default.state===w.CALL_UI_STATES.ENDED&&(N.default.peerBusy=!1)}},{key:"getUiState",value:function(){switch(this.getState()){case L.CALL_STATES.INCOMING_RING:return w.CALL_UI_STATES.INCOMING_RING;case L.CALL_STATES.OUTGOING_RING:return w.CALL_UI_STATES.OUTGOING_RING;case L.CALL_STATES.OUTGOING_CALLING:return w.CALL_UI_STATES.OUTGOING_CALLING;case L.CALL_STATES.CONNECTING:return w.CALL_UI_STATES.CONNECTING;case L.CALL_STATES.CONNECTION_LOST:return w.CALL_UI_STATES.RECONNECTING;case L.CALL_STATES.ACTIVE:return w.CALL_UI_STATES.ACTIVE;case L.CALL_STATES.HANDLED_REMOTELY:return w.CALL_UI_STATES.NONE;case L.CALL_STATES.ENDED:return w.CALL_UI_STATES.ENDED;case L.CALL_STATES.REJECTED:return w.CALL_UI_STATES.REJECTED;case L.CALL_STATES.REMOTE_CALL_IN_PROGRESS:return w.CALL_UI_STATES.REMOTE_CALL_IN_PROGRESS;case L.CALL_STATES.FAILED:return w.CALL_UI_STATES.FAILED;default:return w.CALL_UI_STATES.NONE}}}]),t}(S.default);U.Collection="Call",U.Proxy="call",t.default=(0,M.defineModel)(U);var x={EMPTY:(r={},(0,h.default)(r,L.CALL_STATES.INCOMING_RING,!0),(0,h.default)(r,L.CALL_STATES.OUTGOING_CALLING,!0),(0,h.default)(r,L.CALL_STATES.CONNECTING,!0),(0,h.default)(r,L.CALL_STATES.REJECTED,!0),(0,h.default)(r,L.CALL_STATES.HANDLED_REMOTELY,!0),(0,h.default)(r,L.CALL_STATES.ENDED,!0),(0,h.default)(r,L.CALL_STATES.FAILED,!0),r),INCOMING_RING:(s={},(0,h.default)(s,L.CALL_STATES.HANDLED_REMOTELY,!0),(0,h.default)(s,L.CALL_STATES.CONNECTING,!0),(0,h.default)(s,L.CALL_STATES.ACTIVE,!0),(0,h.default)(s,L.CALL_STATES.REJECTED,!0),(0,h.default)(s,L.CALL_STATES.ENDED,!0),(0,h.default)(s,L.CALL_STATES.REMOTE_CALL_IN_PROGRESS,!0),(0,h.default)(s,L.CALL_STATES.FAILED,!0),s),OUTGOING_CALLING:(o={},(0,h.default)(o,L.CALL_STATES.OUTGOING_RING,!0),(0,h.default)(o,L.CALL_STATES.CONNECTING,!0),(0,h.default)(o,L.CALL_STATES.ENDED,!0),(0,h.default)(o,L.CALL_STATES.FAILED,!0),o),OUTGOING_RING:(d={},(0,h.default)(d,L.CALL_STATES.ACTIVE,!0),(0,h.default)(d,L.CALL_STATES.REJECTED,!0),(0,h.default)(d,L.CALL_STATES.ENDED,!0),(0,h.default)(d,L.CALL_STATES.FAILED,!0),d),CONNECTING:(u={},(0,h.default)(u,L.CALL_STATES.OUTGOING_RING,!0),(0,h.default)(u,L.CALL_STATES.ACTIVE,!0),(0,h.default)(u,L.CALL_STATES.ENDED,!0),(0,h.default)(u,L.CALL_STATES.REMOTE_CALL_IN_PROGRESS,!0),(0,h.default)(u,L.CALL_STATES.FAILED,!0),u),CONNECTION_LOST:(l={},(0,h.default)(l,L.CALL_STATES.ACTIVE,!0),(0,h.default)(l,L.CALL_STATES.ENDED,!0),(0,h.default)(l,L.CALL_STATES.FAILED,!0),l),ACTIVE:(c={},(0,h.default)(c,L.CALL_STATES.ENDED,!0),(0,h.default)(c,L.CALL_STATES.FAILED,!0),(0,h.default)(c,L.CALL_STATES.CONNECTION_LOST,!0),c),HANDLED_REMOTELY:{},ENDED:{},REJECTED:{},REMOTE_CALL_IN_PROGRESS:{},FAILED:{}}},dagdiahdfi:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("cgcgbfbffj"),g=a(p),v=i("bjigbaghc"),_=a(v),m=i("bdiiahhjbe"),y=a(m),b=i("bhggeigghg"),E=a(b),T=i("dhadcigcaf"),C=a(T),M=i("bebehddcbc"),S=a(M),k=!0,j=!0,P=!0,A=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"initializeFromCache",value:function(e){this.add(e),this.setGlobalNotifications(S.default.getGlobalNotifications()),this.setGlobalSounds(S.default.getGlobalSounds()),this.setGlobalPreviews(S.default.getGlobalPreviews())}},{key:"saveToCache",value:function(){if(_.default.me){var e=this.constructor.cachePolicy.id;y.default.log("models:mute:cache-save: "+String(e))(),S.default.setCollection(e,[this.globalMute().toJSON()])}}},{key:"globalMute",value:function(){var e=this.get(T.GLOBAL_MUTE);return e||this.add({id:T.GLOBAL_MUTE})[0]}},{key:"getGlobalSounds",value:function(){return k}},{key:"setGlobalSounds",value:function(e){k=e,S.default.setGlobalSounds(e)}},{key:"getGlobalNotifications",value:function(){return j}},{key:"setGlobalNotifications",value:function(e){j=e,S.default.setGlobalNotifications(e)}},{key:"getGlobalPreviews",value:function(){return P}},{key:"setGlobalPreviews",value:function(e){P=e,S.default.setGlobalPreviews(e)}},{key:"handle",value:function(e){e.forEach(function(e){var t=E.default.Chat.get(e.id);t&&"mute"===e.type&&t.mute.setMute(e.muteExpiration)})}}]),t}(g.default);A.model=C.default,A.cachePolicy={id:"mute",policy:p.CACHE_POLICY.LOAD,delay:1e3},t.default=new A},dbbaabdabi:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ConversionTupleExpiry=void 0;var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("bjebjijbfc"),y=a(m),b=i("djheacfeif"),E=a(b),T=i("bdiiahhjbe"),C=a(T),M=i("dbajccegac"),S=a(M),k=i("jccfhaecf"),j=a(k),P=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,v.prop)(),a.conversionData=(0,v.prop)(),a.conversionSource=(0,v.prop)(),a.timestamp=(0,v.prop)(function(){return y.default.globalUnixTime()}),a.alarmId=(0,v.session)(),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"initialize",this).call(this),this.listenTo(this,"change:timestamp",this._setExpiryTimer),this._setExpiryTimer()}},{key:"_setExpiryTimer",value:function(){var e=this,t=this.timestamp+604800;if(t<0)return C.default.error("Invalid conversionTuple timer")(),void this.delete();this.alarmId=E.default.setLocalTimeout(function(){e.delete()},1e3*t,this.alarmId)}},{key:"_clearAlarm",value:function(){this.alarmId&&(E.default.clearTimeout(this.alarmId),this.alarmId=void 0)}},{key:"elapsedSeconds",value:function(){return y.default.globalUnixTime()-this.timestamp}},{key:"formatTuple",value:function(){var e={conversionDelaySeconds:this.elapsedSeconds()};return this.conversionData&&(e.conversionData=this.conversionData),this.conversionSource&&(e.conversionSource=this.conversionSource),e}},{key:"toJSON",value:function(){var e=this.serialize(),t=e.conversionData;if(t instanceof ArrayBuffer){var i=new S.default(t);e.conversionData=i.readString(t.byteLength)}return e}},{key:"delete",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this._clearAlarm()}}]),t}(_.default);P.Collection="ConversionTuple",P.Proxy="conversionTuple",P.idClass=j.default,t.default=(0,v.defineModel)(P),t.ConversionTupleExpiry=604800},dbdfbgehgj:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i("diebfbcjgd"),s=n(r),o=i("djchjahdbh"),d=n(o),u=i("bgigfdhaij"),l=n(u),c=i("bachgbfdhf"),f=n(c),h=i("cjfdjhfbg"),p=n(h),g=i("dfedaiidge"),v=n(g),_=i("cdaghjbcia"),m=n(_),y=i("bcddciefhh"),b=n(y),E=i("ciaebjeace"),T=n(E),C=i("bghiedffgi"),M=n(C),S=i("hbhijdici"),k=n(S),j=i("cajijabhgb"),P=a(j),A=i("ebggjhghhi"),I=a(A),O=i("djfhiceeje"),L=n(O),w=i("ccihhdchab"),N=i("cgcgbfbffj"),R=n(N),D=i("ebjaejiaba"),G=n(D),F=i("dfjfgdhbjj"),U=n(F),x=i("gbfffciea"),Y=n(x),B=i("bjigbaghc"),V=n(B),q=i("eadfaddcj"),H=n(q),W=i("bihjahgcja"),K=n(W),z=i("bijffg"),Q=n(z),J=i("bdiiahhjbe"),X=n(J),Z=i("ccgjijjbbj"),$=n(Z),ee=i("bechejbabh"),te=n(ee),ie=i("ddhijeejag"),ae=n(ie),ne=i("eaaehfdjdg"),re=n(ne),se=i("dfgeejdaib"),oe=n(se),de=i("fagbfehid"),ue=n(de),le=i("bhggeigghg"),ce=n(le),fe=i("bebehddcbc"),he=n(fe),pe=i("dfdebdgdei"),ge=i("bafdehfigc"),ve=i("chajfbfiga"),_e=n(ve),me=i("jccfhaecf"),ye=n(me),be=function(e){function t(){(0,v.default)(this,t);var e=(0,b.default)(this,(t.__proto__||(0,p.default)(t)).call(this));return e.notSpam={},e.promises={sendUnstarAll:null,initializeRestFromTabletCache:null},e.keysForResyncMsgs=void 0,e._sortEnabled=!1,e.enableSortListener(),e.listenTo(re.default,"change:stream",function(){re.default.stream===ne.STREAM.RESUMING&&e.forEach(function(e){e.pendingMsgs=!1})}),e.listenToOnce(e,"sort",k.default.debounce(e.setIndexes,100)),e}return(0,M.default)(t,e),(0,m.default)(t,[{key:"enableSortListener",value:function(e){this._sortEnabled||(this.listenTo(this,"change:t change:pin change:isVisible",this.sort),e&&this.sort(),this._sortEnabled=!0)}},{key:"disableSortListener",value:function(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)}},{key:"setIndexes",value:function(){this.forEach(function(e,t){e.initialIndex=t})}},{key:"active",value:function(){var e=k.default.head(this.filter(function(e){return e.active}));return e||void 0}},{key:"_find",value:function(e){return f.default.resolve({id:e,createdLocally:!0})}},{key:"_findQuery",value:function(e){var t=this,i={},a=performance.now(),n=function(e){i.binarySize=e.binarySize};return _e.default.chatFindQuery(!!e.retry,n).then(function(e){return"preempted"===e?f.default.reject("chats preempted"):(i.timing=Math.ceil(performance.now()-a),i.size=e.length,V.default.platform===B.PLATFORMS.IPHONE&&(k.default.isEmpty(e)?ce.default.Msg.trigger(H.default.COLLECTION_HAS_SYNCED):setTimeout(function(){ce.default.Msg.trigger(H.default.COLLECTION_HAS_SYNCED)},2500)),t.trigger(H.default.COLLECTION_HAS_SYNCED,i),f.default.resolve(e))})}},{key:"handle",value:function(e){var t=e.shift(),i=this;if(Array.isArray(t)){var a=[],n=[];t.forEach(function(e){if("c.us"===e.id)n.push(e);else{var t=!!i.get(e.id),r=["delete","clear","archive","unarchive","star","unstar","spam","modify_tag","pin","modify"].indexOf(e.type)>-1;r?t&&r?n.push(e):X.default.log("Model:chat:handle received junk chat record: "+(0,l.default)(e))():a.push(e)}});var r=k.default.findIndex(a,function(e){return ye.default.isPSA(e.id)});r>-1&&(a[r].name=l10n.t("whatsapp_psa_contact_name")),i.add(a,{merge:!0}),n.forEach(function(e){var t=e.type;if("c.us"===e.id){switch(i.disableSortListener(),t){case"clear":X.default.log("Model:chat:handle:clear:all before:"+e.before+" kind:"+e.kind)(),i.forEach(function(t){"number"==typeof e.before?t.deleteMsgsOlderThan(e.before,e.star,e.kind):t.deleteMsgs(e.star,e.kind)});break;case"delete":X.default.log("Model:chat:handle:delete:all")(),i.toArray().forEach(function(e){e.isGroup?e.deleteMsgs(!0):e.delete()});break;case"archive":X.default.log("Model:chat:handle:archive:all")(),i.forEach(function(e){e.archive=!0,e.pin=void 0});break;case"unarchive":X.default.log("Model:chat:handle:unarchive:all")(),i.forEach(function(e){e.archive=!1});break;case"unstar":X.default.log("Model:chat:handle:unstar:all")(),L.default.delete(),i.forEach(function(e){e.unstarAll()});break;default:X.default.error("Model:chat:handle unknown "+(0,l.default)(e),e)()}i.enableSortListener()}else{var a=i.get(e.id);if(!a)return;switch(t){case"clear":case"star":case"unstar":if(e.keys){for(var n=e.keys.length,r="star"===t,s=[],o=[],u=[],c=!1,f=0;f<n;f++){var h=void 0,p=void 0,g=void 0,v=void 0,_=void 0,m=e.keys[f];if(Array.isArray(m)){var y=(0,d.default)(m,3);h=y[0],p=y[1],g=y[2],v=new $.default({fromMe:p,remote:e.id,id:h,participant:g}),_=ce.default.Msg.get(v),_?"clear"===t?_.delete():(_.star=r,u.push(_)):r&&(c=!0)}else!k.default.isObject(m)||"star"!==t&&"unstar"!==t||(v=m.id,_=ce.default.Msg.get(m.id),_?(_.star=r,u.push(_)):o.push(m));s.push(v&&v.toString())}"star"!==t&&"unstar"!==t||L.default.process(r,o,u,c),X.default.log("model:Chat:handle:messages:"+[t,e.id,s.join(),e.modifyTag].join())()}else"clear"===t?("number"==typeof e.before?a.deleteMsgsOlderThan(e.before,e.star,e.kind):a.deleteMsgs(e.star,e.kind),X.default.log("model:Chat:handle cleared chat:"+[e.id,e.before,e.modifyTag,e.kind].join())()):"unstar"===t&&(a.unstarAll(),X.default.log("model:Chat:handle unstarred chat: "+e.id)());isNaN(e.modifyTag)||(a.modifyTag=e.modifyTag);break;case"delete":a.delete(),X.default.log("model:Chat:handle deleted chat for "+e.id)();break;case"archive":a.archive=!0,a.pin=void 0;break;case"unarchive":a.archive=!1;break;case"spam":a.notSpam=e.notSpam;break;case"modify_tag":a.modifyTag=e.modifyTag;break;case"pin":a.pin=e.pin;break;case"modify":a.changeNumberOldJid=e.changeNumberOldJid,a.changeNumberNewJid=e.changeNumberNewJid}}})}else if("leave"===t.cmd)t.gids.forEach(function(e){var t=i.get(e);t&&(0,ge.localExitGroup)(t)});else if("preempt"===t.cmd)this.add(t.response,{merge:!0}),V.default.platform===B.PLATFORMS.IPHONE&&(k.default.isEmpty(t.response)?ce.default.Msg.trigger(H.default.COLLECTION_HAS_SYNCED):setTimeout(function(){ce.default.Msg.trigger(H.default.COLLECTION_HAS_SYNCED)},2500)),this.trigger(H.default.COLLECTION_HAS_SYNCED,{count:t.response.length,binarySize:t.binarySize});else if("action"===t.cmd){var o=t.id,u=t.data;if("create"===u[0]||"introduce"===u[0]){var c=u[1],f=u[2],h=[].concat((0,s.default)(k.default.map(f.admins,function(e){return{id:e,isAdmin:!0}})),(0,s.default)(k.default.map(f.superadmins||[],function(e){return{id:e,isAdmin:!0,isSuperAdmin:!0}})),(0,s.default)(k.default.map(f.regulars,function(e){return{id:e,isAdmin:!1}})));ce.default.GroupMetadata.add({id:o,creation:f.creation,owner:c,participants:h,stale:!1,desc:f.desc,descId:f.descId,descTime:f.descTime,descOwner:f.descOwner,restrict:!!f.restrict,announce:!!f.announce},{merge:!0}),ce.default.Contact.add({id:o,name:f.subject},{merge:!0});var p=this.get(o);if(!p)return;var g=p.msgs.last();if(!g)return;"gp2"===g.type&&"add"===g.subtype&&(ce.default.GroupMetadata.trigger("group_participant_change_"+V.default.me.toString(),o),ye.default.equals(k.default.head(g.recipients),V.default.me)&&Y.default.alertNewMsg(g))}else{var v=this.get(t.id);v?v.handleGroupAction.apply(v,t.data):X.default.error("model:chat: unknown chat for action "+(0,l.default)(t))()}}else X.default.error("model:chat: unknown payload: "+(0,l.default)(t))()}},{key:"sync",value:function(){return this.findQuery({}).catch(P.WapDrop,function(){}),f.default.all([I.waitForBBEvent(this,H.default.COLLECTION_HAS_SYNCED),ce.default.Msg._hasSynced()])}},{key:"getKeysForResyncMsgs",value:function(){return this.filter(function(e){return e.isVisible}).map(function(e){var t=e.getAckedPhoneProps(),i=e.lastReceivedKey;return i&&(t.id=i.id,t.fromMe=i.fromMe.toString(),t.participant=i.participant),t})}},{key:"setKeysForResyncMsgs",value:function(e){this.keysForResyncMsgs=e}},{key:"resetKeysForResyncMsgs",value:function(){this.keysForResyncMsgs=void 0}},{key:"resyncMessages",value:function(){var e=this;X.default.log("ChatStore:resyncMessages")();var t=this.keysForResyncMsgs||this.getKeysForResyncMsgs();return _e.default.resyncMessages(t).then(function(t){return t.status>=400?(X.default.error("ChatStore:resyncMessages resume error "+t.status)(),f.default.reject(new Error("ChatStore:resyncMessages resume error "+t.status))):(X.default.log("ChatStore:resyncMessages resume success")(),(e.keysForResyncMsgs&&e.promises.initializeRestFromTabletCache?e.promises.initializeRestFromTabletCache:f.default.resolve()).then(function(){t.checksum&&ce.default.Contact.resyncContacts(t.checksum),t.statusChecksum&&ce.default.StatusV3.sync(t.statusChecksum),t.quickRepliesChecksum&&te.default.sync(t.quickRepliesChecksum),t.labelsChecksum&&Q.default.sync(t.labelsChecksum),t.stickerPackChecksum&&ue.default.sync(t.stickerPackChecksum),e.disableSortListener(),t.data.forEach(function(t){if(t.disableUnreadAnchor=!1,t.firstUnreadKey=void 0,t.keys&&1===t.keys.length){var i=t.keys[0];t.firstUnreadKey=new $.default({id:i[0],fromMe:i[1],participant:i[2],remote:t.id})}if("delete"!==t.type&&!ye.default.isPSA(t.id)){var a=ce.default.Contact.get(t.id);a?t.name&&(a.name=t.name):ce.default.Contact.add({id:t.id,name:t.name})}var n=e.get(t.id);if(!n)return void e.add(t);if("clear"===t.type){n.resetMediaMsgs();var r=[];n.msgs.forEach(function(e){return r.push(e)}),n.msgChunks.length&&n.msgChunks.forEach(function(e){e.forEach(function(e){return r.push(e)})}),n.set({t:t.t,unreadCount:t.unreadCount,createdLocally:!1,archive:t.archive,isReadOnly:t.isReadOnly,modifyTag:t.modifyTag,msgs:[],notSpam:t.notSpam,unreadMsgAnchor:void 0,disableUnreadAnchor:t.disableUnreadAnchor,pendingMsgs:t.pendingMsgs,pin:t.pin,changeNumberOldJid:t.changeNumberOldJid,changeNumberNewJid:t.changeNumberNewJid,muteExpiration:t.muteExpiration}),k.default.each(r,function(e){e.delete()}),X.default.log("model:chat:resume: cleared chat for "+t.id)()}else"delete"===t.type?(n.delete(),X.default.log("model:chat:resume: deleted chat for "+t.id)()):n.set(t,{merge:!0})})}).finally(function(){e.enableSortListener(!0)}))}).catch(P.WapDrop,function(e){return X.default.error("ChatStore:resyncMessages resume dropped")(),f.default.reject(e)}).finally(function(){e.resetKeysForResyncMsgs()})}},{key:"unstarAllMessages",value:function(e,t){var i=this,a=t?t.promises:this.promises,n=t?t.id:void 0;if(a.sendUnstarAll)return a.sendUnstarAll;var r=a.sendUnstarAll=_e.default.sendUnstarAll(n),s=new w.ActionType(l10n.t("action_message_unstarring_all")),o=r.then(function(e){return 200===e.status?new w.ActionType(l10n.t("action_message_unstarred_all")):e.status>=400?new w.ActionType(l10n.t("action_message_unstar_all_failed")):void 0}).catch(function(a){return X.default.error("models:chat:sendUnstarAll dropped")(a),new w.ActionType(l10n.t("action_message_unstar_all_failed"),l10n.t("action_try_again"),function(){return i.unstarAllMessages(e,t)})});return Y.default.openToast(ae.default.createElement(w.ActionToast,{id:(0,w.genId)(),initialAction:s,pendingAction:o})),r.then(function(a){200===a.status&&(k.default.forEach(e,function(e){e.set("star",!1)}),t?(0,O.removeStarredMsgs)(e):(L.default.reset(),oe.default.reset(),i.forEach(function(e){e.starredMsgs&&e.starredMsgs.reset()})))}).finally(function(){a.sendUnstarAll=null})}},{key:"forwardMessagesToChats",value:function(e,t){var a=i("dgjddffcfg"),n=f.default.map(e,function(e){return f.default.props({message:e,canForward:e.canForward()})});return f.default.map(t,function(e){var t=void 0;return t=e.isUser&&e.contact.isBlocked()?(0,pe.unblockContact)(e.contact):f.default.resolve(!0),f.default.all([n,t]).spread(function(t,i){var a=k.default.map(k.default.filter(t,{canForward:!0}),"message"),n=k.default.map(k.default.filter(t,{canForward:!1}),"message");return f.default.props({chat:e,undelivered:e.forwardMessages(a,!0),canForward:a,cannotForward:n})})}).then(function(e){var t=k.default.compact(e.map(function(e){var t=e.chat,i=e.undelivered,n=e.canForward,r=e.cannotForward,s=null;return(i.length||r.length)&&(s=a.formatForwardError({chat:t,undelivered:i,canForward:n,cannotForward:r})),s?{chat:t,reason:s}:null}));if(t.length)throw new K.default(t);return!0})}},{key:"saveToCache",value:function(){if(V.default.me){var e=t.cachePolicy.id;X.default.log("ChatCollection:saveToCache save: "+String(e))();var i=this.map(function(e,t){var i=e.toJSON(),a=t<20?Math.min(e.unreadCount+20,50):Math.min(Math.max(3,e.unreadCount),20);return i.msgs=e.msgs?e.msgs.slice(-a).map(function(e){return k.default.pickBy(e.toJSON(),function(e){return void 0!==e})}):[],i});he.default.setCollection(e,i,!0)}}},{key:"delete",value:function(){(0,T.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"delete",this).call(this),this.listenToOnce(this,"sort",k.default.debounce(this.setIndexes,100))}}]),t}(R.default);be.model=G.default,be.comparator=U.default,be.cachePolicy={id:"chat",policy:N.CACHE_POLICY.IMMEDIATE,trigger:"add sort remove reset change:id change:t change:unreadCount change:archive change:isReadOnly change:isAnnounceGrpRestrict change:modifyTag change:muteExpiration change:name change:notSpam change:pin change:changeNumberOldJid change:changeNumberNewJid change:lastReceivedKey change:msg:ack msgs:loadEarlier"},t.default=new be},dbfjecijha:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgLoadState=void 0;var n=i("cdaghjbcia"),r=a(n),s=i("ciaebjeace"),o=a(s),d=i("cjfdjhfbg"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("cbcbdjdah"),y=a(m),b=i("bhggeigghg"),E=a(b),T=i("cgcgbfbffj"),C=a(T),M=function(e){function t(){var e,i,a,n;(0,c.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,h.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(s))),a.noEarlierMsgs=(0,v.prop)(),a.isLoadingEarlierMsgs=(0,v.prop)(),a.isLoadingRecentMsgs=(0,v.prop)(),a.isLoadingAroundMsgs=(0,v.prop)(),a.contextLoaded=(0,v.prop)(),n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),t}(_.default);M.Proxy="msgLoad";var S=t.MsgLoadState=(0,v.defineModel)(M),k=function(e){function t(){(0,c.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,u.default)(t)).call(this));return e.msgLoadState=new S({noEarlierMsgs:!1,isLoadingEarlierMsgs:!1,isLoadingRecentMsgs:!1,isLoadingAroundMsgs:!1,contextLoaded:!1}),e.listenTo(e,"add remove reset sort",e.triggerChangeLast),e}return(0,g.default)(t,e),(0,r.default)(t,[{key:"delete",value:function(){this.stopListening(),(0,o.default)(t.prototype.__proto__||(0,u.default)(t.prototype),"delete",this).call(this),this.msgLoadState.delete()}},{key:"triggerChangeLast",value:function(e,t,i){var a=this.last();if(this._last!==a){this._last=a;var n=!1;t&&t.indexOf(e)>-1&&i&&i.add&&!i.remove&&(n=!0),this.trigger("change:last",a,n)}}},{key:"add",value:function(e,i){var a=this,n=(0,o.default)(t.prototype.__proto__||(0,u.default)(t.prototype),"add",this).call(this,e,i);return E.default.Msg.add(n,i).forEach(function(e){e&&a.isModel(e)&&(e.msgChunk=a)}),n&&this.trigger("bulk_add",n,i),n}},{key:"remove",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=(0,o.default)(t.prototype.__proto__||(0,u.default)(t.prototype),"remove",this).call(this,e,i),r=!!i&&i.silent,s=n.filter(function(e){return!!e});return s.length&&!r&&(this.trigger("remove_msgs",s,i),a||this.trigger("update_sort_time")),n}},{key:"replace",value:function(e){var t=this;this.msgLoadState=e.msgLoadState,this.loadRecentPromise=e.loadRecentPromise,this.loadEarlierPromise=e.loadEarlierPromise,this.loadAroundPromise=e.loadAroundPromise;var i=e.getModelsArray();this.set(i,{silent:!0,merge:!1}),i.forEach(function(e){t.isModel(e)&&(e.msgChunk=t)}),this.trigger("bulk_add",i)}}]),t}(C.default);k.model=y.default,t.default=k},dbjacfjdhg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("hbhijdici"),y=a(m),b=i("biheibdage"),E=a(b),T=i("cgcgbfbffj"),C=a(T),M=i("eadfaddcj"),S=a(M),k=i("cajijabhgb"),j=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(k),P=i("cieaaiahhf"),A=a(P),I=i("bbcjhfahhb"),O=a(I),L=i("bfgbdiffgd"),w=a(L),N=i("dcaibchbg"),R=a(N),D=i("cgffhfegce"),G=D.FILETYPE.IMAGE,F=D.FILETYPE.VIDEO,U=D.FILETYPE.DOCUMENT,x=D.FILETYPE.AUDIO,Y=b.ATTACH_MEDIA_STATE.READY,B=b.ATTACH_MEDIA_STATE.ERROR,V=b.ATTACH_MEDIA_STATE.PROCESSING,q=1,H=function(e){function t(){(0,u.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return e.errorMsgs=null,e.ignored=0,e.mediaPickerStatsLogger=new O.default,e.selection=new R.default([],function(e){return e.id},"prev"),e.listenTo(e.selection,"all",e._handleSelectionEvents.bind(e)),e}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_handleSelectionEvents",value:function(e,t){"focus"!==t&&!1!==t||this.trigger("active-change")}},{key:"removeSingleton",value:function(e,t){e&&(t||this.mediaPickerStatsLogger.logDelete(e.id),e.url&&window.URL.revokeObjectURL(e.url),e.original&&e.original.url&&window.URL.revokeObjectURL(e.original.url))}},{key:"remove",value:function(e,i){var a=this,n=(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"remove",this).call(this,e,i);return n.forEach(function(e){return a.removeSingleton(e,i)}),this.selection.init(this.getPreviewableMedias(),!0),n}},{key:"delete",value:function(){var e=this;(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.forEach(function(t){return e.removeSingleton(t)}),this.selection.init(this.getPreviewableMedias(),!0)}},{key:"replace",value:function(e,t){var i=this.get(e);if(i){var a=this.indexOf(i),n=i.caption;this.remove(i,{silent:!0}),i.delete();var r=new E.default({id:e,caption:n,file:this._normalizeFile(t),chat:i.chat,uiProcessed:!1});return this.add(r,a?{at:a}:{}),r.processPromise}}},{key:"getValidMedias",value:function(){return this.filter(function(e){return e.state===Y})}},{key:"getPreviewableMedias",value:function(){return this.filter(function(e){return e.previewable})}},{key:"getActive",value:function(){return this.selection.getVal()}},{key:"setActive",value:function(e){this.selection.setVal(e)}},{key:"unsetActive",value:function(){this.selection.unset()}},{key:"setNextAsActive",value:function(){var e=this.selection.list.length-1;return-1===this.selection.index||this.selection.index===e?this.selection.getVal():(this.selection.setNext(),this.selection.getVal())}},{key:"setPrevAsActive",value:function(){return-1===this.selection.index||0===this.selection.index?this.selection.getVal():(this.selection.setPrev(),this.selection.getVal())}},{key:"processFiles",value:function(e,t,i){var a=this,n=this.getPreviewableMedias().length,s=e.length+n>S.default.MAX_FILES?Math.max(S.default.MAX_FILES-n,0):e.length,o=e.length-s;0===s?o&&this.trigger("max_upload_limit",o):this.ignore(o);var d=e.slice(0,s).map(function(e){return new E.default({id:q++,file:a._normalizeFile(e),chat:t,uiProcessed:!1})});this.add(d);var u=this.getActive();return this.unsetActive(),r.default.all(e).then(function(){return a._attemptToSetNextActiveFromAdded(d,u)}),r.default.map(d,function(e){return e.processPromise}).then(function(){return a._attemptToSetNextActiveFromAdded(d,u)})}},{key:"_attemptToSetNextActiveFromAdded",value:function(e,t){if(!this.getActive()&&!y.default.some(this.getModelsArray(),{state:V,previewable:!1})){var i=y.default.find(e,function(e){return e.previewable});i||(i=t),this.selection.init(this.getPreviewableMedias()),i&&this.setActive(i)}}},{key:"_logMediaAdd",value:function(e){this.mediaPickerStatsLogger.chatRecipients||(this.mediaPickerStatsLogger.chatRecipients=e.chat.groupMetadata&&e.chat.groupMetadata.participants.length||1);var t=e.isGif?"gif":e.type;this.mediaPickerStatsLogger.logAdd(e.id,t,e.fileOrigin)}},{key:"_normalizeFile",value:function(e){return r.default.resolve(e).then(function(e){var t=void 0;return t=e instanceof File?{file:e,filename:e.name,mimetype:e.type,type:(0,D.typeFromMimetype)(e.type)}:e instanceof Blob?{file:e,mimetype:e.type,type:(0,D.typeFromMimetype)(e.type)}:e,!t.type&&t.mimetype&&(t.type=(0,D.typeFromMimetype)(t.mimetype)),t})}},{key:"ignore",value:function(e){e>0&&(this.ignored+=e)}},{key:"uiProcessMsgs",value:function(){var e=this,t=[],i=void 0,a=0,n=0,r=0,s=0,o=0,d=0,u=0,l=0,c=0,f=!1,h=l10n.filesize(w.default.media),p=l10n.filesize(w.default.maxFileSize);if(this.forEach(function(t){if(!t.uiProcessed&&(!i&&t.previewable&&(i=t,e._logMediaAdd(t)),t.state!==V&&(t.uiProcessed=!0,t.state===B)))if(t.exception instanceof A.default)switch(t.getFileType()){case G:a+=1;break;case F:n+=1;break;case x:r+=1;break;case U:s+=1}else if(t.exception instanceof j.MediaFileEmpty)switch(t.getFileType()){case G:o+=1;break;case F:d+=1;break;case x:u+=1;break;case U:l+=1}else t.exception instanceof j.MediaFileFailedLoad?f=!0:c+=1}),a>0&&t.push(l10n.t("image_too_big",{number:a,_plural:a,maxSize:h})),n>0&&t.push(l10n.t("video_too_big",{number:n,_plural:n,maxSize:h})),r>0&&t.push(l10n.t("audio_too_big",{number:r,_plural:r,maxSize:h})),s>0&&t.push(l10n.t("document_too_big",{number:s,_plural:s,maxSize:p})),o>0&&t.push(l10n.t("image_empty",{number:o,_plural:o})),d>0&&t.push(l10n.t("video_empty",{number:d,_plural:d})),u>0&&t.push(l10n.t("audio_empty",{number:u,_plural:u})),l>0&&t.push(l10n.t("document_empty",{number:l,_plural:l})),c>0&&t.push(l10n.t("files_not_supported",{number:c,_plural:c})),f&&(t=[],t.push(l10n.t("media_failed_load"))),t.length>1){t=[];var g=a+n+r+s,v=o+d+u+l,_=g+v+c;0===c?(0!==g&&t.push(l10n.t("files_too_big",{number:g,_plural:g,maxSize:p})),0!==v&&t.push(l10n.t("files_empty",{number:v,_plural:v}))):t.push(l10n.t("files_not_added",{number:_,_plural:_}))}this.errorMsgs=t.join(" "),this.ignore(this.getPreviewableMedias().length-S.default.MAX_FILES);var m=this.ignored;return this.ignored=0,m&&this.trigger("max_upload_limit",m),{errorMsgs:this.errorMsgs}}},{key:"canSend",value:function(){return!y.default.some(this.getModelsArray(),{state:V,previewable:!1})}}]),t}(C.default);H.model=E.default,t.default=H},dbjfahieed:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e,t){switch(t.policy){case"LOAD":return new s.default(e,t);case"IMMEDIATE":return new l.default(e,t);case"NONE":return new d.default(e,t)}return new d.default(e,{id:"none",policy:"NONE"})}Object.defineProperty(t,"__esModule",{value:!0}),t.CACHE_POLICY_TYPE=void 0,t.createCachePolicy=n;var r=i("cgfdiahhcd"),s=a(r),o=i("cdbfiiicdg"),d=a(o),u=i("ijiafihgg"),l=a(u),c=i("bdfbccfifg");t.CACHE_POLICY_TYPE=c.CACHE_POLICY_TYPE},dcaifjegcg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=(0,_.convert)(e),i=(0,_.stateExtend)(D,t);if(e.Proxy){var a=(0,T.genMirrorMask)(t);i.prototype.mirrorMask=a,(0,N.default)(e.Proxy,t,a)}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.collection=t.derived=t.session=t.prop=void 0;var r=i("diebfbcjgd"),s=a(r),o=i("cjfdjhfbg"),d=a(o),u=i("dfedaiidge"),l=a(u),c=i("cdaghjbcia"),f=a(c),h=i("bcddciefhh"),p=a(h),g=i("bghiedffgi"),v=a(g),_=i("bjcgjfiffb");Object.defineProperty(t,"prop",{enumerable:!0,get:function(){return _.prop}}),Object.defineProperty(t,"session",{enumerable:!0,get:function(){return _.session}}),Object.defineProperty(t,"derived",{enumerable:!0,get:function(){return _.derived}}),Object.defineProperty(t,"collection",{enumerable:!0,get:function(){return _.collection}}),t.defineModel=n;var m=i("hbhijdici"),y=a(m),b=i("cajijabhgb"),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(b),T=i("jjbajibff"),C=a(T),M=i("gbfffciea"),S=a(M),k=i("cccehdaiaf"),j=a(k),P=i("bdiiahhjbe"),A=a(P),I=i("bhggeigghg"),O=a(I),L=i("hjbbdjjdf"),w=i("ceidcegjgi"),N=a(w),R=/^change:/,D=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,l.default)(this,t);var a=(0,p.default)(this,(t.__proto__||(0,d.default)(t)).call(this));if(a.stale=(0,_.session)(),a.__fired=null,a.__changes=null,i._internalInitializationDoNotUse)return(0,p.default)(a);a.stale=e&&e.stale||a.getDefault("stale"),a.parent=i.parent,a.collection=i.collection,a._initDeriveds(),a._initCollections();var n=a.__defaults,r=n?y.default.assign({},n,e):e;return r&&!y.default.isEmpty(r)&&a.set(r,y.default.assign({silent:!0},i)),a.initialize(),a}return(0,v.default)(t,e),(0,f.default)(t,[{key:"initialize",value:function(){if(this.collection&&this.id&&!this.collection._model.prototype.isIdType(this.id))throw new Error("Model id:"+String(this.id)+" is wrong type");this._uiObservers=0,this.mirrorMask&&(this.mirror=new C.default(this))}},{key:"update",value:function(){return this.getCollection().update(this.id)}},{key:"find",value:function(){return this.getCollection().find(this.id)}},{key:"getCollection",value:function(){return this.Collection||A.default.assert(!1,"no-collection","baseState:getCollection Attempting to get a non existing collection")(),O.default[this.Collection]}},{key:"_refreshStaleModel",value:function(){!this._uiObservers&&this.stale||this.getCollection().find(this.id).catch(E.WapDrop,function(){})}},{key:"incObservers",value:function(e){if(this._uiObservers++,!e){i("deiciccchg").default.online&&this.stale&&(S.default.uiBusy?this.listenToOnce(S.default,"ui_idle",this._refreshStaleModel):this._refreshStaleModel())}}},{key:"decObservers",value:function(){this._uiObservers>0&&this._uiObservers--,0===this._uiObservers&&this.stopListening(S.default,"ui_idle",this._refreshStaleModel)}},{key:"hasObservers",value:function(){return this._uiObservers>0}},{key:"addChild",value:function(e,t){var i={};i[e]=t,this.set(i,{silent:!0}),this.listenTo(t,"all",this._getCachedEventBubblingHandler(e))}},{key:"get",value:function(e){return this[e]}},{key:"set",value:function(e,t,i){return"string"==typeof e?this._set(e,t,i):(i=t,i&&i.merge?this._set(y.default.omitBy(e,y.default.isUndefined),i):this._set(e,i))}},{key:"_set",value:function(e,t,i){var a=this,n=!!this.__changes,r=void 0;(0,L.isString)(e)?r=this._setKV(e,t,i):(i=t,r=y.default.reduce(e,function(e,t,n){var r=a._setKV(n,t,i);return r&&e.push(r),e},[]));for(var o=0;r&&r.length>0;)!function(){if(o++>5)throw new Error("Circular derived properties / event listeners");var e=y.default.flatten(r),t=a._topo;if(!t)throw new Error("_topo unexpectedly undefined");var i=y.default.intersection(t,e);r=i.reduce(function(e,t,n){var r=a._setD(t,i.slice(n+1));return r&&e.push.apply(e,(0,s.default)(r)),e},[])}();if((!i||!i.silent)&&this.hasUnfiredChanges()){for(var d=this.__fired={},u=this._getChanges(),l=u.length;u.length;){var c=u.shift();if(!d[c]){d[c]=!0;var f=this._definition[c].evt;(this.isListening(f)||this.isListening("all"))&&this.trigger(f,this,this[c])}}(l&&this.isListening("change")||this.isListening("all"))&&this.trigger("change",this)}return n||(this.__changes&&(this.__changes=null),this.__fired&&(this.__fired=null)),this}},{key:"_setKV",value:function(e,t,i){if(this._collections[e])return void this[e].set(t,i);var a=this._definition[e];if(!a)return void(this[e]=t);if(a.attr===_.Attr.DERIVED)throw new Error("Attempting to directly set derived property: "+e);var n=a.sk;if(this[n]!==t){this[n]=t,this._getChanges().push(e),this.__fired&&(this.__fired[e]=!1);var r=this._deps;return r&&r[e]?r[e]:void 0}}},{key:"_setD",value:function(e,t){var i=this._definition[e],a=i.sk,n=i.fn.call(this);if(this[a]!==n&&(this[a]=n,this._getChanges().push(e),this.__fired&&(this.__fired[e]=!1),this._deps&&this._deps[e])){var r=y.default.difference(this._deps[e],t);if(r.length)return r}}},{key:"hasUnfiredChanges",value:function(){var e=this.__fired,t=this.__changes;if(!t)return!1;if(!e)return!0;for(var i=0;i<t.length;i++)if(!e[t[i]])return!0;return!1}},{key:"_getChanges",value:function(){return this.__changes||(this.__changes=[])}},{key:"_initDeriveds",value:function(){var e=this;y.default.forEach(this.__derived,function(t){e[e._definition[t].sk]=_.INIT})}},{key:"_initCollections",value:function(){var e=this;y.default.forOwn(this._collections,function(t,i){e[i]=new t(null,{parent:e})})}},{key:"unset",value:function(e,t){e=Array.isArray(e)?e:[e],this.set(y.default.zipObject(e),t)}},{key:"clear",value:function(){this.unset([].concat((0,s.default)(this.__props),(0,s.default)(this.__session)))}},{key:"delete",value:function(){this.stopListening()}},{key:"reset",value:function(){this.set(this.__defaults)}},{key:"toJSON",value:function(){return this.serialize()}},{key:"serialize",value:function(){for(var e=this,t={},i=0;i<this.__props.length;i++)t[this.__props[i]]=this[this.__props[i]];return y.default.forOwn(this._collections,function(i,a){t[a]=e[a].serialize()}),t}},{key:"getDefault",value:function(e){var t=this._definition[e];if(t){var i=t.default;return(0,L.isFunction)(i)?i():i}}},{key:"_getCachedEventBubblingHandler",value:function(e){return function(t,i,a){R.test(t)?this.trigger("change:"+e+"."+t.split(":")[1],i,a):"change"===t&&this.trigger("change",this)}.bind(this)}}],[{key:"isIdType",value:function(e){return!!(this.idWhitelist&&this.idWhitelist.indexOf(e)>-1)||(this.idClass?e instanceof this.idClass:"string"==typeof e)}}]),t}(j.default);t.default=D},dcdiaahjj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(){switch(x.default.state){case U.STATE.TIMEOUT:return ee.TIMEOUT;case U.STATE.OPENING:return F.default.online?ee.OPENING:ee.OFFLINE;case U.STATE.PAIRING:return x.default.hasSynced?ee.RESUMING:ee.PAIRING;case U.STATE.CONNECTED:return x.default.stream!==U.STREAM.CONNECTED?x.default.hasSynced?ee.NORMAL:ee.SYNCING:ee.NORMAL;case U.STATE.UNLAUNCHED:case U.STATE.PROXYBLOCK:default:return ee.NORMAL}}function r(){if(!W.default.knowsPhone()&&x.default.state!==U.STATE.PROXYBLOCK)return te.QR;var e=x.default.hasSynced;switch(x.default.state){case U.STATE.PROXYBLOCK:return te.PROXYBLOCK;case U.STATE.CONFLICT:return te.CONFLICT;case U.STATE.TOS_BLOCK:return te.TOS_BLOCK;case U.STATE.SMB_TOS_BLOCK:return te.SMB_TOS_BLOCK;case U.STATE.DEPRECATED_VERSION:return te.DEPRECATED_VERSION;case U.STATE.UNLAUNCHED:return te.SYNCING;case U.STATE.UNPAIRED_IDLE:case U.STATE.UNPAIRED:return te.QR;case U.STATE.OPENING:if(!F.default.online&&!x.default.hasSynced)return te.OFFLINE;default:return e||x.default.stream===U.STREAM.CONNECTED?te.MAIN:te.SYNCING}}function s(e,t){switch(t){case ie.SHOW:return e;case ie.HIDE:return x.default.hasSynced?ee.NORMAL:ee.CONNECTING;case ie.OBSCURE:switch(e){case ee.OPENING:case ee.PAIRING:case ee.SYNCING:case ee.RESUMING:return ee.CONNECTING;default:return e}default:return P.default.error("Stream:unknown obscure level:",t)(),e}}Object.defineProperty(t,"__esModule",{value:!0}),t.StreamMode=t.StreamInfo=void 0;var o=i("bachgbfdhf"),d=a(o),u=i("djbjejhhj"),l=a(u),c=i("djchjahdbh"),f=a(c),h=i("cjfdjhfbg"),p=a(h),g=i("dfedaiidge"),v=a(g),_=i("cdaghjbcia"),m=a(_),y=i("bcddciefhh"),b=a(y),E=i("ciaebjeace"),T=a(E),C=i("bghiedffgi"),M=a(C),S=i("eadfaddcj"),k=a(S),j=i("bdiiahhjbe"),P=a(j),A=i("dcaifjegcg"),I=a(A),O=i("bfbggcdbfb"),L=a(O),w=i("djbfbcedhj"),N=a(w),R=i("bhggeigghg"),D=a(R),G=i("deiciccchg"),F=a(G),U=i("eaaehfdjdg"),x=a(U),Y=i("cbbhbjebii"),B=a(Y),V=i("ceddibdhdb"),q=a(V),H=i("bebehddcbc"),W=a(H),K=i("cfgcdfcfee"),z=a(K),Q=i("gbfffciea"),J=a(Q),X=i("hbhijdici"),Z=a(X),$=i("icbibjcg"),ee={OFFLINE:"OFFLINE",OPENING:"OPENING",PAIRING:"PAIRING",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTING:"CONNECTING",NORMAL:"NORMAL",TIMEOUT:"TIMEOUT"},te={QR:"QR",MAIN:"MAIN",SYNCING:"SYNCING",OFFLINE:"OFFLINE",CONFLICT:"CONFLICT",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK",SMB_TOS_BLOCK:"SMB_TOS_BLOCK",DEPRECATED_VERSION:"DEPRECATED_VERSION"};t.StreamInfo=ee,t.StreamMode=te;var ie={SHOW:"SHOW",OBSCURE:"OBSCURE",HIDE:"HIDE"},ae=function(e){function t(){var e,i,a,n;(0,v.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,b.default)(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(s))),a.info=(0,A.session)(ee.NORMAL),a.mode=(0,A.session)(te.SYNCING),a.obscurity=(0,A.session)(ie.HIDE),a.needsUpdate=(0,A.session)(),a.clientExpired=(0,A.session)(!1),a.hardExpired=(0,A.session)(!1),a.couldForce=(0,A.session)(),a.uiActive=(0,A.session)(),a.available=(0,A.session)(!0),a.unavailableShiftTimer=(0,A.session)(),a.unavailableLogoutTimer=(0,A.session)(),a.unobscureShiftTimer=(0,A.session)(),a.timeoutEvent=(0,A.session)(),a.resumeCount=(0,A.session)(0),a.phoneAuthed=(0,A.session)(!1),a._waitForSocketPromise=(0,A.session)(),a._waitForSocketResolve=(0,A.session)(),a.displayInfo=(0,A.derived)(a._displayInfo,["info","obscurity"]),n=i,(0,b.default)(a,n)}return(0,M.default)(t,e),(0,m.default)(t,[{key:"_displayInfo",value:function(){return s(this.info,this.obscurity)}},{key:"initialize",value:function(){var e=this;(0,T.default)(t.prototype.__proto__||(0,p.default)(t.prototype),"initialize",this).call(this),P.default.log("Stream:rememberMe: "+String(W.default.getRememberMe()))(),this.unavailableShiftTimer=new q.default(function(){return e.markUnavailable()}),this.unobscureShiftTimer=new q.default(function(){return e.unobscure()}),this.unavailableLogoutTimer=new q.default(function(){W.default.getRememberMe()||(P.default.log("Stream:unavailableLogoutTimer logout due to inactivity")(),x.default.logout())}),this.listenTo(x.default,"change:state change:stream change:hasSynced",this.onSocketUpdate),this.listenTo(F.default,"change:online",this.onSocketUpdate),this.listenTo(this,"change:available",this.onAvailableUpdate),this.listenTo(this,"change:phoneAuthed",this.onPhoneAuthedUpdate),this.listenTo(this,"change:info change:displayInfo change:mode",Z.default.debounce(this.onSelfUpdate)),this.listenTo(this,"change:info",this.logPageResume),this.listenTo(this,"change:info",this.updateWamLog),this.listenTo(this,"change:mode",this.logModeChange),this.listenTo(this,"change:available change:uiActive",this.updateCouldForce),this.listenTo(J.default,"midnight",this.updateHardExpire.bind(this)),window.document&&document.addEventListener("visibilitychange",this.updateCouldForce),this.updateCouldForce(),this.updateHardExpire()}},{key:"delete",value:function(){}},{key:"handle",value:function(e){switch(e[0]){case"asleep":break;case"update":var t=e[2],i=void 0,a=void 0;"number"==typeof e[1]?a=e[1]:i=!!e[1],B.default.update(t,i,a);break;case"killsw":B.default.killServiceWorker();break;case"update_desktop":var n=(0,f.default)(e,5),r=(n[0],n[1]),s=n[2],o=n[3],d=n[4],u=B.default.activeVersion.lt(r)?(0,l.default)(s,10):void 0,c=B.default.activeVersion.lt(o);B.default.update(void 0,c,u,d);break;case"desktop_manual_download":break;default:P.default.error("Stream:handle unknown cmd "+e[0],e)()}}},{key:"markAvailable",value:function(){this.unavailableShiftTimer.cancel(),this.available=!0,N.default.monitor(!0,this.displayInfo===ee.TIMEOUT)}},{key:"markUnavailable",value:function(e){e?this.unavailableShiftTimer.onOrBefore(e):(this.unavailableShiftTimer.cancel(),this.available=!1,N.default.monitor(!1,this.displayInfo===ee.TIMEOUT))}},{key:"hasSocket",value:function(){return this.info===ee.NORMAL||this.info===ee.TIMEOUT}},{key:"waitForSocket",value:function(){var e=this;return this.hasSocket()?d.default.resolve():this._waitForSocketPromise?this._waitForSocketPromise:this._waitForSocketPromise=new d.default(function(t){e._waitForSocketResolve=t})}},{key:"onSelfUpdate",value:function(){P.default.log("Stream:onSelfUpdate mode:"+this.mode+" info:"+this.info+" view:"+this.displayInfo)();var e=this.timeoutEvent;if(this.info===ee.TIMEOUT)e||(this.timeoutEvent=e=new L.default.WebcPhoneDisconnected),this.displayInfo!==ee.TIMEOUT||this._bbarTime||(this._bbarTime=Date.now());else if(e){e.markWebcPhoneDisconnectedT();var t=this._bbarTime;t&&(e.webcPhoneBbarShownT=Date.now()-t),e.commit(),this.timeoutEvent=null}this.hasSocket()&&this._waitForSocketResolve&&(this._waitForSocketResolve(),this._waitForSocketResolve=null,this._waitForSocketPromise=null)}},{key:"onSocketUpdate",value:function(){var e={},t=n();if(e.info=t,e.mode=r(),e.phoneAuthed=x.default.stream!==U.STREAM.DISCONNECTED,t===ee.NORMAL)this.unobscureShiftTimer.cancel(),e.obscurity=ie.HIDE;else if(t===ee.OFFLINE)this.unobscureShiftTimer.cancel(),e.obscurity=ie.OBSCURE;else switch(this.obscurity){case ie.HIDE:this.unobscureShiftTimer.onOrBefore(k.default.DIAGNOSTIC_DELAY);break;case ie.OBSCURE:this.unobscureShiftTimer.onOrBefore(3e3);break;case ie.SHOW:}this.set(e)}},{key:"unobscure",value:function(){this.obscurity=ie.SHOW}},{key:"onPhoneAuthedUpdate",value:function(){this.phoneAuthed&&(this.sendAvailability(!0),D.default.RecentEmoji.sync(),D.default.RecentSticker.sync())}},{key:"onAvailableUpdate",value:function(){var e=this.available;P.default.log("Stream:onAvailableUpdate user "+(e?"available":"unavailable"))(),e||W.default.getRememberMe()?this.unavailableLogoutTimer.cancel():this.unavailableLogoutTimer.onOrBefore(k.default.IDLE_TIMEOUT_WAIT),this.sendAvailability(!1)}},{key:"sendAvailability",value:function(e){(e||this.uiActive)&&(this.available?(0,$.sendPresenceAvailable)():(0,$.sendPresenceUnavailable)())}},{key:"updateCouldForce",value:function(){this.couldForce=!this.uiActive||!this.available&&document.hidden}},{key:"updateHardExpire",value:function(){B.default.isExpired()&&(this.hardExpired=!0,B.default.restart(!0))}},{key:"logPageResume",value:function(){this.info===ee.RESUMING&&(this.resumeCount++,new L.default.WebcPageResume({webcResumeCount:this.resumeCount}).commit())}},{key:"updateWamLog",value:function(){var e=this.info===ee.NORMAL;N.default.streamInfoChange(this.info,z.default.numSocketsAttempted,e),e&&this.stopListening(this,"change:info",this.updateWamLog)}},{key:"logModeChange",value:function(){var e=void 0;e=this.mode===te.TOS_BLOCK||this.mode===te.SMB_TOS_BLOCK?L.default.WEBC_STREAM_MODE_CODE.TOS_BLOCK:L.default.WEBC_STREAM_MODE_CODE[this.mode],new L.default.WebcStreamModeChange({webcStreamMode:e}).commit()}}]),t}(I.default);ae.Proxy="stream";var ne=(0,A.defineModel)(ae);t.default=new ne},ddcfhecgai:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("eaejieeafc"),h=a(f),p=i("cgcgbfbffj"),g=a(p),v=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),t}(g.default);v.model=h.default,t.default=v},ddeghajfaj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("dcaifjegcg"),g=a(p),v=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,p.prop)(),a.shortcut=(0,p.prop)(),a.message=(0,p.prop)(),a.count=(0,p.prop)(),a.keywords=(0,p.prop)(),a.pendingCount=(0,p.session)(0),a.totalCount=(0,p.derived)(a._totalCount,["count","pendingCount"]),n=i,(0,c.default)(a,n)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"_totalCount",value:function(){return this.count+this.pendingCount}},{key:"useOnce",value:function(){this.pendingCount+=1,this.getCollection().periodicFlush()}}]),t}(g.default);v.Collection="QuickReply",v.Proxy="quickReply",t.default=(0,p.defineModel)(v)},debjjaigad:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PREFERENCE=void 0;var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=a(f),p=i("jccfhaecf"),g=a(p),v=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,f.prop)(),a.wallpaperColor=(0,f.prop)(),a.saveToCameraRoll=(0,f.prop)(),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.default);v.Collection="ChatPreference",v.Proxy="chatPreference",v.idClass=g.default,v.idWhitelist=["defaultPreference"],t.DEFAULT_PREFERENCE="defaultPreference",t.default=(0,f.defineModel)(v)},defecifdhg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULTS=void 0;var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("dcaifjegcg"),g=a(p),v=i("jccfhaecf"),_=a(v),m=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,p.prop)(),a.tag=(0,p.prop)(),a.address=(0,p.prop)(),a.description=(0,p.prop)(),a.vertical=(0,p.prop)(),a.email=(0,p.prop)(),a.website=(0,p.prop)(),a.latitude=(0,p.prop)(),a.longitude=(0,p.prop)(),a.businessHours=(0,p.prop)(),a.catalogStatus=(0,p.prop)(),a.stale=(0,p.session)(!0),n=i,(0,c.default)(a,n)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"markStale",value:function(){this.stale=!0,this.hasObservers()&&this.find()}}]),t}(g.default);m.Collection="BusinessProfile",m.Proxy="businessProfile",m.idClass=_.default,t.default=(0,p.defineModel)(m);t.DEFAULTS={address:null,description:null,vertical:null,email:null,website:null}},dfbhcehadj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("cgcgbfbffj"),g=a(p),v=i("eaejdgfgif"),_=a(v),m=i("djegeegcbf"),y=a(m),b=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"setVariant",value:function(e,t){var i=y.default.skinToneEmojis[e];if(!i)throw new Error("attempt to store variantless emoji");this.gadd({id:i,variant:t})}},{key:"getVariant",value:function(e){if(y.default.skinToneEmojis[e]){var t=this.get(e);return t?t.variant:null}throw new Error("attempt to get variantless emoji")}},{key:"getVariantIfExists",value:function(e){if(y.default.skinToneEmojis[e]){var t=this.get(e);return t?t.variant:null}return null}}]),t}(g.default);b.model=_.default,b.cachePolicy={id:"emoji_variant_collection",policy:p.CACHE_POLICY.LOAD,delay:1e3},t.default=new b},dfgeejdaib:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("hbhijdici"),y=a(m),b=i("cgcgbfbffj"),E=a(b),T=i("cbcbdjdah"),C=a(T),M=i("biecbbiiee"),S=a(M),k=i("eaaehfdjdg"),j=a(k),P=i("ccaaiecfib"),A=a(P),I=i("bdiiahhjbe"),O=a(I),L=function(e){function t(){(0,u.default)(this,t);var e=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this));return e.syncPromise=null,e.isSynced=!1,e.listenTo(j.default,"change:stream",function(){j.default.stream===k.STREAM.DISCONNECTED&&(e.isSynced=!1)}),e}return(0,_.default)(t,e),(0,c.default)(t,[{key:"onResume",value:function(){this.isSynced=!1,this.sync()}},{key:"maySync",value:function(){return A.default.supportsFeature(A.default.F.STARRED_GIFS)}},{key:"sync",value:function(){var e=this;return this.isSynced?r.default.resolve():this.syncPromise?this.syncPromise:this.maySync()?(this.syncPromise=S.default.getStarred(void 0,void 0,void 0,!0).then(function(t){var i=[];t&&t.length&&(i=y.default.filter(t,function(e){return e&&e.isGif&&!e.isUnsentMedia})),e.set(i)}).catch(function(e){499!==e&&O.default.error("starred gif msgs sync error: ",e)()}).finally(function(){e.syncPromise=null,e.isSynced=!0}),this.syncPromise):r.default.resolve()}},{key:"add",value:function(e,i){var a=this;if(!e||!this.maySync()||!this.isSynced)return[];var n=this.isModel(e)?[e]:e;return n=y.default.filter(n,function(e){return e.isGif&&!a.get(e)}),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"add",this).call(this,n,i)}},{key:"remove",value:function(e,i){var a=this;if(!e||!this.maySync()||!this.isSynced)return[];var n=this.isModel(e)?[e]:e;return n=y.default.filter(n,function(e){return e.isGif&&a.get(e)}),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"remove",this).call(n,i)}}]),t}(E.default);L.model=C.default,L.comparator=function(e,t){return t.t-e.t},e.exports=new L},dfhgffbdig:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dbdfbgehgj"),_=a(v),m=i("gbfffciea"),y=a(m),b=i("bjigbaghc"),E=a(b),T=i("fcedgihic"),C=a(T),M=i("ccaaiecfib"),S=a(M),k=i("iajeehcac"),j=a(k),P=i("beahjdfigf"),A=a(P),I=i("bfgbdiffgd"),O=a(I),L=i("dffedeegcb"),w=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.sendForNeededAddRequest=function(e){var t=a.parent.id,i=_.default.assertGet(t),n=i.groupMetadata.desc;(0,L.sendForNeededAddRequest)(e,i.name,n,a.parent.id)},n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){this.listenTo(this,"change:contact.name",this.sort),this.listenTo(y.default,"locale_change",this.sort)}},{key:"delete",value:function(){this.forEach(function(e){e.delete()}),this.stopListening(),this.reset()}},{key:"set",value:function(e,i){return i=i||{},i.isParticipantCollectionAdd||(i.remove=!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"set",this).call(this,e,i)}},{key:"add",value:function(e,i){return i=i||{},i.isParticipantCollectionAdd=!0,(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"add",this).call(this,e,i)}},{key:"canAdd",value:function(){return!!this.iAmAdmin()}},{key:"canPromote",value:function(e){return!!e&&(!E.default.me.equals(e.id)&&(!!this.iAmAdmin()&&!e.isAdmin))}},{key:"canDemote",value:function(e){return!!e&&(!!this.iAmAdmin()&&(!E.default.me.equals(e.id)&&!(S.default.supportsFeature(S.default.F.GROUPS_V_3)&&O.default.groupsV3&&e.isSuperAdmin||!e.isAdmin)))}},{key:"canRemove",value:function(e){return!!e&&(!E.default.me.equals(e.id)&&!!this.iAmAdmin())}},{key:"canVerifyIdentity",value:function(e){return!!S.default.supportsFeature(S.default.F.QUERY_IDENTITY)&&(!!e&&(!E.default.me.equals(e.id)&&!!e.contact.plaintextDisabled))}},{key:"iAmMember",value:function(){return 1===this.filter(function(e){return e.id.equals(E.default.me)}).length}},{key:"iAmAdmin",value:function(){return 1===this.filter(function(e){return e.id.equals(E.default.me)&&e.isAdmin}).length}},{key:"iAmSuperAdmin",value:function(){return 1===this.filter(function(e){return e.id.equals(E.default.me)&&e.isSuperAdmin}).length}},{key:"getAdmins",value:function(){return this.where({isAdmin:!0})}}]),t}(C.default);w.model=j.default,w.comparator=A.default,t.default=w},dfjfgdhbjj:function(e,t,i){"use strict";function a(e,t){var i=e.pin||0,a=t.pin||0;if(i||a)return i!==a?i>a?-1:1:e.id.toString()<t.id.toString()?-1:1;var n=e.t||0,r=t.t||0;return n!==r?n>r?-1:1:e.id.toString()<t.id.toString()?-1:1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},dghggcieid:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=a(f),p=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,f.prop)(),a.weight=(0,f.prop)(),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.default);p.Proxy="recentEmoji",t.default=(0,f.defineModel)(p)},dghjhchjic:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("hbhijdici"),h=a(f),p=i("ccdbdjihjh"),g=a(p),v=i("cgcgbfbffj"),_=a(v),m=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),t}(_.default);m.model=g.default,m.comparator=function(e,t){return e.id===t.id?0:h.default.lt(e.id,t.id)?-1:1},t.default=m},dhadcigcaf:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.GLOBAL_MUTE=void 0;var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("ddhijeejag"),y=a(m),b=i("bdiiahhjbe"),E=a(b),T=i("jccfhaecf"),C=a(T),M=i("dcaifjegcg"),S=a(M),k=i("chajfbfiga"),j=a(k),P=i("gbfffciea"),A=a(P),I=i("cajijabhgb"),O=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(I),L=i("djheacfeif"),w=a(L),N=i("ccihhdchab"),R=i("dgdjiicfdg"),D=a(R),G=i("hjbbdjjdf"),F=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,M.prop)(),a.expiration=(0,M.prop)(0),a._unmuteTimer=(0,M.session)(),a.promises=(0,M.session)(function(){return{}}),a.isMuted=(0,M.derived)(a._isMuted,["expiration"]),n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_isMuted",value:function(){return!!this.expiration}},{key:"initialize",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"initialize",this).call(this),this.expiration&&this.mute(this.expiration)}},{key:"setMute",value:function(e,t){(e||this.expiration)&&e!==this.expiration&&(e?this.mute(e,t):this.unmute(t))}},{key:"mute",value:function(e,t,i){var a=this;if(!(0,G.isNumber)(e))return E.default.log("models:Mute:mute called with invalid expiration "+e)(),r.default.reject(new O.ActionError);(e=Math.round(e))>2e9&&E.default.log("models:Mute:mute called with wrong units?"+this.id.toString()+" exp:"+e)();var n=function(){if(this.isMuted&&this._clearUnmuteTimer(),-1===e)E.default.log("models:Mute:mute "+this.id.toString()+" muted, no expiration")();else{var t=e-(0,D.default)().unix();E.default.log("models:Mute:mute "+this.id.toString()+" duration:"+t)(),this._unmuteTimer=w.default.setGlobalTimeout(this.unmute.bind(this),1e3*e)}this.set({expiration:e})}.bind(this),s=C.default.isGroup(this.id);if(t){if(this.promises.mute)return this.promises.mute;var o=this.promises.mute=j.default.sendConversationMute(this.id,e,this.expiration),d=s?new N.ActionType(l10n.t("action_group_muting")):new N.ActionType(l10n.t("action_chat_muting"));i=i||(0,N.genId)();var u=this.promises.mute.catch(function(n){E.default.error("models:Mute:mute dropped")(n);var r=s?l10n.t("action_group_mute_failed"):l10n.t("action_chat_mute_failed");throw new N.ActionType(r,l10n.t("action_try_again"),a.mute.bind(a,e,t,i))}).then(function(e){if(200===e.status){var n=s?l10n.t("action_group_muted"):l10n.t("action_chat_muted");return new N.ActionType(n,l10n.t("action_undo"),a.unmute.bind(a,t,i))}if(e.status>=400)throw s?new N.ActionType(l10n.t("action_group_mute_failed")):new N.ActionType(l10n.t("action_chat_mute_failed"))});return A.default.openToast(y.default.createElement(N.ActionToast,{id:i,initialAction:d,pendingAction:u})),o.then(function(e){200!==e.status||e._duplicate||n()}).finally(function(){a.promises.mute=null})}return n(),r.default.resolve()}},{key:"canMute",value:function(){return C.default.isGroup(this.id)||C.default.isUser(this.id)}},{key:"_clearUnmuteTimer",value:function(){w.default.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer"),this.expiration=0}},{key:"unmute",value:function(e,t){var i=this,a=function(){E.default.log("models:Mute:unmute "+this.id.toString())(),this._clearUnmuteTimer()}.bind(this),n=C.default.isGroup(this.id);if(e){if(this.promises.unmute)return this.promises.unmute;var s=this.promises.unmute=j.default.sendConversationMute(this.id,!1,this.expiration),o=n?new N.ActionType(l10n.t("action_group_unmuting")):new N.ActionType(l10n.t("action_chat_unmuting"));t=t||(0,N.genId)();var d=this.promises.unmute.catch(function(a){E.default.error("models:Mute:unmute dropped")(a);var s=n?l10n.t("action_group_unmute_failed"):l10n.t("action_chat_unmute_failed");return r.default.reject(new N.ActionType(s,l10n.t("action_try_again"),i.unmute.bind(i,e,t)))}).then(function(e){if(200===e.status)return n?new N.ActionType(l10n.t("action_group_unmuted")):new N.ActionType(l10n.t("action_chat_unmuted"));if(e.status>=400)throw n?new N.ActionType(l10n.t("action_group_unmute_failed")):new N.ActionType(l10n.t("action_chat_unmute_failed"))});return A.default.openToast(y.default.createElement(N.ActionToast,{id:t,initialAction:o,pendingAction:d})),s.then(function(e){200!==e.status||e._duplicate||a()}).finally(function(){i.promises.unmute=null})}return a(),r.default.resolve()}},{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this._clearUnmuteTimer()}}]),t}(S.default);F.Collection="Mute",F.Proxy="mute",F.idClass=C.default,F.idWhitelist=["global_mute"],t.GLOBAL_MUTE="global_mute",t.default=(0,M.defineModel)(F)},dhefcajhhb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("hbhijdici"),y=a(m),b=i("bhggeigghg"),E=a(b),T=i("bjigbaghc"),C=a(T),M=i("bdiiahhjbe"),S=a(M),k=i("igdjeffe"),j=a(k),P=i("bebehddcbc"),A=a(P),I=i("chajfbfiga"),O=a(I),L=i("cajijabhgb"),w=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(L),N=i("jccfhaecf"),R=a(N),D=i("dcbdjheea"),G=i("edjgaiicj"),F=a(G),U=i("cgcgbfbffj"),x=a(U),Y=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,c.default)(t,[{key:"get",value:function(e){var i=(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"get",this).call(this,e);if(!this._model.prototype.isIdType(e))return i;var a=(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"get",this).call(this,(0,F.default)(e.toString()));if(a){if(this.remove(a,{silent:!0}),i&&i.tag)return i;var n=a.toJSON();return n.id=e,this.add(n,{silent:!0,merge:!0})[0]}return i||void 0}},{key:"saveToCache",value:function(){if(C.default.me){var e=t.cachePolicy.id,i=this.filter(function(e){return R.default.isWid(e.id)&&!!e.eurl});i=i.map(function(e){return e=e.toJSON(),e.id=(0,F.default)(e.id.toString()),e}),S.default.log("models:profilePic:cache-save: "+String(e))(),A.default.setCollection(e,i)}}},{key:"initializeFromCache",value:function(e){if(this.length&&e){var t=this.reduce(function(e,t){return e[(0,F.default)(t.id.toString())]=t.id.toString(),e},new Object);if(!y.default.isEmpty(t)){var i=e.reduce(function(e,i){return t[i.id]&&(i.id=(0,D.createWid)(t[i.id]),i.stale=!0,e.push(i)),e},[]);this.add(i,{merge:!0})}}}},{key:"onResume",value:function(){var e=this.filter(function(e){var t=E.default.Chat.get(e.id);return e.hasObservers()&&e.stale&&(R.default.isUser(e.id)||R.default.isGroup(e.id))&&!(t&&t.isReadOnly)}).map(function(e){return e.tag||e.unset("tag",{silent:!0}),e});this.resyncPictures(e)}},{key:"_find",value:function(e){var t=E.default.Chat.get(e);return t&&t.isReadOnly?O.default.profilePicFindThumbFromPhone(e,this.get(e)).then(function(e){return e.tag||e.raw||(e.eurl=null,e.tag=null,e.raw=null,e.eurlStale=!1),e}).catch(w.ProtoVersionUndefined,function(){return{id:e,stale:!0}}):R.default.isUser(e)||R.default.isGroup(e)?O.default.profilePicFind(e).then(function(t){var i={id:e};if(null!==t.status&&void 0!==t.status)switch(t.status){case 401:i.tag="",i.raw=void 0;break;case 423:case 429:i.stale=!0;break;default:i.tag=null,i.eurl=null,i.eurlStale=!1}else i.tag=t.tag,i.raw=null,i.eurl=t.eurl,i.eurlStale=!1;return i}).catch(w.WapDrop,function(){return{id:e,stale:!0}}):r.default.resolve({id:e,tag:null})}},{key:"imageChanged",value:function(e,t){var i=this.get(e);i&&("remove"===t?i.set({tag:void 0,eurl:void 0}):i.tag!==t&&i.update().catch(w.WapDrop,function(){}))}},{key:"resyncPictures",value:function(e){var t=this;return 0===e.length?r.default.resolve():O.default.resyncPictures(e.map(function(e){return{id:e.id,tag:e.tag}})).then(function(i){if(423===i.status||429===i.status)S.default.warn("ProfilePicThumbStore:resyncPictures blocked "+i.status)();else{if("number"==typeof i.status&&i.status>=400)throw S.default.error("ProfilePicThumbStore:resyncPictures error "+i.status)(i),new Error("ProfilePicThumbStore:resyncPictures error");if(!Array.isArray(i))throw S.default.error("ProfilePicThumbStore:resyncPictures unknown reply",i)(),new Error("ProfilePicThumbStore:resyncPictures unknown reply");S.default.log("ProfilePicThumbStore:resyncPictures success")(),i.forEach(function(e){var i=t.get(e.id);i&&i.set({tag:e.tag,raw:void 0,stale:!1,eurl:e.eurl,eurlStale:!1})}),e.forEach(function(e){e.eurlStale&&e.update()}),e.forEach(function(e){e.stale=!1})}}).catch(w.WapDrop,function(){}).catch(function(e){S.default.error("ProfilePicThumbStore:resyncPictures dropped: "+String(e))()})}}]),t}(x.default);Y.model=j.default,Y.staleCollection=!0,Y.resumeOnAvailable=!0,Y.cachePolicy={id:"profile_pic_thumb",trigger:"change:tag change:raw",policy:U.CACHE_POLICY.LOAD,delay:5e3},t.default=new Y},dhggbbghfb:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}var r=i("djchjahdbh"),s=n(r),o=i("dfhjacfbjg"),d=a(o),u=i("cajijabhgb"),l=a(u),c=i("dbdfbgehgj"),f=n(c),h=i("eadfaddcj"),p=n(h),g=i("cigehdgbah"),v=n(g),_=i("bdiiahhjbe"),m=n(_),y=i("ebbjbbjjg"),b=n(y),E=i("dhefcajhhb"),T=n(E),C=i("gbbacfeci"),M=n(C),S=i("bgcdajbhif"),k=n(S),j=i("dfhgeaeig"),P=i("dgdhcdgffe"),A={handle:function(e){var t=(0,s.default)(e,1),i=t[0];switch(i.type){case"const":p.default[i.key]=i.value;break;case"read":if(i.isStatus){k.default.handle([i]);break}case"unread":var a=f.default.get(i.jid);a&&("read"===i.type?(0,P.markSeen)(a):"unread"===i.type&&(0,P.markUnseen)(a));break;case"picture":T.default.imageChanged(i.jid,i.tag);break;case"log":d.upload("server-requested",!0,!0);break;case"privacy":if(i.jid){var n=b.default.get(i.jid);n&&n.reset(),T.default.update(i.jid).catch(l.WapDrop,function(){}),M.default.update(i.jid).catch(l.WapDrop,function(){})}else m.default.error("Store:Cmd:handle:privacy no jid",i)();break;case"identity":if(i.jid){var r=v.default.get(i.jid);r?(0,j.updateIdentity)(r,i):m.default.error("Store:Cmd:handle:identity no contact",i)()}else m.default.error("Store:Cmd:handle:identity no jid",i)();break;default:m.default.warn("Store:Cmd:handle:unknown "+i.type,i)()}}};e.exports=A},dhhbbaegif:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("gbfffciea"),_=a(v),m=i("fcedgihic"),y=a(m),b=i("iajeehcac"),E=a(b),T=i("beahjdfigf"),C=a(T),M=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){this.listenTo(this,"change:contact.name",this.sort),this.listenTo(_.default,"locale_change",this.sort)}},{key:"delete",value:function(){this.forEach(function(e){e.delete()}),this.stopListening(),this.reset()}},{key:"set",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.isParticipantCollectionAdd||(i.remove=!0),(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"set",this).call(this,e,i)}},{key:"add",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.isParticipantCollectionAdd=!0,(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"add",this).call(this,e,i)}}]),t}(y.default);M.model=E.default,M.comparator=C.default,t.default=M},dhjffabgfb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.StickerCollection=t.FETCH_STATE=void 0;var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("cgcgbfbffj"),g=a(p),v=i("cgfidiajgj"),_=a(v),m=(t.FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"},t.StickerCollection=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"fetch",value:function(e){throw new Error(this.constructor.name+".fetch is not implemented")}}]),t}(g.default));m.model=_.default,t.default=new m},diafggiefe:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("djchjahdbh"),r=a(n),s=i("bachgbfdhf"),o=a(s),d=i("chcaiehhgc"),u=a(d),l=i("cjfdjhfbg"),c=a(l),f=i("dfedaiidge"),h=a(f),p=i("cdaghjbcia"),g=a(p),v=i("bcddciefhh"),_=a(v),m=i("ciaebjeace"),y=a(m),b=i("bghiedffgi"),E=a(b),T=i("dcaifjegcg"),C=a(T),M=i("bdiihbaeaj"),S=a(M),k=i("bdiiahhjbe"),j=a(k),P=i("bffjfbgbg"),A=a(P),I=i("beeieigghj"),O=a(I),L=i("dgeebjciej"),w=i("fabajdgab"),N=i("ddgbhifaji"),R=i("cajijabhgb"),D=i("daichdjff"),G=function(e){function t(){var e,i,a,n;(0,h.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,_.default)(this,(e=t.__proto__||(0,c.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,T.prop)(),a.type=(0,T.prop)(),a.mediaUrl=(0,T.prop)(),a.blobUrl=(0,T.session)(),a.mediaData=(0,T.session)(),a.fetchedFromServer=(0,T.prop)(),a.old=(0,T.session)(!1),n=i,(0,_.default)(a,n)}return(0,E.default)(t,e),(0,g.default)(t,[{key:"initialize",value:function(){(0,y.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"initialize",this).call(this),this.listenTo(this,"change:mediaUrl change:fetchedFromServer",this.triggerImageUpdate),this.triggerImageUpdate()}},{key:"triggerImageUpdate",value:function(){var e=this;if(this.fetchedFromServer&&this.mediaUrl){this.mediaData||this.addChild("mediaData",new A.default({mediaStage:D.STAGE.PREPARING}));var t={},i={retries:10,factor:1e3,maxTimeout:9e5,jitter:.25};(0,S.default)(i,function(t){return(0,w.fetchMedia)(e.mediaUrl).then(function(e){return e&&e.status>=200&&e.status<300?e:t(new R.CatalogImageDownloadError)})}).then(function(i){var a=i.result,n=O.default.createFromData(a,"image/jpeg");(0,N.prepRawMedia)(n,{}).waitForPrep().then(function(e){return t=(0,u.default)({},t,{mediaBlob:e.mediaBlob,type:e.type,mimetype:e.mimetype,fullWidth:e.fullWidth,fullHeight:e.fullHeight}),o.default.all([O.default.createFromBase64Jpeg(e.preview),O.default.createFromData(e.mediaBlob),(0,L.getHash)(e.mediaBlob)])}).then(function(i){var a=(0,r.default)(i,3),n=a[0],s=a[1],d=a[2];if(t=(0,u.default)({},t,{preview:n,mediaBlob:s,renderableUrl:s.url(),mediaStage:D.STAGE.RESOLVED,filehash:d}),d===e.mediaData.filehash)return o.default.resolve();e.mediaData.set(t)})}).catch(function(t){j.default.error("Failed to fetch "+e.mediaUrl,t)(),e.mediaData.set({mediaStage:D.STAGE.ERROR_MISSING})})}}},{key:"markOld",value:function(){this.old=!0}}]),t}(C.default);G.Proxy="productImage",t.default=(0,T.defineModel)(G)},diajeiidei:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("hbhijdici"),y=a(m),b=i("cajijabhgb"),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(b),T=i("eadfaddcj"),C=a(T),M=i("cbcbdjdah"),S=a(M),k=i("biecbbiiee"),j=a(k),P=i("cgcgbfbffj"),A=a(P),I={before:"before",after:"after"},O=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.hasMediaBefore=!0,a.hasMediaAfter=!0,n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.stopListening()}},{key:"contains",value:function(e){return this.indexOf(e)>-1}},{key:"getAfter",value:function(e){var t=this.indexOf(e);return t<0||t===this.length-1?null:this.at(t+1)}},{key:"getBefore",value:function(e){var t=this.indexOf(e);return t<=0?null:this.at(t-1)}},{key:"loadEarlierMedias",value:function(){var e=this.head();e&&this.queryMedia(null,e)}},{key:"loadRecentMedias",value:function(){var e=this.last();e&&this.queryMedia(null,e,I.after)}},{key:"loadMoreAroundIfNeeded",value:function(e){if(e){var t=this.indexOf(e);t<20&&this.hasMediaBefore&&this.loadEarlierMedias(),this.length-t<20&&this.hasMediaAfter&&this.loadRecentMedias()}}},{key:"queryMedia",value:function(e,t){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I.before;if(!t&&e){var n=e.msgs;if(!n||0===n.length)return this.hasMediaBefore=!1,new r.default(function(e){e({eof:!0})});this.add(n.filter(function(e){return e.isMedia&&!e.isProduct}),{at:0});var s=this.toArray();if(this.downloadMedias(s),e.msgs.msgLoadState.noEarlierMsgs)return this.hasMediaBefore=!1,new r.default(function(e){e({eof:!0})});if(s.length<=2*C.default.MEDIA_QUERY_LIMIT){var o=0===s.length?n.head():y.default.head(s);return this.queryMedia(e,o)}return new r.default(function(e){e({eof:!1})})}if(t&&a===I.before){if(this.queryMediaBefore)return this.queryMediaBefore;var d=0;return this.queryMediaBefore=j.default.queryMedia(t.id.remote,C.default.MEDIA_QUERY_LIMIT,a,t.isMedia?t.id:void 0).then(function(t){var a=t.messages;(!a||a.length<C.default.MEDIA_QUERY_LIMIT)&&(i.hasMediaBefore=!1);var n=[];a&&a.length>0&&(n=a.filter(function(e){return e.isMedia}),i.downloadMedias(n)),i.add(n,{at:0});var r={mediaCount:t.mediaCount,linkCount:t.linkCount,docCount:t.docCount};return e&&e.resetMediasCount(r),d=n.length,{length:d}}).catch(E.WapDrop,E.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryMediaBefore=null,i.trigger("query_media_before",d)}),this.trigger("query_media_before",0),this.queryMediaBefore}if(t&&a===I.after)return this.queryMediaAfter?this.queryMediaAfter:this.queryMediaAfter=j.default.queryMedia(t.id.remote,C.default.MEDIA_QUERY_LIMIT,a,t.id).then(function(t){var a=t.messages;(!a||a.length<C.default.MEDIA_QUERY_LIMIT)&&(i.hasMediaAfter=!1);var n=[];a&&a.length>0&&(n=a.filter(function(e){return e.isMedia}),i.downloadMedias(n)),i.add(n);var r={mediaCount:t.mediaCount,linkCount:t.linkCount,docCount:t.docCount};return e&&e.resetMediasCount(r),{length:n.length}}).catch(E.WapDrop,E.ProtoVersionUndefined,404,function(){}).finally(function(){i.queryMediaAfter=null,i.trigger("query_media_after")})}},{key:"downloadMedias",value:function(e){y.default.forEach(e,function(e){e.downloadMedia()})}}]),t}(A.default);O.model=S.default,t.default=O},dieafdcbjb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=a(f),p=i("jccfhaecf"),g=a(p),v=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,f.prop)(),a.status=(0,f.prop)(),a.stale=(0,f.session)(!0),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.default);v.Collection="Status",v.Proxy="status",v.idClass=g.default,t.default=(0,f.defineModel)(v)},djaadchjch:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("hbhijdici"),_=a(v),m=i("bdiiahhjbe"),y=a(m),b=i("cgcgbfbffj"),E=a(b),T=i("fcfchiagj"),C=a(T),M=i("bhggeigghg"),S=a(M),k=i("chajfbfiga"),j=a(k),P=i("cajijabhgb"),A=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(P),I=i("jccfhaecf"),O=a(I),L=i("dcbdjheea"),w=i("bjcegba"),N=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,c.default)(t,[{key:"onResume",value:function(){var e=this;_.default.union(S.default.Chat.where({active:!0}).filter(function(e){return e.isGroup||e.isBroadcast}),S.default.Chat.where({isBroadcast:!0})).forEach(function(t){e.find(t.id).catch(A.WapDrop,A.ProtoVersionUndefined,function(){})})}},{key:"_find",value:function(e){var t=this;if(O.default.isGroup(e)){var i=S.default.Chat.get(e);return i&&i.isReadOnly?(0,w.queryGroupFromPhone)(e):(0,w.queryGroup)(e)}if(O.default.isBroadcast(e))return j.default.contactFindBroadcast(e).then(function(i){if(200===i.status){var a=t.get(e);return a&&!a.stale?r.default.resolve(a):{id:e,participants:i.recipients}}return 404===i.status?(y.default.error("models:GroupMetadataCollection:_find:False broadcast list query")(),{id:e}):(y.default.error("models:GroupMetadataCollection:_find:bclist error: "+i.status)(),r.default.reject(new Error("models:GroupMetadataCollection:_find:bclist error: "+i.status)))});var a="groupMetadata:find trying to fetch non-group/bclist wid "+e.toString();return y.default.log(a)(),r.default.reject(new Error(a))}},{key:"_handle",value:function(e){return e}},{key:"handlePendingInvite",value:function(e){var t=e.gid,i=e.participants;this.add({id:(0,L.createWid)(t),pendingParticipants:i},{merge:!0})}}]),t}(E.default);N.model=C.default,N.staleCollection=!0,e.exports=new N},djfhiceeje:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){D.add(e),E.default.forEach(e,function(e){e.chat.starredMsgs&&e.chat.starredMsgs.add(e)}),w.default.add(e)}function r(e){D.remove(e),e.forEach(function(e){e.chat.starredMsgs&&e.chat.starredMsgs.remove(e)}),w.default.remove(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.StarredMsgCollection=void 0;var s=i("bachgbfdhf"),o=a(s),d=i("cjfdjhfbg"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("cdaghjbcia"),h=a(f),p=i("bcddciefhh"),g=a(p),v=i("ciaebjeace"),_=a(v),m=i("bghiedffgi"),y=a(m);t.addStarredMsgs=n,t.removeStarredMsgs=r;var b=i("hbhijdici"),E=a(b),T=i("cbcbdjdah"),C=a(T),M=i("biecbbiiee"),S=a(M),k=i("eaaehfdjdg"),j=a(k),P=i("bdiiahhjbe"),A=a(P),I=i("eadfaddcj"),O=a(I),L=i("dfgeejdaib"),w=a(L),N=i("cgcgbfbffj"),R=a(N),D=void 0,G=t.StarredMsgCollection=function(e){function t(){(0,c.default)(this,t);var e=(0,g.default)(this,(t.__proto__||(0,u.default)(t)).call(this));return e.syncPromise=null,e.isSynced=!1,e.listenTo(j.default,"change:stream",function(){j.default.stream===k.STREAM.DISCONNECTED?e.isSynced=!1:j.default.stream===k.STREAM.CONNECTED&&e.delete()}),e}return(0,y.default)(t,e),(0,h.default)(t,[{key:"process",value:function(e,t,i,a){a?this.delete():this.updateMsgs(e,t,i)}},{key:"sync",value:function(e){if(this.isSynced)return o.default.resolve();if(this.syncPromise)return this.syncPromise;var t=this,i=void 0,a=this.last();return a&&(i=a.id),this.syncPromise=S.default.getStarred(e,O.default.PAGE_SIZE,i).then(function(e){e.length&&t.add(e,{silent:!0}),e.length<O.default.PAGE_SIZE&&(t.isSynced=!0)}).catch(function(e){A.default.error("starred msg sync error: ",e)()}).finally(function(){t.syncPromise=null,t.trigger("sync")}),this.trigger("sync"),this.syncPromise}},{key:"updateMsgs",value:function(e,t,i){var a=this,n=this.syncPromise||o.default.resolve();this.syncPromise=n.then(function(){if(e){return(t.length>0?S.default.incrementalStarredUpdate(t):o.default.resolve([])).then(function(e){var t=e.concat(i);a.isSynced&&(a.add(t,{silent:!0}),w.default.add(e)),E.default.forEach(t,function(e){e.chat.starredMsgs&&e.chat.starredMsgs.add(e)}),a.trigger("sync")}).catch(function(e){A.default.error("models:starred:update:error: ",e)()})}return r(t.concat(i).filter(function(e){return!e.star})),o.default.resolve()}).finally(function(){a.syncPromise=null})}},{key:"delete",value:function(){this.isSynced=!1,(0,_.default)(t.prototype.__proto__||(0,u.default)(t.prototype),"delete",this).call(this)}}]),t}(R.default);G.model=C.default,G.comparator=function(e,t){return t.t-e.t},D=new G,t.default=D},eaejdgfgif:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=a(f),p=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,f.prop)(),a.variant=(0,f.prop)(),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.default);p.Proxy="emojiVariant",t.default=(0,f.defineModel)(p)},eaejieeafc:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=a(f),p=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,f.prop)(),a.parentType=(0,f.prop)(),a.parentId=(0,f.prop)(),a.labelId=(0,f.prop)(),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.default);p.Collection="LanelItemCollection",p.Proxy="labelItem",t.default=(0,f.defineModel)(p)},eaggachdae:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("bcddciefhh"),u=a(d),l=i("bghiedffgi"),c=a(l),f=i("dcaifjegcg"),h=i("cgfidiajgj"),p=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),l=0;l<s;l++)d[l]=arguments[l];return i=a=(0,u.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.weight=(0,f.prop)(),n=i,(0,u.default)(a,n)}return(0,c.default)(t,e),t}(h.Sticker);p.Proxy="recentSticker",t.default=(0,f.defineModel)(p)},ebbjbbjjg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("djchjahdbh"),r=a(n),s=i("bachgbfdhf"),o=a(s),d=i("cjfdjhfbg"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("cdaghjbcia"),h=a(f),p=i("bcddciefhh"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("bjigbaghc"),y=a(m),b=i("igjghefdb"),E=a(b),T=i("cgcgbfbffj"),C=a(T),M=i("jccfhaecf"),S=a(M),k=i("chajfbfiga"),j=a(k),P=function(e){function t(){return(0,c.default)(this,t),(0,g.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,h.default)(t,[{key:"_find",value:function(e){return!this.gadd(e).isUser||S.default.isServer(e)||S.default.isPSA(e)?o.default.resolve({id:e}):j.default.subscribePresence(e).then(function(){return{id:e}})}},{key:"handle",value:function(e){var t=(0,r.default)(e,1),i=t[0];if(!y.default.me.equals(i.id)){var a=this.get(i.id);a&&("unsubscribe"===i.type?a.set({isSubscribed:!1,stale:!0}):(a.handle(i),a.stale=!1))}}},{key:"clearAllPresence",value:function(){this.forEach(function(e){e.reset(),e.set({stale:!0,isSubscribed:!1})})}},{key:"onResume",value:function(){this.filter(function(e){return e.hasObservers()}).map(function(e){return e.subscribe()})}}]),t}(C.default);P.model=E.default,P.staleCollection=!0,t.default=new P},ebcagbhefg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=i("diebfbcjgd"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("cgcgbfbffj"),y=a(m),b=i("debjjaigad"),E=a(b),T=i("eadfaddcj"),C=a(T),M=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,c.default)(t,[{key:"initializeFromCache",value:function(e){e=e||[],this.add([{id:b.DEFAULT_PREFERENCE,wallpaperColor:C.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0}].concat((0,r.default)(e)),{merge:!0})}},{key:"get",value:function(e){return(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"get",this).call(this,e)||(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"get",this).call(this,b.DEFAULT_PREFERENCE)}},{key:"delete",value:function(){(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"delete",this).call(this),this.add({id:b.DEFAULT_PREFERENCE,wallpaperColor:C.default.DEFAULT_CHAT_WALLPAPER,saveToCameraRoll:!0})}}]),t}(y.default);M.model=E.default,M.cachePolicy={id:"chat_preference",policy:m.CACHE_POLICY.LOAD,delay:1e3},e.exports=new M},ebjaejiaba:function(e,t,i){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CHAT_KIND=t.KIND=void 0;var r=i("bidijafjid"),s=n(r),o=i("chdihcfabe"),d=n(o),u=i("bachgbfdhf"),l=n(u),c=i("cjfdjhfbg"),f=n(c),h=i("dfedaiidge"),p=n(h),g=i("cdaghjbcia"),v=n(g),_=i("bcddciefhh"),m=n(_),y=i("ciaebjeace"),b=n(y),E=i("bghiedffgi"),T=n(E),C=i("cajijabhgb"),M=a(C),S=i("ebggjhghhi"),k=a(S),j=i("hbhijdici"),P=n(j),A=i("djfhiceeje"),I=n(A),O=i("eadfaddcj"),L=n(O),w=i("bdiiibjcij"),N=n(w),R=i("caedaejadb"),D=n(R),G=i("diajeiidei"),F=n(G),U=i("dbfjecijha"),x=n(U),Y=i("chbjajaddg"),B=n(Y),V=i("bjebjijbfc"),q=n(V),H=i("gbfffciea"),W=n(H),K=i("bjigbaghc"),z=n(K),Q=i("beecadabde"),J=n(Q),X=i("ccbihadedf"),Z=n(X),$=i("cijheiibhg"),ee=n($),te=i("ccaaiecfib"),ie=n(te),ae=i("ecjehifjdd"),ne=n(ae),re=i("bdiiahhjbe"),se=n(re),oe=i("bfbggcdbfb"),de=n(oe),ue=i("cbcbdjdah"),le=n(ue),ce=i("biecbbiiee"),fe=n(ce),he=i("ccbagdhfbb"),pe=i("ccgjijjbbj"),ge=n(pe),ve=i("dagdiahdfi"),_e=n(ve),me=i("dhefcajhhb"),ye=n(me),be=i("ddhijeejag"),Ee=n(be),Te=i("eaaehfdjdg"),Ce=n(Te),Me=i("bhggeigghg"),Se=n(Me),ke=i("ccehadbeci"),je=n(ke),Pe=i("bgabgddgch"),Ae=n(Pe),Ie=i("bebehddcbc"),Oe=n(Ie),Le=i("jccfhaecf"),we=n(Le),Ne=i("chajfbfiga"),Re=n(Ne),De=i("edjgaiicj"),Ge=n(De),Fe=i("cfejjfjhca"),Ue=n(Fe),xe=i("cahfddcdga"),Ye=n(xe),Be=i("cgfjebhhej"),Ve=n(Be),qe=i("ccihhdchab"),He=i("dcaifjegcg"),We=i("ddgbhifaji"),Ke=i("bcjidabgad"),ze=i("dcbafbaejf"),Qe=i("icbibjcg"),Je=i("eahbfdfee"),Xe=i("cgddafdgie"),Ze=t.KIND={GROUP:"group",BROADCAST:"broadcast",CHAT:"chat"};t.CHAT_KIND=Ze;var $e=function(e){function t(){var e,i,a,n;(0,p.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,m.default)(this,(e=t.__proto__||(0,f.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,He.prop)(),a.t=(0,He.prop)(),a.unreadCount=(0,He.prop)(0),a.archive=(0,He.prop)(),a.isReadOnly=(0,He.prop)(),a.isAnnounceGrpRestrict=(0,He.prop)(),a.modifyTag=(0,He.prop)(),a.muteExpiration=(0,He.prop)(0),a.name=(0,He.prop)(),a.notSpam=(0,He.prop)(),a.pin=(0,He.prop)(),a.changeNumberOldJid=(0,He.prop)(),a.changeNumberNewJid=(0,He.prop)(),a.lastReceivedKey=(0,He.prop)(),a.createdLocally=(0,He.session)(),a.pendingAction=(0,He.session)(),a.formattedTitle=(0,He.session)(),a.active=(0,He.session)(),a.pausedTimerId=(0,He.session)(),a.presenceResendTimerId=(0,He.session)(),a.recording=(0,He.session)(),a.typing=(0,He.session)(),a.colors=(0,He.session)(),a.composeContents=(0,He.session)(function(){return{}}),a.composeAttachMediaContents=(0,He.session)(),a.squelch=(0,He.session)(),a.pendingSeenCount=(0,He.session)(0),a.unreadMsgAnchor=(0,He.session)(),a.markedUnread=(0,He.session)(),a.trusted=(0,He.session)(),a.canSend=(0,He.session)(),a.promises=(0,He.session)(function(){return{}}),a.ftsCache=(0,He.session)(function(){return{}}),a.composeQuotedMsg=(0,He.session)(),a.composeQuotedMsgRemoteJid=(0,He.session)(),a.quotedMsgAdminGroupJid=(0,He.session)(),a.groupMetadata=(0,He.session)(),a.presence=(0,He.session)(),a.mute=(0,He.session)(),a.contact=(0,He.session)(),a.liveLocation=(0,He.session)(),a.liveLocationQueried=(0,He.session)(!1),a.ackedProps=(0,He.session)(function(){return{}}),a.mediaCount=(0,He.session)(0),a.linkCount=(0,He.session)(0),a.docCount=(0,He.session)(0),a.vcardDismissed=(0,He.session)(!1),a.kind=(0,He.derived)(a._kind),a.isUser=(0,He.derived)(a._isUser),a.isPSA=(0,He.derived)(a._isPSA),a.isGroup=(0,He.derived)(a._isGroup),a.isBroadcast=(0,He.derived)(a._isBroadcast),a.hasUnread=(0,He.derived)(a._hasUnread,["unreadCount"]),a.shouldShowUnreadDivider=(0,He.derived)(a._shouldShowUnreadDivider,["unreadCount","unreadMsgAnchor"]),a.isVisible=(0,He.derived)(a._isVisible,["createdLocally","msgs","msgsLength"]),a.previewMessage=(0,He.derived)(a._previewMessage,["msgs","msgsChanged"]),a.showChangeNumberNotification=(0,He.derived)(a._showChangeNumberNotification,["changeNumberOldJid","changeNumberNewJid","id","isUser"]),n=i,(0,m.default)(a,n)}return(0,T.default)(t,e),(0,v.default)(t,[{key:"initialize",value:function(){var e=this;(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"initialize",this).call(this),this._addQueue=new ne.default,this._sendQueue=new ne.default,this._promises=null,this.msgs.msgLoadState.contextLoaded=!0,this.isVisible||(this.msgs.msgLoadState.noEarlierMsgs=!0),this.addChild("presence",Se.default.Presence.gadd(this.id));var i=_e.default.get(this.id);if(i?this.addChild("mute",i):this.addChild("mute",_e.default.gadd({id:this.id,expiration:this.muteExpiration})),this.listenTo(this.mute,"change:expiration",this.updateMuteExpiration),this.addChild("contact",Se.default.Contact.gadd(this.id)),this.name&&!this.contact.name&&(this.contact.name=this.name),this.listenTo(this.contact,"change:name",this.updateTitle),this.listenTo(this.contact,"change:isContactBlocked",this.updateCanSend),this.isGroup&&(this.trusted=!0),this.isGroup||this.isBroadcast){var a=void 0;this.isBroadcast&&!Se.default.GroupMetadata.get(this.id)&&(a=!0),this.addChild("groupMetadata",Se.default.GroupMetadata.gadd(this.id)),this.listenTo(this.groupMetadata,"change:stale change:announce",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata.participants,"change:isAdmin add remove",this.updateIsAnnounceGrpRestrict),this.listenTo(this.groupMetadata,"change:trusted change:stale",this.isTrusted),this.listenTo(this.groupMetadata,"change:participants change:stale",this.updateReadOnly),this.listenTo(this.groupMetadata.participants,"change:contact.formattedShortName",this.updateTitle),this.updateReadOnly(),this.updateIsAnnounceGrpRestrict();var n=this.id;this.listenTo(this,"change:isReadOnly",function(){this.isTrusted(),this.updateCanSend(),ye.default.update(n).catch(M.WapDrop,function(){}),Se.default.GroupMetadata.update(n).catch(M.WapDrop,function(){})}),this.listenTo(this,"change:isAnnounceGrpRestrict",this.updateCanSend),a&&Se.default.GroupMetadata.update(n).catch(M.WapDrop,function(){})}else this.listenTo(this.presence,"change:isOnline",function(){return(0,Qe.presenceOnlineChanged)(e)}),this.listenTo(this.contact,"change:isMyContact",this.isTrusted);var r=this.getCollection();r.notSpam[this.id]&&!this.notSpam&&(0,ze.sendNotSpam)(this).catch(function(){}),r.notSpam[this.id]=!!this.notSpam,this.notSpam||this.listenTo(this,"change:notSpam",this.onNotSpamChange),this.updateTitle(),this.isTrusted(),this.updateCanSend(),this.listenTo(this.msgs,"add",this.onNewMsg),this.listenTo(this.msgs,"update_sort_time",this.updateSortTime),this.listenTo(this.msgs,"bulk_add",this.addMediaMsgs),this.listenTo(this,"change:msgs",this.resetMediaMsgs),this._saveAssignedColors=P.default.debounce(this.saveAssignedColors,1e3),this.listenTo(this,"change:active",this.onActiveUpdate),this.pendingAction=0,this.listenTo(this,"change:t change:modifyTag",this._clearFtsCache)}},{key:"_kind",value:function(){return we.default.isGroup(this.id)?Ze.GROUP:we.default.isBroadcast(this.id)?Ze.BROADCAST:we.default.isUser(this.id)?Ze.CHAT:void se.default.log("chat:unknown kind id:"+this.id.toString())()}},{key:"_isUser",value:function(){return we.default.isUser(this.id)}},{key:"_isPSA",value:function(){return we.default.isPSA(this.id)}},{key:"_isGroup",value:function(){return we.default.isGroup(this.id)}},{key:"_isBroadcast",value:function(){return we.default.isBroadcast(this.id)}},{key:"_hasUnread",value:function(){return 0!==this.unreadCount}},{key:"_shouldShowUnreadDivider",value:function(){if(0===this.unreadCount)return!1;if(this.unreadMsgAnchor){var e=this.unreadMsgAnchor.msgChunk.getModelsArray();return this.unreadMsgAnchor!==P.default.find(e,{isUnreadType:!0})}if(this.msgs.msgLoadState.noEarlierMsgs){return this.msgs.filter(function(e){return e.isUnreadType}).length!==this.unreadCount}return!0}},{key:"_isVisible",value:function(){if(this._isVisibleLatched)return!0;if(we.default.isStatusV3(this.id))return!1;var e=this.msgs.length>0&&this.msgs.some(function(e){var t=e.from===z.default.me&&e.type===L.default.MSG_TYPE.GROUPS_V4_INVITE,i=e.type===L.default.MSG_TYPE.E2E_NOTIFICATION;return!t&&!i});return this._isVisibleLatched=!this.createdLocally||e,this._isVisibleLatched}},{key:"_previewMessage",value:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&t.type!==L.default.MSG_TYPE.E2E_NOTIFICATION)return t}return this.msgs.last()}},{key:"_showChangeNumberNotification",value:function(){if(!ie.default.supportsFeature(ie.default.F.CHANGE_NUMBER_V_2))return!1;var e=this.changeNumberOldJid,t=this.changeNumberNewJid,i=this.id;if(!this.isUser)return!1;if(!e&&!t)return!1;var a=t||i,n=Se.default.Contact.get(a);return!n||!n.isMyContact}},{key:"set",value:function(e,i,a){return"string"==typeof e?"muteExpiration"===e&&this.mute&&this.mute.setMute(i):e.hasOwnProperty("muteExpiration")&&this.mute&&this.mute.setMute(e.muteExpiration),(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"set",this).call(this,e,i,a)}},{key:"addPendingAction",value:function(e){var t=this;if(e.isPending()){var i=function(){t.decPending()};e.then(i,i),this.pendingAction++}}},{key:"decPending",value:function(){this.pendingAction>0?this.pendingAction--:(se.default.log("chat:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)}},{key:"onActiveUpdate",value:function(){this.isGroup&&this.active&&(this.squelch=-1),this.presence.chatActive=this.active}},{key:"onPendingActionUpdate",value:function(){this.pendingAction<0&&(se.default.log("chat:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)}},{key:"onNotSpamChange",value:function(){this.getCollection().notSpam[this.id]=this.notSpam,this.isTrusted(),this.notSpam&&this.stopListening(this,"change:notSpam")}},{key:"hasMaybeSentMsgToChat",value:function(){return P.default.some(this.getAllMsgs(),function(e){return e.isSentByMe})}},{key:"isTrusted",value:function(){var e=!1;return this.isGroup?e=this.isReadOnly||this.notSpam||this.groupMetadata.isTrusted():this.isBroadcast?e=!0:this.isUser&&(e=this.notSpam||this.contact.isMyContact),!e&&this.hasMaybeSentMsgToChat()&&(e=!0),this.trusted=e}},{key:"updateMuteExpiration",value:function(){this.muteExpiration=Number(this.mute.expiration)}},{key:"updateTitle",value:function(){this.isBroadcast?this.formattedTitle=this.contact.name||this.groupMetadata.participants.map(function(e){return e.contact.formattedShortName}).join(", "):this.isUser?this.formattedTitle=this.contact.getFormattedUser()||"":this.isGroup&&(this.formattedTitle=this.contact.name)}},{key:"title",value:function(){return this.isGroup?this.formattedTitle||l10n.t("unknown_subject"):this.formattedTitle}},{key:"updateCanSend",value:function(){return this.isReadOnly||this.isAnnounceGrpRestrict?this.canSend=!1:this.isUser?this.canSend=!(this.contact.isContactBlocked||this.isPSA):this.canSend=!0}},{key:"delete",value:function(){(0,b.default)(t.prototype.__proto__||(0,f.default)(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this.cancelPendingPromises(),this.presence.delete(),this.liveLocation&&this.liveLocation.delete(),W.default.clearChat(this),this.groupMetadata&&this.groupMetadata.delete(),this.mediaMsgs&&this.mediaMsgs.delete(),this.linkMsgs&&this.linkMsgs.delete(),this.docMsgs&&this.docMsgs.delete();var e=this.starredMsgs;e&&(e.delete(),e.stopListening(),e.reset()),this.receivedVCardMsgs&&this.receivedVCardMsgs.delete(),Oe.default.deleteComposeContents(this.id)}},{key:"isDirty",value:function(){return 0!==this.unreadCount}},{key:"resetMediaMsgs",value:function(){var e=this.mediaMsgs,t=this.linkMsgs,i=this.docMsgs;e&&(e.delete(),e.queryMedia(this)),t&&(t.delete(),t.queryLinks(this)),i&&(i.delete(),i.queryDocs(this))}},{key:"addMediaMsgs",value:function(e,t){if(e){var i=Array.isArray(e)?e:[e],a=[],n=[],r=[];i.forEach(function(e){e.isMedia&&a.push(e),e.isDoc&&r.push(e),e.linkPreview&&n.push(e)}),this.mediaMsgs&&a.length&&this.mediaMsgs.add(a,t),this.linkMsgs&&n.length&&this.linkMsgs.add(n,t),this.docMsgs&&r.length&&this.docMsgs.add(r,t)}}},{key:"onNewMsg",value:function(e){if(e&&(e.isSentByMe&&!this.notSpam&&(this.notSpam=!0),"i"!==e.eventType)){var t={};t.t=e.t,this.promises.updateSortTime&&this.promises.updateSortTime.cancel(),this.updateMediasCountOnMsg(e),this.archive&&(t.archive=!1),this.promises.setArchive&&this.promises.setArchive.cancel(),e.isSentByMe?this.markedUnread=!1:(this.presence.handle({id:this.id,participant:e.author,type:"paused"}),"a"!==e.eventType&&"d"!==e.eventType||(t.unreadCount=this.unreadCount+1||1)),e.isSentByMeFromWeb&&e.promises.sendPromise?this.setAndKeepPrevious(t,e.promises.sendPromise):this.set(t);var i=Z.default.get(this.id);if(i&&(i.timestamp=q.default.globalUnixTime()),"gp2"!==e.type||"add"!==e.subtype&&"create"!==e.subtype||Se.default.GroupMetadata.trigger("group_participant_change_"+z.default.me.toString(),this.id),!e.isSentByMe){switch(e.eventType){case"d":case"a":"d"===e.eventType&&W.default.alertNewMsg(e),this.msgs.length<L.default.MSG_PRELOAD_THRESHOLD&&this.loadEarlierMsgs(void 0,de.default.WEBC_QUERY_TRIGGER_TYPE.NEW_MESSAGE_PREFETCH).catch(M.E404,function(){}).catch(function(e){se.default.log("chat:onNewMsg failed")(),se.default.log(e)()});break;case"s":if("gp2"===e.type&&"add"===e.subtype&&z.default.me.equals(P.default.head(e.recipients))&&!this.contact.name)return;W.default.alertNewMsg(e),Se.default.GroupMetadata.trigger("group_participant_change_"+z.default.me.toString(),this.id)}var a=e.mediaData;!a||"image"!==a.type&&"video"!==a.type||W.default.newMediaMsg(e)}}}},{key:"canPin",value:function(){if(this.archive)return!1;var e=this.promises&&this.promises.setArchive;return(!e||!e.archive)&&ie.default.supportsFeature(ie.default.F.PIN)}},{key:"canArchive",value:function(){return!this.isBroadcast||ie.default.supportsFeature(ie.default.F.ARCHIVE_BROADCAST)}},{key:"sendDismissChangeNumber",value:function(){var e=this;if(this.promises.sendDismissChangeNumber)return this.promises.sendDismissChangeNumber;var t=Re.default.sendConversationDismissChangeNumber(this.id);this.promises.sendDismissChangeNumber=t;var i=new qe.ActionType(l10n.t("action_chat_dismissing_change_number_notification")),a=t.then(function(e){return 200===e.status?new qe.ActionType(l10n.t("action_chat_dismissed_change_number_notification")):e.status>=400?new qe.ActionType(l10n.t("action_chat_dismiss_change_number_notification_failed")):void 0}).catch(function(t){return se.default.error("models:chat:sendDismissChangeNumber dropped")(t),new qe.ActionType(l10n.t("action_chat_dismiss_change_number_notification_failed"),l10n.t("action_try_again"),e.sendDismissChangeNumber.bind(e))});return W.default.openToast(Ee.default.createElement(qe.ActionToast,{id:(0,qe.genId)(),initialAction:i,pendingAction:a})),t.then(function(t){200!==t.status||t._duplicate||(e.changeNumberOldJid=e.changeNumberNewJid=void 0)}).finally(function(){e.promises.sendDismissChangeNumber=null})}},{key:"handleGroupAction",value:function(e,t,i){var a=this;switch(e){case"subject":return void(this.contact.name=i.subject);case"add":case"promote":case"demote":var n="promote"===e,r=P.default.map(i.participants,function(e){return{id:e,isAdmin:n}});return this.groupMetadata.participants.add(r,{merge:!0}),void("add"===e&&P.default.forEach(i.participants,function(e){Se.default.GroupMetadata.trigger("group_participant_change_"+e,a.id)}));case"remove":var s=this.groupMetadata;return P.default.each(i.participants,function(e){s.participants.remove(e)}),void P.default.forEach(i.participants,function(e){Se.default.GroupMetadata.trigger("group_participant_change_"+e,a.id)});case"modify":return;case"invite":return void(i.code?this.groupMetadata.inviteCode=i.code:se.default.error("model:chat:handleGroupAction:invalid invite code: "+i.code+" for "+this.id.toString())());case"desc_add":return void this.groupMetadata.set({desc:i.desc,descId:i.descId,descTime:i.descTime,descOwner:t});case"desc_remove":return void(this.groupMetadata.descId===i.descId&&this.groupMetadata.set({desc:void 0,descId:void 0,descTime:void 0,descOwner:void 0}));case"restrict":return void(this.groupMetadata.restrict=!!i);case"announce":return void(this.groupMetadata.announce=!!i);case"no_frequently_forwarded":return void(this.groupMetadata.noFrequentlyForwarded=!!i);default:return}}},{key:"setComposeContents",value:function(e){this.composeContents=e}},{key:"getSessionPersistedComposeContents",value:function(){return Oe.default.getComposeContents(this.id)}},{key:"getComposeContents",value:function(){return P.default.isEmpty(this.composeContents)?this.getSessionPersistedComposeContents()||{}:this.composeContents}},{key:"setComposeAttachMediaContents",value:function(e){this.composeAttachMediaContents=e}},{key:"preload",value:function(){1===this.msgs.length&&this.loadEarlierMsgs().catch(M.E404,function(){}).catch(function(e){se.default.log("chat:preload failed")(),se.default.log(e)()})}},{key:"onEmptyMRM",value:function(){se.default.log("models:Chat:removeMsg 0 messages left, querying...")(),this.loadEarlierMsgs().catch(M.E404,function(){}).catch(function(e){se.default.log("chat:onEmptyMRM failed")(),se.default.log(e)()})}},{key:"loadEarlierMsgs",value:function(e,t){var i=this;return t=t||de.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL,e||(e=this.msgs),e.msgLoadState.noEarlierMsgs?l.default.resolve():e.msgLoadState.isLoadingEarlierMsgs?e.loadEarlierPromise:this._loadMsgs("before",e,t).then(function(t){return e&&Array.isArray(t)&&t.length<L.default.PAGE_SIZE&&(e.msgLoadState.noEarlierMsgs=!0),e&&i.isMostRecentCMC(e)&&i.trigger("msgs:loadEarlier"),t})}},{key:"isMostRecentCMC",value:function(e){return this.msgs===e}},{key:"loadRecentMsgs",value:function(e){return e||(e=this.msgs),this.isMostRecentCMC(e)?l.default.resolve():e.msgLoadState.isLoadingRecentMsgs?e.loadRecentPromise:this._loadMsgs("after",e,de.default.WEBC_QUERY_TRIGGER_TYPE.USER_SCROLL)}},{key:"_loadMsgs",value:function(e,t,i){var a=void 0;a="after"===e?t.last():t.head();var n={};a?n=a.id.clone():n.remote=this.id,n.count=L.default.PAGE_SIZE,n.direction=e;var r=(0,Je.newMessageQueryEvent)(i),s=function(e){r.webcResponseBytes+=e.binarySize};return this._loadMsgsPromiseLoop(a,t,fe.default.findQuery.bind(fe.default,n,{logOnSend:s}),e,r)}},{key:"_updateMsgLoadState",value:function(e,t,i){var a=e&&e.msgChunk&&e.msgChunk!==t;t.msgLoadState.contextLoaded=!0,e&&a&&(e.msgChunk.msgLoadState.contextLoaded=!0),"after"===i?t.msgLoadState.isLoadingRecentMsgs=!1:"before"===i?t.msgLoadState.isLoadingEarlierMsgs=!1:"around"===i&&(t.msgLoadState.isLoadingAroundMsgs=!1)}},{key:"_loadMsgsPromiseLoop",value:function(e,t,i,a,n){var r=this,s=performance.now();"after"===a?(t.msgLoadState.isLoadingRecentMsgs=!0,n.webcMessageQueryType=de.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_NEXT):"before"===a?(t.msgLoadState.isLoadingEarlierMsgs=!0,n.webcMessageQueryType=de.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_PREV):"around"===a&&(t.msgLoadState.isLoadingAroundMsgs=!0,n.webcMessageQueryType=de.default.WEBC_MESSAGE_QUERY_DIRECTION.LOAD_AROUND),n.webcBrowserNetworkType=(0,Ke.getEffectiveNetworkType)(),n.webcChatType=this.getWebcChatType(),"number"==typeof this.initialIndex&&(n.webcChatPosition=this.initialIndex);var o=l.default.loop(function(o,d,u){var c=l.default.delay(Ae.default.expBackoff(u,12e4,1e3,.1));return("CONNECTED"===Ce.default.stream?l.default.resolve():k.waitForBBEvent(Ce.default,"change:stream",function(){return"CONNECTED"===Ce.default.stream})).then(function(){return r.regCancellablePromise(i()).then(function(i){n.webcQueryT=Math.ceil(performance.now()-s);var d=void 0;Array.isArray(i[0])?(d=i[0][0],i.forEach(function(e){return(0,Je.logMessageCounts)(n,e)})):(d=i[0],(0,Je.logMessageCounts)(n,i)),d&&(n.webcEarliestMessageT=d.t,d.msgChunk===r.msgs&&(n.webcEarliestMessageIndex=r.msgs.length-1)),(0,ee.default)().then(function(e){e&&(n.webcBrowserStorageQuotaBytes=e.quota,n.webcBrowserStorageQuotaUsedBytes=e.usage)}).finally(function(){return n.commit()}),r._updateMsgLoadState(e,t,a),o(i)})}).catch(function(e){return!(e instanceof l.default.CancellationError)},function(i){return u>3||404===i?(r._updateMsgLoadState(e,t,a),se.default.error("chat:loadMsgs:error "+String(i))(),404===i?l.default.reject(new M.E404):l.default.reject(new M.GaveUpRetry("Gave up msg fetch after "+u+" tries"))):c})},0);return"after"===a?t.loadRecentPromise=o:"before"===a?t.loadEarlierPromise=o:"around"===a&&(t.loadAroundPromise=o),o}},{key:"getSearchContext",value:function(e,t){var i=this,a=void 0,n=void 0;e instanceof le.default?a=e:e instanceof ge.default&&(n=e);var r=a?a.msgChunk:void 0,s=(0,d.default)(L.default.PAGE_SIZE/3*2);if(!r||!r.msgLoadState.contextLoaded){r||(r=new x.default,this.msgChunks.push(r),a&&r.add(a));var o=a?a.id.clone():n.clone();o.count=s;var u=function(){if(a)return a.msgChunk;var e=fe.default.get(n);return e&&e.msgChunk?e.msgChunk:r},l=(0,Je.newMessageQueryEvent)(de.default.WEBC_QUERY_TRIGGER_TYPE.SEARCH_RESULT_CLICK),c=function(e){l.webcResponseBytes+=e.binarySize};this._loadMsgsPromiseLoop(a,r,fe.default.getContext.bind(fe.default,o,u,c),"around",l).then(function(e){var t=u();t&&r&&t!==r&&i.notifyMsgCollectionMerge(t,r,t);var o=e[0],d=n?fe.default.get(n):a;d&&Array.isArray(o)&&o.length<s&&(d.msgChunk.msgLoadState.noEarlierMsgs=!0,r&&d.msgChunk!==r&&(r.msgLoadState.noEarlierMsgs=!0))}).catch(function(){t&&(t.isQuotedMsgAvailable=!1)})}return{collection:r,msg:a,key:n,highlightMsg:!0}}},{key:"sendStarMsgs",value:function(e,t){var i=this;return this.promises.sendStarMsgs?this.promises.sendStarMsgs:this.promises.sendStarMsgs=Re.default.sendMessageStarred(this.id,P.default.map(e,function(e){return e.id}),t).then(function(i){return 200===i.status&&(P.default.forEach(e,function(e){e.set("star",t)}),t?(0,A.addStarredMsgs)(e):(0,A.removeStarredMsgs)(e)),i}).finally(function(){i.promises.sendStarMsgs=null})}},{key:"sendRevokeMsgs",value:function(e,t){var i=this;return this.promises.sendRevokeMsgs?this.promises.sendRevokeMsgs:this.promises.sendRevokeMsgs=l.default.all(e.map(function(e){return e.sendRevoke(t)})).finally(function(){i.promises.sendRevokeMsgs=null})}},{key:"sendDeleteMsgs",value:function(e,t){var i=this;return this.promises.sendDeleteMsgs?this.promises.sendDeleteMsgs:this.promises.sendDeleteMsgs=Re.default.sendMessageDelete(this.id,P.default.map(e,function(e){return e.id}),t).then(function(t){var i=[];return 200===t.status?(P.default.forEach(e,function(e){e.delete()}),e.length):(t.status>=400&&(i=P.default.filter(e,function(e){return-1===e.ack&&(e.delete(),!0)})),i.length)}).finally(function(){i.promises.sendDeleteMsgs=null})}},{key:"deleteMsgs",value:function(e,t){this.deleteMsgsBeforeMsgInclusive(void 0,!e,t)}},{key:"deleteMsgsOlderThan",value:function(e,t,i){var a=this.msgs,n=a.head();if(n&&!(n.t>=e)){if((n=a.last())&&n.t<e)return void this.deleteMsgs(t,i);var r=function(a,n,r){return a&&(i&&!(0,he.msgMatchesType)(a,i)||a.star&&!t||a.t>=e||a.isPersistent)};this.deleteMsgsPartial(r)}}},{key:"deleteMsgsBeforeMsgInclusive",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments[2],a=void 0;if(e){if(!this.msgs.get(e.id))return;a=this.msgs.indexOf(e)}else a=this.msgs.length;var n=function(e,n,r){return i&&!(0,he.msgMatchesType)(e,i)||e.msgChunk===this.msgs&&n>a||t&&e.star||e.isPersistent&&t};this.deleteMsgsPartial(n,!0)}},{key:"deleteMsgsPartial",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.unreadCount;if(this.getAllCMCs().forEach(function(a){var n=a.filter(function(i,a,n){return!e.apply(t,[i,a,n])});a.remove(n,void 0,i),n.forEach(function(e){e.delete()})}),P.default.clone(this.msgChunks).forEach(function(e){0===e.length&&t.removeMsgsCollection(e)}),this.msgs.length>0){var n=a>this.msgs.length?this.msgs.length:a;this.unreadCount=n,this.msgs.msgLoadState.noEarlierMsgs=!0}}},{key:"getFirstMsgWithStatus",value:function(){return P.default.find(this.msgs.getModelsArray(),function(e){return!e.isNotification&&(e.isSentByMe||e.type===L.default.MSG_TYPE.PTT)})}},{key:"getLastReceivedMsg",value:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&(!t.local||t.ack>0))return t}}},{key:"getLastMsgKeyForAction",value:function(){var e=this.msgs.last();if(e)return!this.lastReceivedKey||e.id.fromMe&&e.local&&0===e.ack?e.id:this.lastReceivedKey}},{key:"getLastTimestampMsg",value:function(){for(var e=this.msgs.length-1;e>=0;e--){var t=this.msgs.at(e);if(t&&"i"!==t.eventTypeFromMsgType())return t}}},{key:"getWebcChatType",value:function(){switch(this.kind){case Ze.CHAT:return de.default.WEBC_CHAT_TYPE.INDIVIDUAL;case Ze.GROUP:return de.default.WEBC_CHAT_TYPE.GROUP;case Ze.BROADCAST:return de.default.WEBC_CHAT_TYPE.BROADCAST_LIST;default:throw new TypeError("Invalid Chat.kind "+String(this.kind))}}},{key:"sendContact",value:function(e,t){var i=t&&t.msgContextInfo(this.id),a=P.default.defaults({ack:0,body:Ve.default.fromContactModel(e).vcard,from:z.default.me,id:new ge.default({from:z.default.me,to:this.id,id:(0,Ue.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",subtype:e.formattedName,t:q.default.globalUnixTime(),to:this.id,type:"vcard",isNewMsg:!0},i||{});(0,Xe.addAndSendMsgToChat)(this,a)}},{key:"sendGroupInviteMessage",value:function(e,t,i,a,n,r){var s=P.default.defaults({ack:0,from:z.default.me,id:new ge.default({from:z.default.me,to:this.id,id:(0,Ue.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",t:q.default.globalUnixTime(),to:this.id,type:"groups_v4_invite",isNewMsg:!0,inviteGrpJpegThum:r,inviteCode:i,inviteCodeExp:a,inviteGrp:e,inviteGrpName:t,comment:n},{});return(0,Xe.addAndSendMsgToChat)(this,s)[1]}},{key:"sendContactList",value:function(e,t){var i=e.map(Ve.default.fromContactModel,Ve.default),a=t&&t.msgContextInfo(this.id),n=P.default.defaults({ack:0,from:z.default.me,id:new ge.default({from:z.default.me,to:this.id,id:(0,Ue.default)(),participant:void 0,selfDir:"out"}),local:!0,self:"out",t:q.default.globalUnixTime(),to:this.id,type:"multi_vcard",vcardList:i,isNewMsg:!0},a||{});(0,Xe.addAndSendMsgToChat)(this,n)}},{key:"forwardMessages",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.id,n=this.contact;if(n.isUser&&n.isBlocked())return l.default.reject(new J.default("Forwarded to contact is blocked",n));var r=[];return l.default.each(e,function(e){if(e.isMMS)return(0,We.forwardMediaMsg)(e,t,i);var n=e.quotedMsg&&e.quotedMsg.type===L.default.MSG_TYPE.PRODUCT?e.toJSON():P.default.omit(e.toJSON(),["quotedMsg","quotedParticipant","quotedRemoteJid","quotedStanzaID"]),r=new ge.default({from:z.default.me,to:a,id:(0,Ue.default)(),participant:void 0,selfDir:"out"});P.default.assign(n,{id:r,from:z.default.me,t:q.default.globalUnixTime(),to:a,ack:0,participant:void 0,local:!0,self:"out",isNewMsg:!0,star:!1,isForwarded:e.isForwarded||!e.isSentByMe,forwardingScore:e.getForwardingScoreWhenForwarded(),multicast:i}),(0,Xe.addAndSendMsgToChat)(t,n)}).return(r)}},{key:"updateReadOnly",value:function(){this.isGroup&&!this.groupMetadata.stale&&(this.isReadOnly=!this.groupMetadata.participants.get(z.default.me)),this.isBroadcast&&this.updateTitle()}},{key:"updateIsAnnounceGrpRestrict",value:function(){if(this.isGroup&&!this.groupMetadata.stale){var e=this.groupMetadata.participants.get(z.default.me);this.isAnnounceGrpRestrict=e&&!e.isAdmin&&this.groupMetadata.announce}}},{key:"sortMsgs",value:function(e){var t=e.map(function(e){var t=e.msgChunk;return{msg:e,chunkT:(0,Ye.default)(t.at(0)).t,index:t.indexOf(e)}});return P.default.orderBy(t,["chunkT","index"]).map(function(e){return e.msg})}},{key:"_updateAssignedColor",value:function(){if(this.colors){var e=this.groupMetadata.participants,t=this.colors,i=P.default.difference(P.default.keys(t),e.map(function(e){return e.id.toString()}).map(Ge.default));i.forEach(function(e){delete t[e]}),i.length&&this._saveAssignedColors()}}},{key:"loadAssignedColors",value:function(){return this.groupMetadata&&this.listenTo(this.groupMetadata.participants,"remove reset",this._updateAssignedColor),Oe.default.getGroupParticipantAssignedColor(this.id)||{}}},{key:"saveAssignedColors",value:function(){var e=this.colors;e&&Oe.default.setGroupParticipantAssignedColor(this.id,e)}},{key:"assignedColor",value:function(e){var t=this.colors||(this.colors=this.loadAssignedColors()),i=void 0,a=(0,Ge.default)(e.toString());if(i=t[a])return i;var n={};P.default.forEach(t,function(e,t){n[e]?n[e].push(t):n[e]=[t]});for(var r=Number.POSITIVE_INFINITY,s=1;s<L.default.NUM_COLORS;s++){if(!n[s]){i=s;break}n[s].length<r&&(r=n[s].length,i=s)}return t[a]=i,this._saveAssignedColors(),i}},{key:"unstarAll",value:function(){var e=this.getAllMsgs();e.forEach(function(e){e&&(e.star=!1)}),(0,A.removeStarredMsgs)(e)}},{key:"constructMediaMsgs",value:function(e){if(!e)return this.getMediaMsgs();var t=void 0;return this.getMediaMsgs().contains(e)||e.msgChunk===this.msgs?(t=this.getMediaMsgs(),t.hasMediaAfter=!1):t=new F.default,t.contains(e)||(e.msgChunk?t.add(e.msgChunk.filter(function(e){return e.isMedia})):t.add(e)),t}},{key:"fts",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments[2];if(1===i){var n=this.ftsCache[e];if(n)return n;var r=fe.default.search(e,i,a,this.id);this.ftsCache[e]=r;var s=function(){t.ftsCache[e]=null};return P.default.delay(s,3e5),r.catch(s),r}return fe.default.search(e,i,a,this.id)}},{key:"_clearFtsCache",value:function(){this.ftsCache={}}},{key:"updateSortTime",value:function(){var e=this;this.promises.updateSortTime||(this.promises.updateSortTime=this.regCancellablePromise(l.default.delay(0)).then(function(){var t=e.getLastTimestampMsg();return t?(e.t=t.t,l.default.resolve()):e.msgs.msgLoadState.noEarlierMsgs?l.default.resolve():e.pendingMsgs?l.default.resolve():e.loadEarlierMsgs()}).then(function(t){if(t){var i=e.getLastTimestampMsg();e.t=i?i.t:void 0}}).catch(function(){}).finally(function(){e.promises.updateSortTime=void 0}))}},{key:"removeFromCollection",value:function(e){e.star&&(0,A.removeStarredMsgs)([e]),e.isMedia&&this.mediaMsgs?this.mediaMsgs.remove(e):e.getLinks().length&&this.linkMsgs?this.linkMsgs.remove(e):e.isDoc&&this.docMsgs&&this.docMsgs.remove(e),this.updateMediasCountOnMsg(e,!0)}},{key:"getMediaMsgs",value:function(){return this.mediaMsgs||(this.mediaMsgs=new F.default),this.mediaMsgs}},{key:"getLinkMsgs",value:function(){return this.linkMsgs||(this.linkMsgs=new D.default),this.linkMsgs}},{key:"getDocMsgs",value:function(){return this.docMsgs||(this.docMsgs=new N.default),this.docMsgs}},{key:"getReceivedVCardMsgs",value:function(){return this.contact.isMyContact||!this.contact.isUser?null:(this.receivedVCardMsgs||(this.receivedVCardMsgs=new B.default,this.receivedVCardMsgs.parent=this),this.receivedVCardMsgs)}},{key:"dismissVCard",value:function(){this.vcardDismissed=!0}},{key:"updateMediasCountOnMsg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(ie.default.supportsFeature(ie.default.F.MEDIAS_COUNT)){var i=t?-1:1;e.isMedia&&(this.mediaCount+=i);var a=e.getLinks().length;if(a){var n=i*a;this.linkCount+=n}e.isDoc&&(this.docCount+=i)}}},{key:"resetMediasCount",value:function(e){ie.default.supportsFeature(ie.default.F.MEDIAS_COUNT)&&(e.mediaCount&&(this.mediaCount=e.mediaCount),e.linkCount&&(this.linkCount=e.linkCount),e.docCount&&(this.docCount=e.docCount))}},{key:"getStarredMsgs",value:function(){var e=this,t=this.starredMsgs;return t||(this.starredMsgs=t=new A.StarredMsgCollection,this.starredMsgs.add(I.default.filter(function(t){return t.chat===e}))),t}},{key:"setAndKeepPrevious",value:function(e,t){var i=this,a=(0,s.default)(e);a.forEach(function(e){e in i.ackedProps||(i.ackedProps[e]=i[e])}),t.finally(function(){a.forEach(function(e){delete i.ackedProps[e]})}),this.set(e)}},{key:"getAckedPhoneProps",value:function(){return{wid:this.id,mute:this.mute.expiration,active:this.active,isReadOnly:this.isReadOnly,modifyTag:this.modifyTag,unreadCount:this.unreadCount,changeNumberOldJid:this.changeNumberOldJid,changeNumberNewJid:this.changeNumberNewJid,archive:"archive"in this.ackedProps?this.ackedProps.archive:this.archive,notSpam:"notSpam"in this.ackedProps?this.ackedProps.notSpam:this.notSpam,pin:"pin"in this.ackedProps?this.ackedProps.pin:this.pin}}},{key:"regCancellablePromise",value:function(e){var t=this;return this._promises||(this._promises=[]),this._promises.push(e),e.cancellable().finally(function(){t._promises=P.default.without(t._promises,e),t._promises&&0===t._promises.length&&(t._promises=null)})}},{key:"cancelPendingPromises",value:function(){this._promises&&this._promises.length>0&&(this._promises.forEach(function(e){e.cancel()}),this._promises=null)}},{key:"matchFilter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!P.default.isEmpty(e)||(e.label?P.default.includes(this.labels,e.label):e.kind===L.default.SMB_SEARCH_FILTERS.UNREAD?!!this.hasUnread:e.kind===this.kind)}}]),t}(je.default);$e.Collection="Chat",$e.Proxy="chat",$e.idClass=we.default,t.default=(0,He.defineModel)($e)},ecadbdfdef:function(e,t,i){"use strict";var a={cache:{},delete:function(){this.cache={}}};e.exports=a},eciicfcjdi:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("cjcghajbag"),y=a(m),b=i("jccfhaecf"),E=a(b),T=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,v.prop)(),a.afterCursor=(0,v.prop)(),a.index=(0,v.prop)(),a.fetchedFromServer=(0,v.session)(),a._products=(0,v.session)(),a._msgs=(0,v.session)(),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"initialize",this).call(this),this.productCollection=new y.default,this.msgProductCollection=new y.default,this.listenTo(this,"change:_products",this.triggerProductUpdate),this.listenTo(this,"change:_msgs",this.triggerMsgUpdate),this.triggerProductUpdate(),this.triggerMsgUpdate()}},{key:"triggerProductUpdate",value:function(){this._products&&this.productCollection.add(this._products,{merge:!0}),this._products=void 0}},{key:"triggerMsgUpdate",value:function(){this._msgs&&this.msgProductCollection.add(this._msgs,{merge:!0}),this._msgs=void 0}},{key:"markProductCollectionOld",value:function(){this.productCollection.forEach(function(e){return e.markOld()})}}]),t}(_.default);T.Collection="Catalog",T.Proxy="catalog",T.idClass=E.default,t.default=(0,v.defineModel)(T)},eigdejjai:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("eadfaddcj"),_=a(v),m=i("bdiiahhjbe"),y=a(m),b=i("bdhgicebce"),E=a(b),T=i("ccgjijjbbj"),C=a(T),M=i("eaaehfdjdg"),S=a(M),k=i("bhggeigghg"),j=a(k),P=i("cgcgbfbffj"),A=a(P),I=i("chajfbfiga"),O=a(I),L=i("jccfhaecf"),w=a(L),N=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,c.default)(t,[{key:"_initializeStaleCollection",value:function(){var e=this;this.listenTo(S.default,"change:stream",function(){S.default.stream===M.STREAM.DISCONNECTED&&e.forEach(function(e){e.settled||e.set("stale",!0)})})}},{key:"_find",value:function(e){var t=j.default.Msg.get(e);return t?t.isSentByMe?O.default.queryMsgInfo(t.id).then(function(e){return e.status>=400?(y.default.log("model:MsgInfo:findQuery error "+e.status)(),r.default.reject(e.status)):(e.id=t.id,e.isPTT=t.type===_.default.MSG_TYPE.PTT,r.default.resolve(e))}):r.default.reject("message not sent by me"):r.default.reject("No message found for id: "+e)}},{key:"updateInfo",value:function(e,t,i,a,n,r){var s=new C.default({from:t,to:i,id:e,participant:n}),o=new C.default({from:t,to:i,id:e}),d=this.get(s)||this.get(o);if(d){if(!w.default.isUser(o.remote)){if(2!==a){var u=d.delivery.get(n);u&&d.delivery.remove(u)}if(3!==a){var l=d.read.get(n);l&&d.read.remove(l)}if(4!==a){var c=d.played.get(n);c&&d.played.remove(c)}}4===a?(d.played.get(n)||(d.playedRemaining-=1),d.played.add({id:n,t:r})):3===a?(d.delivery.get(n)||(d.readRemaining-=1),d.read.add({id:n,t:r})):2===a&&(d.delivery.get(n)||(d.deliveryRemaining-=1),d.delivery.add({id:n,t:r}))}}},{key:"handle",value:function(e){var t=this,i=e.shift();switch(i.cmd){case"ack":this.updateInfo(i.id,i.from,i.to,i.ack,i.participant,i.t);break;case"acks":i.id.forEach(function(e){t.updateInfo(e,i.from,i.to,i.ack,i.participant,i.t)})}}}]),t}(A.default);N.model=E.default,N.staleCollection=!0,t.default=new N},ejegihaeh:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("eciicfcjdi"),y=a(m),b=i("cgcgbfbffj"),E=a(b),T=i("ccaaiecfib"),C=a(T),M=i("chajfbfiga"),S=a(M),k=i("dcbdjheea"),j=i("hjbbdjjdf"),P=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,c.default)(t,[{key:"addMsgAsproduct",value:function(e){C.default.supportsFeature(C.default.F.CATALOG)||r.default.reject("Not supported");var i=e.businessOwnerJid&&(0,k.createWid)(e.businessOwnerJid);if(i){var a=this.get(i),n=a&&e.productId&&a.msgProductCollection.get(e.productId),s=a&&e.productId&&a.productCollection.get(e.productId);if(!(s&&s.t&&s.t>=e.t||n&&n.fetchedFromServer)){var d={id:e.productId,url:e.url,name:e.title,description:e.description,imageCdnUrl:{rawUrl:e.mediaData.renderableUrl},catalogWid:i,reviewStatus:"",currency:e.currencyCode,priceAmount1000:e.priceAmount1000,retailerId:e.retailerId,productMsgMediaData:e.mediaData,imageCount:e.productImageCount?e.productImageCount:1,fetchedFromServer:!1,t:e.t};return(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"add",this).call(this,{id:i,afterCursor:void 0,_msgs:[d],stale:!0,fetchedFromServer:!!s},{merge:!0})}}}},{key:"_queryProduct",value:function(e,i){var a=this,n=e.toString({legacy:!0});return S.default.queryProduct(n,i).then(function(i){if(!i.data)return(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"add",a).call(a,{id:e,afterCursor:void 0});var n=i.data;if(!n.image_cdn_urls||n.image_cdn_urls[0].value.includes("https://static.whatsapp.net"))return r.default.reject(new Error("CatalogCollection:findProduct:_queryProduct "+(n.image_cdn_urls?"Product image contains static image":"Could not find image_cdn_urls for product")));var s={id:n.id,url:n.url,name:n.name,description:n.description,additionalImageCdnUrl:n.additional_image_cdn_urls.map(function(e){return{rawUrl:e[1].value}}),imageCdnUrl:{rawUrl:n.image_cdn_urls[1].value},catalogWid:e,reviewStatus:n.capability_to_review_status.length&&n.capability_to_review_status[0].value,currency:n.currency,priceAmount1000:n.price?10*n.price:null,retailerId:n.retailer_id,productMsgMediaData:null,imageCount:n.additional_image_cdn_urls.length+1,fetchedFromServer:!0,t:Date.now()/1e3},d=[s];return(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"add",a).call(a,{id:e,afterCursor:void 0,_products:d,_msgs:d,fetchedFromServer:!0},{merge:!0})})}},{key:"findProduct",value:function(e,t){return C.default.supportsFeature(C.default.F.CATALOG)||r.default.reject(new Error("Catalog not supported")),t?this._queryProduct(e,t):r.default.reject(new Error("CatalogCollection:findProduct Received productId type "+(void 0===t?"undefined":"null")))}},{key:"_queryCatalog",value:function(e,t,i,a){var n=e?e.index:0;return S.default.queryProductCatalog(i,a,10).then(function(e){if(!e.data.length)return{id:t,afterCursor:void 0};var i=[];return e.data.forEach(function(e,a){e.image_cdn_urls&&!e.image_cdn_urls[0].value.includes("https://static.whatsapp.net")&&i.push({id:e.id,url:e.url,name:e.name,description:e.description,additionalImageCdnUrl:e.additional_image_cdn_urls.map(function(e){return{rawUrl:e[1].value}}),imageCdnUrl:{rawUrl:e.image_cdn_urls[1].value},catalogWid:t,reviewStatus:e.capability_to_review_status.length?e.capability_to_review_status[0].value:null,currency:e.currency,priceAmount1000:e.price?10*e.price:null,retailerId:e.retailer_id,productMsgMediaData:null,imageCount:e.additional_image_cdn_urls.length+1,fetchedFromServer:!0,t:Date.now()/1e3,old:!1,index:n+a})}),{id:t,afterCursor:e.paging.cursors.after,_products:i,fetchedFromServer:!0,index:n+i.length}})}},{key:"_findQuery",value:function(e){C.default.supportsFeature(C.default.F.CATALOG)||r.default.reject(new Error("Catalog not supported"));var t=this.get(e),i=t&&!t.stale?t.afterCursor:void 0,a=e.user+"@s.whatsapp.net";return this._queryCatalog(t,e,a,i)}},{key:"_find",value:function(e){return C.default.supportsFeature(C.default.F.CATALOG)||r.default.reject(new Error("Catalog not supported")),this._findQuery(e)}},{key:"findCarouselCatalog",value:function(e){var i=this,a=this.get(e),n=(0,j.isString)(e)?(0,k.createWid)(e):e,r=(0,j.isString)(e)?e:e.toString({legacy:!0});return a&&a.set({index:0}),this._queryCatalog(a,n,r,void 0).then(function(e){return a&&a.markProductCollectionOld(),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"add",i).call(i,e,{merge:!0})})}}]),t}(E.default);P.model=y.default,P.staleCollection=!0,t.default=new P},ejiicdbii:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BusinessProfileCollection=void 0;var n=i("djchjahdbh"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("bdiiahhjbe"),_=a(v),m=i("defecifdhg"),y=a(m),b=i("cgcgbfbffj"),E=a(b),T=i("ejegihaeh"),C=a(T),M=i("cigehdgbah"),S=a(M),k=i("ccaaiecfib"),j=a(k),P=i("chajfbfiga"),A=a(P),I=i("hbhijdici"),O=a(I),L=i("bechdajic"),w=t.BusinessProfileCollection=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),(0,c.default)(t,[{key:"parseBusinessHours",value:function(e){var t=e.config,i={};return t.forEach(function(e){var t=e.day_of_week,a=e.mode;if(a===L.BUSINESS_HOUR_MODES.SPECIFIC_HOURS){var n=e.open_time,r=e.close_time;i[t]||(i[t]={mode:a,hours:[]}),n&&r&&i[t].hours&&i[t].hours.push([n,r])}else i[t]={mode:a}}),{config:i}}},{key:"_find",value:function(e){var t=this,i=this.gadd(e);return A.default.queryBusinessProfile([{wid:i.id,tag:i.tag}]).then(function(i){if(!Array.isArray(i))return _.default.error("Received invalid business profile response")(i),null;if(0===i.length)return _.default.info("Store:BusinessProfile:find No businessProfile found for "+String(e))(),{id:e};var a=i[0],n={id:a.wid,tag:a.tag},r=a.profile;if(r){var s=r.business_hours,o=r.catalog_status;s&&(r.business_hours=void 0,r.businessHours=t.parseBusinessHours(s)),o&&j.default.supportsFeature(j.default.F.CATALOG)&&(r.catalog_status=void 0,r.catalogStatus=o,C.default.findCarouselCatalog(e).then(function(t){var i=Array.isArray(t)?t[0]:t;S.default.assertGet(e).businessCatalog=i}).catch(function(e){return _.default.warn("Store:BusinessProfile:missing catalog")(e)})),O.default.assign(n,m.DEFAULTS,r)}return n})}},{key:"onResume",value:function(){var e=this;this.filter(function(e){return e.stale&&e.hasObservers()}).map(function(t){return e.find(t.id)})}},{key:"handle",value:function(e){var t=(0,r.default)(e,1),i=t[0];i&&i.tag||_.default.error("Store:BusinessProfile:handle Received invalid update from server")(i);var a=this.gadd(i.wid);i.tag!==a.tag&&a.markStale()}}]),t}(E.default);w.model=y.default,w.staleCollection=!0,t.default=new w},fagbfehid:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PAGE_FETCH_STATE=t.PAGE_SIZE=void 0;var n=i("chcaiehhgc"),r=a(n),s=i("bachgbfdhf"),o=a(s),d=i("bidijafjid"),u=a(d),l=i("cjfdjhfbg"),c=a(l),f=i("dfedaiidge"),h=a(f),p=i("cdaghjbcia"),g=a(p),v=i("bcddciefhh"),_=a(v),m=i("ciaebjeace"),y=a(m),b=i("bghiedffgi"),E=a(b),T=i("hbhijdici"),C=i("cgcgbfbffj"),M=a(C),S=i("bdiiahhjbe"),k=a(S),j=i("cdaedfafjc"),P=a(j),A=i("chajfbfiga"),I=a(A);i("dcaifjegcg");var O=t.PAGE_SIZE=9,L=t.PAGE_FETCH_STATE={PENDING:"PENDING",SUCCESS:"SUCCESS",ERROR:"ERROR"},w=function(e){function t(){(0,h.default)(this,t);var e=(0,_.default)(this,(t.__proto__||(0,c.default)(t)).call(this));return e.checksum=null,e._pageFetchPromises={},e.pageFetchStates={},e._handleChecksumChange=function(t){(0,u.default)(e.pageFetchStates).forEach(function(t){return e._resetFetchPageStateAndPromise(parseInt(t,10))}),e._resetRangeWithPlaceholders(0,e.length),e.fetchAt(0,!1,!0)},e.listenTo(e,"change:checksum",e._handleChecksumChange),e}return(0,E.default)(t,e),(0,g.default)(t,[{key:"createPlaceholder",value:function(e){return t.createPlaceholder(e)}},{key:"fetchAt",value:function(e,t,i){this._fetchPageWithIndex(e,Boolean(t),Boolean(i))}},{key:"hasFetchedData",value:function(){var e=this;return(0,u.default)(this.pageFetchStates).some(function(t){return e.pageFetchStates[parseInt(t,10)]===L.SUCCESS})}},{key:"isFetchingData",value:function(){var e=this;return(0,u.default)(this.pageFetchStates).some(function(t){return e.pageFetchStates[parseInt(t,10)]===L.PENDING})}},{key:"pageWithIndex",value:function(e){return t.pageWithIndex(e)}},{key:"reset",value:function(){var e=this;return this.setChecksum(null,{silent:!0}),(0,u.default)(this.pageFetchStates).forEach(function(t){return e._resetFetchPageStateAndPromise(parseInt(t,10))}),(0,y.default)(t.prototype.__proto__||(0,c.default)(t.prototype),"reset",this).call(this)}},{key:"sync",value:function(e){this.setChecksum(e)}},{key:"setChecksum",value:function(e,t){if(this.checksum!==e){this.checksum=e;return t&&t.silent||this.trigger("change:checksum",e),!0}return!1}},{key:"_fetchPageWithIndex",value:function(e,t,i){var a=this.pageWithIndex(e);return this._fetchPage(a,t,i)}},{key:"_fetchPage",value:function(e,t,i){var a=this,n=this.pageFetchStates[e],r=void 0;if(t&&n!==L.PENDING&&(r=this._pageFetchPromises[e])&&(r.cancel(),delete this._pageFetchPromises[e]),r=this._pageFetchPromises[e])return r;var s=this.length;return this._insertPagePlaceholders(e),this._setFetchPageState(e,L.PENDING),this._pageFetchPromises[e]=I.default.queryStickerPacks(e,O).cancellable().then(function(t){var n=a._parseStickerPacksRes(e,t),r=i||a.setChecksum(t.checksum,{silent:!0}),o=(e-1)*O,d=(e+0)*O;a._resetRange(o,d,n),r&&(a._resetRangeWithPlaceholders(0,o),a._resetRangeWithPlaceholders(Math.min(o+n.length,d),t.count));var u=a.length;s!==u&&a.trigger("change:length",u),a._setFetchPageState(e,L.SUCCESS)}).catch(function(t){if(t instanceof o.default.CancellationError)return k.default.log("StickerPack page fetch promise cancelled: "+e)(),void a._unsetFetchPageStateAndPromise(e);a._setFetchPageState(e,L.ERROR)}),this._pageFetchPromises[e]}},{key:"_insertPagePlaceholders",value:function(e){var t=e-1;this._resetRangeWithPlaceholders(t*O,(t+1)*O)}},{key:"_parseStickerPacksRes",value:function(e,t){if(200!==t.status||!t.data)throw new Error("sticker packs query error");return t.data.map(function(t,i){return(0,r.default)({},(0,T.pick)(t,["id","mimetype","name","url","mediaKey","filehash","directPath"]),{uploadhash:t.encFilehash,page:e,index:(e-1)*O+i})})}},{key:"_resetRangeWithPlaceholders",value:function(e,i){this._resetRange(e,i,(0,T.times)(i-e,function(i){return t.createPlaceholder(e+i)}))}},{key:"_resetRange",value:function(e,t,i){var a=this;this._forEachInRange(e,t,function(t,n){var r=i[n-e];if(t)if(r)t.id===r.id?(a.remove(t,{silent:!0}),a.add(r)):(a.remove(t),a.add(r));else for(var s=t;s;)a.remove(s),s=a.at(n);else r&&a.add(r)})}},{key:"_forEachInRange",value:function(e,t,i){for(var a=e;a<t;a++){i(this.at(a),a)}}},{key:"_resetFetchPageStateAndPromise",value:function(e){if(e in this.pageFetchStates){this.pageFetchStates[e]===L.PENDING?this._pageFetchPromises[e].cancel():this._unsetFetchPageStateAndPromise(e)}}},{key:"_setFetchPageState",value:function(e,t){this.pageFetchStates[e]!==t&&(this.pageFetchStates[e]=t,this.trigger("change:pageFetchStates",e,t))}},{key:"_unsetFetchPageState",value:function(e){e in this.pageFetchStates&&(delete this.pageFetchStates[e],this.trigger("change:pageFetchStates",e))}},{key:"_unsetFetchPageStateAndPromise",value:function(e){delete this._pageFetchPromises[e],this._unsetFetchPageState(e)}}]),t}(M.default);w.model=P.default,w.comparator=function(e,t){return e.index<t.index?-1:e.index>t.index?1:0},w.createPlaceholder=function(e){return P.default.createPlaceholder({index:e,page:this.pageWithIndex(e)})},w.pageWithIndex=function(e){return Math.floor(e/O)+1},t.default=new w},fcedgihic:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("chcaiehhgc"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("cccehdaiaf"),_=a(v),m=i("bdiiahhjbe"),y=a(m),b=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,u.default)(this,t);var a=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this));i.parent&&(a.parent=i.parent);var n=a.constructor,r=n.model,s=n.comparator;if(!r)throw new Error("Collection initialized without model!");return a._model=r,s&&(a._comparator=s),a._reset(),a}return(0,g.default)(t,e),(0,c.default)(t,[{key:"add",value:function(e,t){var i=void 0;return i=Array.isArray(e)?e.slice():e?[e]:[],this.set(i,(0,r.default)({merge:!1,add:!0,remove:!1},t))}},{key:"set",value:function(e,t){if(!e)return y.default.error("collection:set called with no models")(),[];for(var i=(0,r.default)({add:!0,remove:!0,merge:!0},t),a=void 0,n=void 0,s=void 0,o=void 0,d=this._comparator&&!1!==i.sort,u=[],l=[],c={},f=i.add,h=i.at,p=i.merge,g=i.remove,v=!(d||!f||!g)&&[],_=0,m=e.length;_<m;_++)if(o=e[_],this.isModel(o)&&(n=o),a=o.id){if(s=this.get(a))g&&(c[s.id.toString()]=!0),p&&(o=n&&o===n?n.attributes:o,s.set(o,i)),e[_]=s;else if(f){if(!(n=e[_]=this._prepareModel(o,i)))continue;u.push(n),this._addReference(n)}n=s||n,n&&(!v||n.id&&c[n.id.toString()]||v.push(n),c[n.id.toString()]=!0)}else y.default.error("collection:set model has no id")();if(g){for(var b=0,E=this.length;b<E;b++)n=this._models[b],c[n.id.toString()]||l.push(n);l.length&&this.remove(l,i)}var T=void 0;if(u.length||v&&v.length)if(d&&(T=!0),"number"==typeof h){var C;(C=this._models).splice.apply(C,[h,0].concat(u))}else for(var M=v||u,S=0,k=M.length;S<k;S++)this._models.push(M[S]);if(T&&this.sort({silent:!0}),!i.silent){for(var j=0,P=u.length;j<P;j++)n=u[j],n.trigger?n.trigger("add",n,this,i):this.trigger("add",n,this,i);(T||v&&v.length)&&this.trigger("sort",this,i)}return e}},{key:"remove",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=void 0,a=void 0,n=void 0,r=void 0,s=Array.isArray(e)?e.slice():[e],o=[],d=0,u=s.length;d<u;d++)(r=s[d])&&(n=r instanceof this._model?r.id:r,(i=o[d]=this.get(n))&&(this._deIndex(i),a=this._models.indexOf(i),this._models.splice(a,1),t.silent||(t.index=a,i.trigger?i.trigger("remove",i,this,t):this.trigger("remove",i,this,t)),this._removeReference(i)));return o}},{key:"reset",value:function(){for(var e=0,t=this._models.length;e<t;e++)this._removeReference(this._models[e]);this._reset(),this.trigger("reset",this)}},{key:"sort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this._comparator)throw new Error("Cannot sort without comparator");return this._models.sort(this._comparator.bind(this)),e.silent||this.trigger("sort",this,e),this}},{key:"replaceId",value:function(e,t){var i=this.get(e);i&&(this._removeFromIndex(e),i.set({id:t}),this._addIndex(i))}},{key:"get",value:function(e){return this._index[e]}},{key:"assertGet",value:function(e){var t=this._index[e];if(!t){var i=this._model.prototype.Collection||"Unknown";y.default.assert(!1,i+"Collection:assertGet")()}return t}},{key:"at",value:function(e){return this._models[e]}},{key:"serialize",value:function(){return this.map(function(e){return e.toJSON()})}},{key:"toJSON",value:function(){return this.serialize()}},{key:"isModel",value:function(e){return e instanceof this._model}},{key:"indexOf",value:function(e,t){return this._models.indexOf(e,t)}},{key:"lastIndexOf",value:function(e,t){return this._models.lastIndexOf(e,t)}},{key:"every",value:function(e){return this._models.every(e)}},{key:"some",value:function(e){return this._models.some(e)}},{key:"forEach",value:function(e){this._models.forEach(e)}},{key:"map",value:function(e){return this._models.map(e)}},{key:"filter",value:function(e){return this._models.filter(e)}},{key:"reduce",value:function(e,t){return this._models.reduce(e,t)}},{key:"slice",value:function(e,t){return this._models.slice(e,t)}},{key:"where",value:function(e){return this.filter(function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})}},{key:"head",value:function(){return this._models[0]}},{key:"last",value:function(){return this._models[this._models.length-1]}},{key:"toArray",value:function(){return this._models.slice()}},{key:"getModelsArray",value:function(){return this._models}},{key:"_reset",value:function(){this._models=[],this._index={}}},{key:"_prepareModel",value:function(e,t){if(this.isModel(e))return e.collection||(e.collection=this),e;var i=(0,r.default)({},t,{collection:this});try{return new this._model(e,i)}catch(e){return void y.default.error("collection:_prepareModel exception: ",e.stack)()}}},{key:"_addReference",value:function(e){this._addIndex(e),e.collection||(e.collection=this),e.on&&e.on("all",this._onModelEvent,this)}},{key:"_removeReference",value:function(e){this===e.collection&&delete e.collection,this._deIndex(e),e.off&&e.off("all",this._onModelEvent,this)}},{key:"_addIndex",value:function(e){this._index[e.id]=e}},{key:"_deIndex",value:function(e){delete this._index[e.id]}},{key:"_removeFromIndex",value:function(e){this.get(e)&&delete this._index[e]}},{key:"_onModelEvent",value:function(e,t,i,a){var n=e.split(":")[0];("add"!==n&&"remove"!==n||i===this)&&("destroy"===n&&this.remove(t,a),this.trigger.apply(this,arguments))}},{key:"length",get:function(){return this._models.length}},{key:"isCollection",get:function(){return!0}},{key:"models",get:function(){return this._models}}]),t}(_.default);t.default=b},fcfchiagj:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("bjigbaghc"),y=a(m),b=i("eadfaddcj"),E=a(b),T=i("cigehdgbah"),C=a(T),M=i("ccaaiecfib"),S=a(M),k=i("bdiiahhjbe"),j=a(k),P=i("dfhgffbdig"),A=a(P),I=i("dhhbbaegif"),O=a(I),L=i("chajfbfiga"),w=a(L),N=i("jccfhaecf"),R=a(N),D=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.participants=(0,v.collection)(A.default),a.pendingParticipants=(0,v.collection)(O.default),a.id=(0,v.prop)(),a.creation=(0,v.prop)(),a.owner=(0,v.prop)(),a.desc=(0,v.prop)(),a.descId=(0,v.prop)(),a.descTime=(0,v.prop)(),a.descOwner=(0,v.prop)(),a.restrict=(0,v.prop)(),a.announce=(0,v.prop)(),a.noFrequentlyForwarded=(0,v.prop)(),a.size=(0,v.prop)(),a.stale=(0,v.session)(!0),a.trusted=(0,v.session)(!0),a.inviteCode=(0,v.session)(),a.groupInviteCodePromise=(0,v.session)(),a.revokeGroupInvitePromise=(0,v.session)(),a.revokeGroupV4AddInvitePromise=(0,v.session)(),a.groupInviteLink=(0,v.derived)(a._groupInviteLink,["inviteCode"]),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"_groupInviteLink",value:function(){return this.inviteCode?""+E.default.GROUP_INVITE_LINK_URL+this.inviteCode:null}},{key:"delete",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this.participants.delete()}},{key:"canSetSubject",value:function(){return!!this.participants.iAmMember()&&(!!this.participants.iAmAdmin()||(!S.default.supportsFeature(S.default.F.GROUPS_V_3)||!0!==this.restrict))}},{key:"canSetDescription",value:function(){return!!S.default.supportsFeature(S.default.F.GROUPS_V_3)&&!(!this.participants.iAmMember()||!this.participants.iAmAdmin()&&this.restrict)}},{key:"canSetGroupProperty",value:function(){return!!S.default.supportsFeature(S.default.F.GROUPS_V_3)&&!!this.participants.iAmAdmin()}},{key:"initialize",value:function(){_.default.prototype.initialize.call(this),this.listenTo(this.participants,"change:isAdmin change:isSuperAdmin change:contact.isMyContact sort remove reset",this.isTrusted),this.listenTo(this.participants,"add remove reset",this.triggerParticipantsChange),this.listenTo(this,"change:owner",this.isTrusted),this.isTrusted()}},{key:"triggerParticipantsChange",value:function(){this.trigger("change:participants")}},{key:"isTrusted",value:function(){if(this.stale)return this.trusted;if(!this.owner)return this.trusted=!1;if(R.default.equals(this.owner,y.default.me))return this.trusted=!0;var e=C.default.get(this.owner);if(e&&e.isMyContact)return this.trusted=!0;for(var t=this.participants.toArray(),i=0,a=t.length;i<a;++i){var n=t[i];if(n.isAdmin&&(!R.default.equals(n.id,y.default.me)&&n.contact.isMyContact))return this.trusted=!0}return this.trusted=!1}},{key:"groupInviteCode",value:function(){var e=this;return this.groupInviteCodePromise?this.groupInviteCodePromise:this.groupInviteCodePromise=w.default.groupInviteCode(this.id).then(function(t){return 200===t.status&&(e.inviteCode=t.code),t.status}).finally(function(){e.groupInviteCodePromise=null})}},{key:"revokeGroupInvite",value:function(){var e=this;return this.revokeGroupInvitePromise?this.revokeGroupInvitePromise:this.revokeGroupInvitePromise=w.default.revokeGroupInvite(this.id).then(function(t){return 200===t.status&&(e.inviteCode=t.code),t.status}).catch(function(e){j.default.error("models:groupMetadata:participantCollection:revokeGroupInvite dropped")(e)}).finally(function(){e.revokeGroupInvitePromise=null})}},{key:"revokeGroupV4AddInvite",value:function(e){var t=this;if(this.revokeGroupV4AddInvitePromise)return this.revokeGroupV4AddInvitePromise;var i=this.id.toString(),a=y.default.me.toString();return this.revokeGroupV4AddInvitePromise=w.default.revokeGroupV4Invite(e,i,a).then(function(e){return e.status}).catch(function(e){j.default.error("models:groupMetadata:participantCollection:revokeGroupV4AddInvite failed")(e)}).finally(function(){t.revokeGroupV4AddInvitePromise=null})}},{key:"queryGroupV4PendingInvite",value:function(){var e=this,t=y.default.me.toString(),i=this.id.toString();return w.default.findGroupPendingInvitesFromPhone(t,i).then(function(t){e.collection&&e.collection.add({id:e.id,pendingParticipants:t.participants},{merge:!0})})}}]),t}(_.default);D.Collection="GroupMetadata",D.Proxy="groupMetadata",D.idClass=R.default,t.default=(0,v.defineModel)(D)},gabccaieg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("bjigbaghc"),g=a(p),v=i("bjgdagjjci"),_=a(v),m=i("cgcgbfbffj"),y=a(m),b=i("hidifcjaf"),E=function(e){function t(){(0,o.default)(this,t);var e=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return e.listenTo(e,"change:disabled",function(t){t.disabled&&e.removeParticipant(t)}),e}return(0,h.default)(t,e),(0,u.default)(t,[{key:"delete",value:function(){var e=this;this.forEach(function(t){return e.removeParticipant(t)})}},{key:"validLocations",value:function(){return this.filter(function(e){return e.valid})}},{key:"removeParticipant",value:function(e){this.remove(e),e.delete()}}]),t}(y.default);E.model=_.default,E.comparator=function(e,t){return e.contact.id.equals(g.default.me)?-1:t.contact.id.equals(g.default.me)?1:(0,b.ContactComparator)(e.contact,t.contact)},t.default=E},gbbacfeci:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("cajijabhgb"),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(p),v=i("dieafdcbjb"),_=a(v),m=i("hjbbdjjdf"),y=i("cgcgbfbffj"),b=a(y),E=i("chajfbfiga"),T=a(E),C=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"onResume",value:function(){var e=this;this.filter(function(e){return e.hasObservers()}).forEach(function(t){e.find(t.id).catch(g.WapDrop,function(){})})}},{key:"_find",value:function(e){var t=this;return T.default.statusFind(e).then(function(i){var a={id:e};if((0,m.isNumber)(i.status))switch(i.status){case 429:a.stale=!0;var n=t.get(e);n&&!(0,m.isString)(n.status)&&(a.status="");break;default:a.status=""}else a.status=i.status;return a}).catch(g.WapDrop,function(){return{id:e,stale:!0,status:""}})}},{key:"_handle",value:function(e){return e}}]),t}(b.default);C.model=_.default,C.staleCollection=!0,C.resumeOnAvailable=!0,t.default=new C},hgeacfdgi:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CALL_UI_STATES=t.CALL_TYPES=t.OUTPUT_DEVICES=void 0;var a=i("dcaifjegcg"),n=i("hfgahggjd"),r=i("bgdcgdigif"),s=function(e){return e&&e.__esModule?e:{default:e}}(r);t.OUTPUT_DEVICES=n.OUTPUT_DEVICES,t.CALL_TYPES=r.CALL_TYPES,t.CALL_UI_STATES=r.CALL_UI_STATES;var o=(0,a.defineModel)(s.default);t.default=new o},hidifcjaf:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.default.L10N.DEFAULT;if(window.Intl&&window.Intl.Collator){var t=window.Intl.Collator([e],{sensitivity:"base"});$={compare:function(e,i){try{return t.compare(e,i)}catch(e){return 0}}}}else $={compare:function(e,t){return e.localeCompare(t)}}}function r(e,t){var i=e.id.toString(),a=t.id.toString();if(i===A.default.me.toString())return 1;if(a===A.default.me.toString())return-1;var n=e.name,r=t.name;if(!n&&r)return 1;if(n&&!r)return-1;if(n&&r&&e.header&&t.header){var s=$.compare(e.header,t.header);return 0===s?$.compare(n,r):s}return i&&a?i.localeCompare(a):-1}Object.defineProperty(t,"__esModule",{value:!0});var s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v);t.ContactComparator=r;var m=i("hbhijdici"),y=a(m),b=i("hciaejfjd"),E=a(b),T=i("bgfcjjddjf"),C=a(T),M=i("dcaifjegcg"),S=a(M),k=i("gbfffciea"),j=a(k),P=i("bjigbaghc"),A=a(P),I=i("eadfaddcj"),O=a(I),L=i("ccaaiecfib"),w=a(L),N=i("fffdgbfji"),R=a(N),D=i("bdiiahhjbe"),G=a(D),F=i("edjgaiicj"),U=a(F),x=i("dhefcajhhb"),Y=a(x),B=i("eaghgadcdf"),V=a(B),q=i("gbbacfeci"),H=a(q),W=i("bhggeigghg"),K=a(W),z=i("jccfhaecf"),Q=a(z),J=i("djbfhebjhe"),X=a(J),Z=i("dfbbghiidh"),$=void 0,ee=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,M.prop)(),a.name=(0,M.prop)(),a.shortName=(0,M.prop)(),a.pushname=(0,M.prop)(),a.type=(0,M.prop)("in"),a.plaintextDisabled=(0,M.prop)(),a.verifiedName=(0,M.prop)(),a.isBusiness=(0,M.prop)(),a.isEnterprise=(0,M.prop)(),a.verifiedLevel=(0,M.prop)(),a.statusMute=(0,M.prop)(),a.sectionHeader=(0,M.prop)(),a.labels=(0,M.prop)(),a.isContactBlocked=(0,M.session)(!1),a.verificationString=(0,M.session)(),a.verificationBinary=(0,M.session)(),a.pendingAction=(0,M.session)(),a._notifyName=(0,M.session)(null),a.promises=(0,M.session)(function(){return{}}),a.status=(0,M.session)(),a.profilePicThumb=(0,M.session)(),a.businessProfile=(0,M.session)(),a.commonGroups=(0,M.session)(),a.liveLocations=(0,M.session)(),a.businessCatalog=(0,M.session)(),a.notifyName=(0,M.derived)(a._notifyNameFunction,["_notifyName","pushname","isBusiness","verifiedLevel","verifiedName"]),a.mentionName=(0,M.derived)(a._mentionName,["isMyContact","isBusiness","verifiedLevel","name","notifyName"]),a.displayName=(0,M.derived)(a._displayName,["id","mentionName","isMe"]),a.userid=(0,M.derived)(a._userid),a.userhash=(0,M.derived)(a._userhash),a.searchName=(0,M.derived)(a._searchName,["name","id"]),a.searchVerifiedName=(0,M.derived)(a._searchVerifiedName,["verifiedLevel","verifiedName"]),a.header=(0,M.derived)(a._header,["name"]),a.isMe=(0,M.derived)(a._isMe),a.isUser=(0,M.derived)(a._isUser),a.isGroup=(0,M.derived)(a._isGroup),a.isBroadcast=(0,M.derived)(a._isBroadcast),a.isPSA=(0,M.derived)(a._isPSA),a.formattedShortNameWithNonBreakingSpaces=(0,M.derived)(a._formattedShortNameWithNonBreakingSpaces,["shortName","formattedName","id"]),a.formattedShortName=(0,M.derived)(a._formattedShortName,["shortName","formattedName","id"]),a.formattedName=(0,M.derived)(a._formattedName,["name","id"]),a.formattedUser=(0,M.derived)(a._formattedUser,["name","id"]),a.isWAContact=(0,M.derived)(a._isWAContact,["type"]),a.isMyContact=(0,M.derived)(a._isMyContact,["name"]),a.showBusinessCheckmark=(0,M.derived)(a._showBusinessCheckmark,["isBusiness","verifiedLevel","name","verifiedName"]),a.showBusinessVname=(0,M.derived)(a._showBusinessVname,["isBusiness","verifiedLevel","name","verifiedName"]),n=i,(0,h.default)(a,n)}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_notifyNameFunction",value:function(){return this.isBusiness&&this.verifiedLevel!==O.default.VERIFIED_LEVEL.HIGH?this.verifiedName:w.default.supportsFeature(w.default.F.CONTACT_HAS_PUSHNAME)?this.pushname:this._notifyName?this._notifyName.name:void 0}},{key:"_mentionName",value:function(){return!this.isMyContact&&this.isBusiness&&this.verifiedLevel!==O.default.VERIFIED_LEVEL.HIGH?null:this.name||this.notifyName}},{key:"_displayName",value:function(){return this.isMe?A.default.pushname:this.mentionName||(0,X.default)(this.id)}},{key:"_userid",value:function(){return this.isUser?Q.default.user(this.id):null}},{key:"_userhash",value:function(){return this.isUser?(0,U.default)((this.id.user||"")+"WA_ADD_NOTIF"):null}},{key:"_searchName",value:function(){return Q.default.isPSA(this.id)?R.default.accentFold(R.default.t("whatsapp_psa_contact_name")):this.name?R.default.accentFold(this.name):null}},{key:"_searchVerifiedName",value:function(){return this.verifiedLevel!==O.default.VERIFIED_LEVEL.HIGH?null:this.verifiedName?R.default.accentFold(this.verifiedName):null}},{key:"_header",value:function(){if(this.name){var e=this.name.toLowerCase(),t=V.default.alpha.exec(e);if(t&&0===t.index||t&&V.default.noDigits.test(e.slice(t.index))){var i=t[0],a=R.default.removeAccents(i);return $.compare(a,i)?i:a}return"#"}}},{key:"_isMe",value:function(){return this.id.equals(A.default.me)}},{key:"_isUser",value:function(){return Q.default.isUser(this.id)}},{key:"_isGroup",value:function(){return Q.default.isGroup(this.id)}},{key:"_isBroadcast",value:function(){return Q.default.isBroadcast(this.id)}},{key:"_isPSA",value:function(){return Q.default.isPSA(this.id)}},{key:"_formattedShortNameWithNonBreakingSpaces",value:function(){return this.id?this.isMe?R.default.t("web_you"):this.shortName||this.formattedName&&this.formattedName.replace(/\s/g," "):""}},{key:"_formattedShortName",value:function(){return this.id?this.isMe?R.default.t("web_you"):this.shortName||this.formattedName:""}},{key:"_formattedName",value:function(){if(!this.id)return"";if(this.isMe)return R.default.t("web_you");if(Q.default.isPSA(this.id))return R.default.t("whatsapp_psa_contact_name");var e=void 0;return this.name||(e=(0,X.default)(this.id)),this.name||e}},{key:"_formattedUser",value:function(){return this.getFormattedUser()}},{key:"_isWAContact",value:function(){return this.isUser&&"in"===this.type}},{key:"_isMyContact",value:function(){return!!(this.isUser&&this.name&&this.name.length)}},{key:"_showBusinessCheckmark",value:function(){return this.isBusiness&&this.verifiedLevel===O.default.VERIFIED_LEVEL.HIGH&&this.name===this.verifiedName}},{key:"_showBusinessVname",value:function(){return this.isBusiness&&this.verifiedLevel===O.default.VERIFIED_LEVEL.HIGH&&this.name!==this.verifiedName}},{key:"initialize",value:function(){var e=this;(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"initialize",this).call(this),this.id&&(Q.default.user(this.id)&&this.addChild("status",H.default.gadd(this.id)),this.addChild("profilePicThumb",Y.default.gadd(this.id)),this.isBusiness&&this.addChild("businessProfile",K.default.BusinessProfile.gadd(this.id)),this.listenTo(this,"change:isBusiness",function(){return(0,Z.onIsBusinessChange)(e)}),this.isContactBlocked=!!C.default.get(this.id),this.pendingAction=0,A.default.isSMB&&(this.addLabelsToCollection(),this.listenTo(this,"change:labels",this.addLabelsToCollection)))}},{key:"addLabelsToCollection",value:function(){(0,E.default)(this.id.toString(),this.labels,"Contact")}},{key:"addPendingAction",value:function(e){var t=this;if(e.isPending()){var i=function(){t.decPending()};e.then(i,i),this.pendingAction++}return e}},{key:"decPending",value:function(){this.pendingAction>0?this.pendingAction--:(G.default.log("contact:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)}},{key:"isBlocked",value:function(){return!!C.default.get(this.id)}},{key:"searchMatch",value:function(e,t,i){return w.default.supportsFeature(w.default.F.LABELS_DISPLAY)&&i?!(e&&this.searchName&&this.searchName.indexOf(e)<0)&&y.default.includes(this.labels,i):!!e&&(!!(this.searchName&&this.searchName.indexOf(e)>-1)||(!!(this.userid&&this.userid.indexOf(e)>-1)||(!!(t&&this.userid&&this.userid.indexOf(t)>-1)||(!!(this.searchVerifiedName&&this.searchVerifiedName.indexOf(e)>-1)||!!(this.pushname&&R.default.accentFold(this.pushname).indexOf(e)>-1)))))}},{key:"getFormattedUser",value:function(){return this.id?Q.default.isPSA(this.id)?R.default.t("whatsapp_psa_contact_name"):this.name?this.name:R.default.isRTL()?R.default.embedLTR((0,X.default)(this.id)):(0,X.default)(this.id):""}},{key:"set",value:function(e,i,a){var n=(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"set",this).call(this,e,i,a);if("string"!=typeof e&&i&&i.merge&&n){if(n.isPSA)return n;!e.name&&n.name&&(n.unset("name"),n.unset("shortName")),!e.verifiedName&&n.verifiedName&&n.unset("verifiedName")}return n}}]),t}(S.default);ee.Collection="Contact",ee.Proxy="contact",ee.idClass=Q.default,n(),j.default.on("set_locale",n),t.default=(0,M.defineModel)(ee)},iajeehcac:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("cigehdgbah"),y=a(m),b=i("jccfhaecf"),E=a(b),T=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.id=(0,v.prop)(),a.isAdmin=(0,v.prop)(),a.isSuperAdmin=(0,v.prop)(),a.contact=(0,v.session)(),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"initialize",this).call(this),this.addChild("contact",y.default.gadd(this.id))}}]),t}(_.default);T.Proxy="participant",T.idClass=E.default,t.default=(0,v.defineModel)(T)},idbcfjbae:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("ciaebjeace"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("dcaifjegcg"),_=a(v),m=i("bffjfbgbg"),y=a(m),b=i("biedfadfag"),E=a(b),T=i("daichdjff"),C=function(e){function t(){var e,i,a,n;(0,o.default)(this,t);for(var s=arguments.length,d=Array(s),u=0;u<s;u++)d[u]=arguments[u];return i=a=(0,c.default)(this,(e=t.__proto__||(0,r.default)(t)).call.apply(e,[this].concat(d))),a.old=(0,v.session)(!1),a.id=(0,v.prop)(),a.catalogWid=(0,v.prop)(),a.additionalImageCdnUrl=(0,v.prop)(),a.imageCdnUrl=(0,v.prop)(),a.url=(0,v.prop)(),a.name=(0,v.prop)(),a.description=(0,v.prop)(),a.reviewStatus=(0,v.prop)(),a.currency=(0,v.prop)(),a.priceAmount1000=(0,v.prop)(),a.retailerId=(0,v.prop)(),a.productImageCollection=(0,v.session)(),a.imageCount=(0,v.prop)(),a.index=(0,v.prop)(),a.productMsgMediaData=(0,v.session)(),a.fetchedFromServer=(0,v.session)(),a.t=(0,v.prop)(),n=i,(0,c.default)(a,n)}return(0,g.default)(t,e),(0,u.default)(t,[{key:"initialize",value:function(){(0,h.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"initialize",this).call(this),this.productImageCollection=new E.default,this.listenTo(this,"change:imageCdnUrl",this.triggerImageUpdate),this.triggerImageUpdate()}},{key:"triggerImageUpdate",value:function(){var e=this;if(this.markProductImagesOld(),this.fetchedFromServer||!this.productMsgMediaData)this.imageCdnUrl.productImageModel=this.productImageCollection.gadd({id:"_0",mediaUrl:this.imageCdnUrl.rawUrl,fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0}),this.additionalImageCdnUrl&&this.additionalImageCdnUrl.forEach(function(t,i){t.productImageModel=e.productImageCollection.gadd({id:"_"+(i+1),mediaUrl:t.rawUrl,fetchedFromServer:e.fetchedFromServer,old:!1},{merge:!0})});else{this.imageCdnUrl.productImageModel=this.productImageCollection.gadd({id:"_0",type:"product",mediaData:new y.default({mediaStage:T.STAGE.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0});for(var t=1;t<this.imageCount;t++)this.productImageCollection.gadd({id:"_"+t,type:"product",mediaData:new y.default({mediaStage:T.STAGE.PREPARING}),fetchedFromServer:this.fetchedFromServer,old:!1},{merge:!0})}}},{key:"markOld",value:function(){this.old=!0}},{key:"markProductImagesOld",value:function(){this.productImageCollection.forEach(function(e){return e.markOld()})}}]),t}(_.default);C.Collection="Product",C.Proxy="product",t.default=(0,v.defineModel)(C)},igdjeffe:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.FALLBACK=void 0;var n=i("chcaiehhgc"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("bjigbaghc"),_=a(v),m=i("dcaifjegcg"),y=a(m),b=i("edbaidcaf"),E=a(b),T=i("jccfhaecf"),C=a(T),M=i("eadfaddcj"),S=a(M),k=i("gcbhjhjhg"),j=a(k),P=t.FALLBACK={SINGLE:"SINGLE",GROUP:"GROUP"},A=function(e){function t(){var e,i,a,n;(0,u.default)(this,t);for(var r=arguments.length,s=Array(r),d=0;d<r;d++)s[d]=arguments[d];return i=a=(0,h.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,m.prop)(),a.tag=(0,m.prop)(),a.raw=(0,m.prop)(),a.eurl=(0,m.prop)(),a.stale=(0,m.session)(!0),a.eurlStale=(0,m.session)(!1),a.pendingPic=(0,m.session)(),a.img=(0,m.derived)(a._img,["tag","raw","stale","eurl","eurlStale"]),a.imgFull=(0,m.derived)(a._imgFull,["tag","raw","stale","eurl","eurlStale"]),a.fallbackType=(0,m.derived)(a._fallbackType,["id"]),n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),(0,c.default)(t,[{key:"_img",value:function(){if(this.raw)return"data:image/jpeg;base64,"+this.raw;if(!this.tag&&this.stale)return null;if(this.tag)return this.generateUrl("s")}},{key:"_imgFull",value:function(){if((this.raw||!this.tag)&&this.stale)return null;if(!this.raw&&this.tag)return this.generateUrl("l")}},{key:"_fallbackType",value:function(){return C.default.isUser(this.id)?P.SINGLE:(C.default.isGroup(this.id),P.GROUP)}},{key:"markStale",value:function(e){this.stale=!0,e&&e.eurl&&(this.eurlStale=!0)}},{key:"validate",value:function(){(this.stale||this.eurlStale)&&this.update()}},{key:"generateUrl",value:function(e){var t={t:e,u:this.id.toString(),i:this.tag||""};return j.default.alive&&this.eurl&&!this.eurlStale&&(t=(0,r.default)({e:this.eurl},t)),E.default.build(S.default.PP_URL,t)}},{key:"canSet",value:function(){return!!C.default.isGroup(this.id)||!!this.id.equals(_.default.me)}},{key:"canDelete",value:function(){return!(!C.default.isGroup(this.id)||!this.tag)||!(!this.id.equals(_.default.me)||!this.tag)}}]),t}(y.default);A.Collection="ProfilePicThumb",A.Proxy="profilePicThumb",A.idClass=C.default,t.default=(0,m.defineModel)(A)},igjghefdb:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Chatstate=void 0;var n=i("cdaghjbcia"),r=a(n),s=i("ciaebjeace"),o=a(s),d=i("cjfdjhfbg"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("bghiedffgi"),g=a(p),v=i("bjebjijbfc"),_=a(v),m=i("hbhijdici"),y=a(m),b=i("dcaifjegcg"),E=a(b),T=i("cigehdgbah"),C=a(T),M=i("cgcgbfbffj"),S=a(M),k=i("eadfaddcj"),j=a(k),P=i("jccfhaecf"),A=a(P),I=function(e){function t(){var e,i,a,n;(0,c.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,h.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,b.prop)(),a.type=(0,b.prop)(),a.t=(0,b.prop)(),a.deny=(0,b.prop)(),a.updateTime=(0,b.session)(),a._expireTimerId=(0,b.session)(),n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),t}(E.default);I.Proxy="chatstate",I.idClass=A.default;var O=(0,b.defineModel)(I),L=function(e){function t(){return(0,c.default)(this,t),(0,h.default)(this,(t.__proto__||(0,u.default)(t)).apply(this,arguments))}return(0,g.default)(t,e),t}(S.default);L.model=O;var w=function(e){function t(){var e,i,a,n;(0,c.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,h.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,b.prop)(),a.isOnline=(0,b.session)(!1),a.stale=(0,b.session)(!0),a.hasData=(0,b.session)(!1),a.isSubscribed=(0,b.session)(!1),a.withholdDisplay=(0,b.session)(!0),a.forceDisplay=(0,b.session)(!1),a.chatActive=(0,b.session)(!1),a.withholdDisplayTimer=(0,b.session)(),a.forceDisplayTimer=(0,b.session)(),a.chatstate=(0,b.session)(),a.chatstates=(0,b.collection)(L),a.isGroup=(0,b.derived)(a._isGroup),a.isUser=(0,b.derived)(a._isUser),n=i,(0,h.default)(a,n)}return(0,g.default)(t,e),(0,r.default)(t,[{key:"_isGroup",value:function(){return A.default.isGroup(this.id)}},{key:"_isUser",value:function(){return A.default.isUser(this.id)}},{key:"initialize",value:function(){var e=this;(0,o.default)(t.prototype.__proto__||(0,u.default)(t.prototype),"initialize",this).call(this);var i=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new O(i)),this.isGroup?this.listenTo(this.chatstates,"add change",y.default.debounce(function(){var t=void 0,i=!1;e.chatstates.forEach(function(e){"composing"!==e.type&&"recording"!==e.type||t&&!(t.updateTime<e.updateTime)||(t=e),i=i||"unavailable"!==e.type}),e.set({isOnline:i}),e.chatstate.set({id:t?t.id:"",type:t?t.type:"unavailable"})})):this.listenTo(this.chatstate,"change:type",function(){e.isOnline="unavailable"!==e.chatstate.type}),this.listenTo(this,"change:chatActive",this.onChatActiveChange)}},{key:"delete",value:function(){(0,o.default)(t.prototype.__proto__||(0,u.default)(t.prototype),"delete",this).call(this),this.getCollection().remove(this.id),this.chatstate.delete(),this.chatstates.forEach(function(e){return e.delete()})}},{key:"handle",value:function(e){var t=!1;void 0===e.type?e.type=this.chatstate.type||"unavailable":"paused"===e.type&&(t=!0,e.type="available"),this.isGroup&&"available"!==e.type&&(e.updateTime=Date.now());var i=void 0;if(this.isGroup){if(!e.participant)return;e.id=e.participant,e.participant=void 0,i=this.chatstates.gadd(e.id)}else i=this.chatstate;t&&"composing"!==i.type&&"recording"!==i.type||i.set(e),i._expireTimerId&&clearTimeout(i._expireTimerId),"composing"===i.type||"recording"===i.type?i._expireTimerId=y.default.delay(this._expireComposing,j.default.PRESENCE_COMPOSING_TIMEOUT,i):i._expireTimerId=void 0;var a=this.forceDisplay||this.isOnline||this.isUser&&!this.chatstate.deny;this.set({hasData:!0,forceDisplay:a})}},{key:"_expireComposing",value:function(e){var t=e.type;"composing"!==t&&"recording"!==t||(e.type="available")}},{key:"reset",value:function(){this.hasData=!1,this.isGroup?this.chatstates.forEach(function(e){e.type="unavailable"}):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})}},{key:"isActive",value:function(){var e=this.chatstate.type;return this.hasData&&("composing"===e||"recording"===e)}},{key:"getFormattedString",value:function(){if(!this.hasData)return null;if(this.isGroup){var e=this.chatstate.id;if(!e)return null;var t=C.default.get(e);if(!t)return null;var i=t.formattedShortName;return"composing"===this.chatstate.type?l10n.t("web_conversation_name_is_composing",{participant:i}):l10n.t("web_conversation_name_is_recording",{participant:i})}if(!this.isUser)return null;var a=this.chatstate;switch(a.type){case"available":return l10n.t("web_conversation_contact_online");case"composing":return l10n.t("web_conversation_is_composing");case"recording":return l10n.t("web_conversation_is_recording");case"unavailable":return a.deny||!a.t?null:_.default.lastSeenStr(a.t)}}},{key:"onChatActiveChange",value:function(){var e=this;this.chatActive?(this.hasData?this.withholdDisplay=!1:this.withholdDisplayTimer=y.default.delay(function(){e.set({withholdDisplay:!1,withholdDisplayTimer:void 0})},1500),this.forceDisplayTimer=y.default.delay(function(){e.set({forceDisplay:!0,forceDisplayTimer:void 0})},2e3)):(this.withholdDisplayTimer&&(clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=void 0),this.forceDisplayTimer&&(clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=void 0))}},{key:"subscribe",value:function(){return this.find()}}]),t}(E.default);w.Collection="Presence",w.Proxy="presence",w.idClass=A.default,t.default=(0,b.defineModel)(w),t.Chatstate=O},ijiafihgg:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("cjfdjhfbg"),r=a(n),s=i("dfedaiidge"),o=a(s),d=i("cdaghjbcia"),u=a(d),l=i("bcddciefhh"),c=a(l),f=i("bghiedffgi"),h=a(f),p=i("hbhijdici"),g=i("bdfbccfifg"),v=a(g),_=i("bfgbdiffgd"),m=a(_),y=i("eaaehfdjdg"),b=a(y),E=function(e){function t(e,i){(0,o.default)(this,t);var a=(0,c.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,i.id));return a._trigger=i.trigger||"all",a._saveToCache=(0,p.debounce)(a.saveToCache,0),a}return(0,h.default)(t,e),(0,u.default)(t,[{key:"saveToCache",value:function(){b.default.hasSynced&&m.default.webRestoreFromCache&&this.collection.saveToCache()}},{key:"enableCaching",value:function(){this.listenTo(this.collection,this._trigger,this._saveToCache)}},{key:"disableCaching",value:function(){this.stopListening(this.collection,this._trigger,this._saveToCache)}}]),t}(v.default);E.policy=g.CACHE_POLICY_TYPE.IMMEDIATE,t.default=E},jcfjeeiii:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=O.default.findLast(e,function(e){return e.body&&e.mediaData&&(e.type===S.default.MSG_TYPE.IMAGE||e.type===S.default.MSG_TYPE.VIDEO)});return t&&t.mediaData.preview}Object.defineProperty(t,"__esModule",{value:!0});var r=i("bachgbfdhf"),s=a(r),o=i("cjfdjhfbg"),d=a(o),u=i("dfedaiidge"),l=a(u),c=i("cdaghjbcia"),f=a(c),h=i("bcddciefhh"),p=a(h),g=i("ciaebjeace"),v=a(g),_=i("bghiedffgi"),m=a(_),y=i("dcaifjegcg"),b=i("cigehdgbah"),E=a(b),T=i("ccehadbeci"),C=a(T),M=i("eadfaddcj"),S=a(M),k=i("bdiiahhjbe"),j=a(k),P=i("chajfbfiga"),A=a(P),I=i("hbhijdici"),O=a(I),L=i("bjebjijbfc"),w=a(L),N=i("djheacfeif"),R=a(N),D=i("jccfhaecf"),G=a(D),F=function(e){function t(){var e,i,a,n;(0,l.default)(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=a=(0,p.default)(this,(e=t.__proto__||(0,d.default)(t)).call.apply(e,[this].concat(s))),a.id=(0,y.prop)(),a.t=(0,y.prop)(),a.unreadCount=(0,y.prop)(0),a.totalCount=(0,y.prop)(0),a.score=(0,y.prop)(),a.pic=(0,y.prop)(),a._msgs=(0,y.prop)(function(){return[]}),a.readKeys=(0,y.session)(function(){return{}}),a.contact=(0,y.session)(),a.expireTimer=(0,y.session)(),a.expireTs=(0,y.session)(),a.hasUnread=(0,y.derived)(a._hasUnread,["unreadCount"]),a.readCount=(0,y.derived)(a._readCount,["unreadCount","totalCount"]),a.renderedThumbnail=(0,y.derived)(a._renderedThumbnail,["msgsChanged","pic","totalCount"]),a.lastStatus=(0,y.derived)(a._lastStatus,["msgsChanged","totalCount"]),n=i,(0,p.default)(a,n)}return(0,m.default)(t,e),(0,f.default)(t,[{key:"_hasUnread",value:function(){return this.unreadCount>0}},{key:"_readCount",value:function(){var e=this.totalCount-this.unreadCount;return O.default.isFinite(e)?e:(j.default.error("Bad status v3 read count, "+this.totalCount+", "+this.unreadCount)(),0)}},{key:"_renderedThumbnail",value:function(){return this.msgs.length===this.totalCount?n(this.msgs.getModelsArray()):this.pic?this.pic:n(this.msgs.getModelsArray())}},{key:"_lastStatus",value:function(){return this.msgs.last()}},{key:"initialize",value:function(){var e=this;(0,v.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"initialize",this).call(this),this.addChild("contact",E.default.gadd(this.id)),this.listenTo(this.msgs,"add bulk_add",function(){window.setTimeout(function(){e.setupStatusExpiration()})}),this.listenTo(this,"change:lastStatus",function(){e.lastStatus&&(e.t=e.lastStatus.t)})}},{key:"setupStatusExpiration",value:function(){var e=this,t=this.msgs.at(0);if(t&&!("number"==typeof this.expireTs&&this.expireTs<=t.t)){var i=t.t+86400+1;i<w.default.globalUnixTime()?window.setTimeout(function(){e.expireMsg()}):(this.expireTimer=R.default.setGlobalTimeout(this.expireMsg.bind(this),1e3*i,this.expireTimer),this.expireTs=t.t)}}},{key:"expireMsg",value:function(){for(var e=this.msgs;e.length>0;){var t=e.at(0);if(!t)break;if(t.t+86400>w.default.globalUnixTime())break;this.unreadCount>this.totalCount-1&&this.unreadCount--,this.totalCount--,e.remove(t),t.delete()}this.expireTs=void 0,this.expireTimer=void 0,0!==this.totalCount&&this.setupStatusExpiration()}},{key:"delete",value:function(){j.default.log("Status v3 deleted with total count: "+this.totalCount)(),(0,v.default)(t.prototype.__proto__||(0,d.default)(t.prototype),"delete",this).call(this),this.expireTimer&&R.default.clearTimeout(this.expireTimer),this.expireTs&&(this.expireTs=void 0),this.getCollection().remove(this.id)}},{key:"onEmptyMRM",value:function(){var e=this;if(j.default.log("Status V3 onEmptyMRM with total count: "+this.totalCount+", noEarlierMsgs: "+(this.msgs.msgLoadState.noEarlierMsgs?"true":"false"))(),this.msgs.msgLoadState.noEarlierMsgs&&0===this.totalCount)return void this.delete();this.totalCount>0&&this.loadMore().catch(function(){}).finally(function(){e.msgs.length||e.delete()})}},{key:"loadMore",value:function(e){var t=this;if(this.msgs.msgLoadState.noEarlierMsgs)return s.default.resolve();if(this.msgs.msgLoadState.isLoadingEarlierMsgs)return this.msgs.loadEarlierPromise;var i=e||S.default.PAGE_SIZE;return this.getCollection().loadMore(this.id,i,this.msgs.last()).then(function(e){return Array.isArray(e)&&e.length<i&&(t.msgs.msgLoadState.noEarlierMsgs=!0),e}).catch(function(e){return 404===e&&t.delete(),s.default.reject(e)})}},{key:"handleReadStatus",value:function(e){this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0&&this.unreadCount--)}},{key:"sendReadStatus",value:function(e,t){var i=this;return A.default.sendStatusSeen(e,t).then(function(t){200===t.status&&i.handleReadStatus(e)})}},{key:"sendMute",value:function(e){var t=this;return A.default.sendStatusMute(this.id,e).then(function(i){200===i.status&&(t.contact.statusMute=e)})}}]),t}(C.default);F.Collection="StatusV3",F.Proxy="statusV3",F.idClass=G.default,t.default=(0,y.defineModel)(F)},jdigiabic:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i("bachgbfdhf"),r=a(n),s=i("cjfdjhfbg"),o=a(s),d=i("dfedaiidge"),u=a(d),l=i("cdaghjbcia"),c=a(l),f=i("bcddciefhh"),h=a(f),p=i("ciaebjeace"),g=a(p),v=i("bghiedffgi"),_=a(v),m=i("ccaaiecfib"),y=a(m),b=i("eaggachdae"),E=a(b),T=i("bdjdebcdd"),C=a(T),M=i("chajfbfiga"),S=a(M),k=function(e){function t(){return(0,u.default)(this,t),(0,h.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,_.default)(t,e),(0,c.default)(t,[{key:"_findQuery",value:function(){return y.default.supportsFeature(y.default.F.RECENT_STICKERS)?S.default.queryRecentStickers(this.dirty?this._getWeights():void 0):r.default.reject("gk recent sticker sync unsupported")}},{key:"_getWeights",value:function(){return this.map(function(e){return{filehash:e.filehash,weight:e.weight.toString()}})}},{key:"throttledSync",value:function(){y.default.supportsFeature(y.default.F.RECENT_STICKERS)&&(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"throttledSync",this).call(this)}},{key:"increment",value:function(e){y.default.supportsFeature(y.default.F.RECENT_STICKERS)&&(this.get(e.id)||this.add({weight:0,id:e.id,clientUrl:e.clientUrl,directPath:e.directPath,filehash:e.filehash,uploadhash:e.uploadhash,mediaKey:e.mediaKey,width:e.width,height:e.height,size:e.size,mimetype:e.mimetype,type:e.type,index:e.index}),(0,g.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"_updateWeights",this).call(this,e.id))}}]),t}(C.default);k.model=E.default,k.modelName="RecentSticker",t.default=new k},jjbajibff:function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function n(e){var t={},i=0,a=function(e){t["change:"+e]=i++};return e.props&&(0,g.default)(e.props).forEach(a),e.session&&(0,g.default)(e.session).forEach(a),e.derived&&(0,g.default)(e.derived).forEach(a),t}function r(e,t){for(var i=[0,0,0],a=0;a<t.length;a++){var n=e["change:"+t[a]],r=Math.floor(n/y),s=n%y;i[r]|=1<<s}return i}function s(e,t){var i=b[e];i||(i=b[e]={_TotalEvents_:0}),t!==m&&(i._TotalEvents_+=1),i[t]=1+(0|i[t])}function o(e,t){e[t]=e[e.length-1],e.pop()}Object.defineProperty(t,"__esModule",{value:!0});var d=i("djchjahdbh"),u=a(d),l=i("dfedaiidge"),c=a(l),f=i("cdaghjbcia"),h=a(f),p=i("bidijafjid"),g=a(p);t.genMirrorMask=n,t.genBitMask=r;var v=i("bdiiahhjbe"),_=a(v),m="change",y=32,b={};_.default.exportToWindow("GEC",b);var E=function(){function e(t){(0,c.default)(this,e),this.state=t}return(0,h.default)(e,[{key:"destructor",value:function(){this.state.off("all",this.onGatherEvent,this)}},{key:"initListener",value:function(){this.state.on("all",this.onGatherEvent,this),this.masks=[],this.listeners=[],this.changeEvents=[0,0,0]}},{key:"onGatherEvent",value:function(e){if(e===m){var t=this.changeEvents;if(!t[0]&&!t[1]&&!t[2])return;this.onChange(),s(this.state.Collection,e),t[0]=0,t[1]=0,t[2]=0}else{var i=this.state.mirrorMask[e];if(void 0===i)return;var a=i/y|0,n=i%y|0;this.changeEvents[a]|=1<<n,s(this.state.Collection,e)}}},{key:"onChange",value:function(){for(var e=this.state,t=(0,u.default)(this.changeEvents,3),i=t[0],a=t[1],n=t[2],r=this.masks,s=this.listeners,o=0;o<r.length;o++){var d=(0,u.default)(r[o],3);if(i&d[0]|a&d[1]|n&d[2]){var l=(0,u.default)(s[o],2);(0,l[0])(l[1],e)}}}},{key:"addListener",value:function(e,t,i){this.listeners||this.initListener(),this.masks.push(t),this.listeners.push([e,i])}},{key:"removeListener",value:function(e){for(var t=this.listeners,i=0;i<t.length;i++)t[i][0]===e&&(o(this.masks,i),o(t,i))}}]),e}();t.default=E}});